import{l as W,r as m,d as u,e as X,b as ee,c as te,o as r,w as k,k as se,u as oe,m as ae,a as e,f as i,j as G,n as P,t as l,F as C,p as S,q as y,g as le,I as B}from"./app-C7zuiOEw.js";import{_ as re}from"./MainLayout-BHyqkyG1.js";import"./NotificationDropdown-Ywe_Y4sx.js";const ie={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ne={class:"mb-6"},de={class:"flex","aria-label":"Breadcrumb"},ce={class:"inline-flex items-center space-x-1 md:space-x-3"},ue={class:"inline-flex items-center"},ve={class:"flex items-center"},ge={key:0,class:"flex justify-center py-12"},pe={key:1,class:"text-center py-12"},me={class:"text-gray-600"},_e={key:2,class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},xe={class:"lg:col-span-2"},he={class:"bg-white rounded-lg shadow-sm overflow-hidden"},fe={class:"flex flex-col md:flex-row"},ye={class:"w-full md:w-1/3 border-r border-gray-200"},be={class:"p-4 space-y-1"},we=["onClick"],ke={class:"w-full md:w-2/3 p-6"},Ce={class:"text-lg font-semibold text-gray-900 mb-4"},Se={class:"space-y-4"},Be={key:0,class:"opacity-50 cursor-not-allowed"},Le={class:"flex justify-between items-start"},Ne={class:"flex-1"},je={class:"font-semibold text-gray-900"},Me={class:"flex items-center space-x-4 text-sm text-gray-600 mb-2"},Te={class:"text-gray-600 text-sm mb-2"},Ie={key:1},Ae={class:"flex justify-between items-start"},De={class:"flex-1"},Fe={class:"font-semibold text-gray-900"},$e={class:"flex items-center space-x-4 text-sm text-gray-600 mb-2"},Ee={class:"text-gray-600 text-sm mb-2"},Ve={class:"text-lg font-semibold text-gray-900"},Oe=["onClick"],ze={key:0,class:"text-center py-8 text-gray-500"},Ge={class:"lg:col-span-1"},Pe={class:"bg-white rounded-lg shadow-sm sticky top-6"},Qe={class:"p-6"},Re={class:"mb-6"},Ue={class:"flex items-center mb-4"},Ke={class:"w-15 h-15 rounded-full flex items-center justify-center"},Ze=["src"],qe={key:1,class:"text-white font-bold text-lg"},He={class:"ml-3"},Je={class:"font-semibold text-gray-900"},Ye={class:"flex items-center text-sm text-gray-600"},We={class:"text-sm text-gray-600"},Xe={class:"space-y-4"},et={key:0,class:"text-center py-4 text-gray-500"},tt={key:1},st={class:"font-medium text-gray-900"},ot={class:"text-sm text-gray-600"},at={class:"text-right"},lt={class:"font-medium text-gray-900"},rt=["onClick"],it={class:"border-t border-gray-200 pt-4"},nt={class:"flex justify-between mb-2"},dt={class:"font-medium"},ct={class:"flex justify-between text-lg font-bold mt-4 pt-4 border-t border-gray-200"},ut=["disabled"],vt={__name:"Booking",setup(gt){const L=X(),Q=oe(),d=m(null),b=m(!0),_=m(null),v=m(null),n=m([]),x=u(()=>L.params.provider_id),N=u(()=>L.params.serviceId),R=async()=>{var s,t;try{b.value=!0;const o=await se.post("/garage",{provider_id:x.value});if(o.data&&o.data.success){if(d.value=o.data.data,g.value.length>0&&(v.value=g.value[0].id),N.value){const c=Z().find(f=>f.id===parseInt(N.value));c&&(n.value.push({...c,category_name:q(c.category_id)}),v.value=c.category_id)}}else _.value=o.data.message||"Failed to load garage details"}catch(o){_.value=((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||o.message||"An error occurred",console.error("Error fetching garage details:",o)}finally{b.value=!1}},h=u(()=>{var s,t,o;return((o=(t=(s=d.value)==null?void 0:s.businesses)==null?void 0:t[0])==null?void 0:o.business_name)||"Garage"}),U=u(()=>h.value.charAt(0).toUpperCase()),K=u(()=>{var t,o;const s=(o=(t=d.value)==null?void 0:t.business_location)==null?void 0:o[0];return s?`${s.city}, ${s.state}, ${s.country}`:"Location not available"}),g=u(()=>{var s;return(s=d.value)!=null&&s.service?d.value.service.map(t=>({id:t.id,name:t.name})):[]}),Z=()=>{var t;if(!((t=d.value)!=null&&t.service))return[];const s=[];return d.value.service.forEach(o=>{o.sub_categories.forEach(c=>{s.push({...c,category_id:o.id})})}),s},j=s=>{var o;if(!((o=d.value)!=null&&o.service))return[];const t=d.value.service.find(c=>c.id===s);return t?t.sub_categories:[]},M=()=>{const s=g.value.find(t=>t.id===v.value);return s?s.name:""},q=s=>{const t=g.value.find(o=>o.id===s);return t?t.name:""},w=u(()=>n.value.reduce((s,t)=>s+parseFloat(t.price||0),0)),T=u(()=>0),I=u(()=>w.value+T.value),A=u(()=>n.value.some(s=>s.price_type==="Quotation")),H=u(()=>A.value?"Get Quote":"Continue"),p=s=>n.value.some(t=>t.id===s),J=s=>{if(!s.price_type){B({type:"error",title:"Service Unavailable",message:"This service is currently unavailable for online booking. Please contact the garage for pricing.",confirmButtonText:"OK"});return}if(n.value.length>0&&!p(s.id)&&n.value[0].price_type!==s.price_type){const o=s.price_type==="Fixed"?"fixed price":"quotation";B({type:"error",title:"Price Type Mismatch",message:`You can only select services of the same price type. Please select only ${o} services.`,confirmButtonText:"OK"});return}p(s.id)?D(s.id):n.value.push({...s,category_name:M()})},D=s=>{n.value=n.value.filter(t=>t.id!==s)},Y=()=>{if(n.value.length===0){B({type:"error",title:"Error",message:"Please select at least one service",confirmButtonText:"OK"});return}localStorage.setItem("selectedServices",JSON.stringify(n.value)),localStorage.setItem("bookingDetails",JSON.stringify({providerId:x.value,garageName:h.value,subtotal:w.value,tax:T.value,total:I.value,hasQuotationServices:A.value})),Q.push({name:"BookingDateTime",params:{provider_id:x.value}})};return ee(()=>{R()}),(s,t)=>{const o=ae("router-link");return r(),te(re,null,{default:k(()=>{var c,f,F,$,E,V,O;return[e("main",ie,[e("div",ne,[e("nav",de,[e("ol",ce,[e("li",ue,[G(o,{to:{name:"Home"},class:"text-gray-700 hover:text-gray-900 inline-flex items-center"},{default:k(()=>[...t[0]||(t[0]=[e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})],-1),P(" Home ",-1)])]),_:1})]),e("li",null,[e("div",ve,[t[1]||(t[1]=e("svg",{class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),G(o,{to:{name:"GarageDetails",params:{provider_id:x.value}},class:"text-gray-700 hover:text-gray-900 ml-1 md:ml-2 font-medium"},{default:k(()=>[P(l(h.value),1)]),_:1},8,["to"])])]),t[2]||(t[2]=e("li",null,[e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})]),e("span",{class:"text-gray-500 ml-1 md:ml-2 font-medium"},"Booking")])],-1))])])]),b.value?(r(),i("div",ge,[...t[3]||(t[3]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-coral-500"},null,-1)])])):_.value?(r(),i("div",pe,[t[4]||(t[4]=e("div",{class:"mb-4"},[e("svg",{class:"w-16 h-16 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),t[5]||(t[5]=e("h3",{class:"text-xl font-medium text-gray-900 mb-2"},"Unable to load services",-1)),e("p",me,l(_.value),1)])):(r(),i("div",_e,[e("div",xe,[e("div",he,[t[10]||(t[10]=e("div",{class:"p-6 border-b border-gray-200"},[e("h1",{class:"text-2xl font-bold text-gray-900"},"Select Services"),e("p",{class:"text-gray-600 mt-1"},"Choose the services you'd like to book")],-1)),e("div",fe,[e("div",ye,[e("div",be,[(r(!0),i(C,null,S(g.value,a=>(r(),i("button",{key:a.id,class:y(["w-full text-left px-4 py-3 rounded-lg transition-colors",v.value===a.id?"bg-black text-white":"hover:bg-gray-100 text-gray-700"]),onClick:z=>v.value=a.id},l(a.name),11,we))),128))])]),e("div",ke,[e("h2",Ce,l(M()),1),e("div",Se,[(r(!0),i(C,null,S(j(v.value),a=>(r(),i("div",{key:a.id,class:y(["border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",{"border-coral-500 bg-coral-50":p(a.id)}])},[a.price_type?(r(),i("div",Ie,[e("div",Ae,[e("div",De,[e("h3",Fe,l(a.service_name),1),e("div",$e,[e("span",null,"⏱️ "+l(a.service_duration||"N/A"),1),t[9]||(t[9]=e("span",{class:"flex items-center space-x-1"},[e("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M14 8C14 9.18669 13.6481 10.3467 12.9888 11.3334C12.3295 12.3201 11.3925 13.0891 10.2961 13.5433C9.19974 13.9974 7.99334 14.1162 6.82946 13.8847C5.66557 13.6532 4.59648 13.0818 3.75736 12.2426C2.91825 11.4035 2.3468 10.3344 2.11529 9.17054C1.88378 8.00665 2.0026 6.80025 2.45673 5.7039C2.91085 4.60754 3.67989 3.67047 4.66658 3.01118C5.65327 2.35189 6.81331 2 8 2C9.5913 2 11.1174 2.63214 12.2426 3.75736C13.3679 4.88258 14 6.4087 14 8Z",fill:"#52595B",stroke:"#52595B","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M8 10.4V8",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M8 5.02974L8 5.71411",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"Details")],-1))]),e("p",Ee,l(a.service_des||"No description available"),1),e("p",Ve,"£"+l(a.price||"N/A"),1)]),e("button",{class:y(["px-4 py-2 rounded-lg transition-colors font-bold",p(a.id)?"bg-gray-200 text-gray-800 hover:bg-gray-300":"bg-coral-200 text-coral-500 hover:bg-coral-300"]),onClick:z=>J(a)},l(p(a.id)?"Remove":"Add"),11,Oe)])])):(r(),i("div",Be,[e("div",Le,[e("div",Ne,[e("h3",je,l(a.service_name),1),e("div",Me,[e("span",null,"⏱️ "+l(a.service_duration||"N/A"),1),t[6]||(t[6]=e("span",{class:"flex items-center space-x-1"},[e("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M14 8C14 9.18669 13.6481 10.3467 12.9888 11.3334C12.3295 12.3201 11.3925 13.0891 10.2961 13.5433C9.19974 13.9974 7.99334 14.1162 6.82946 13.8847C5.66557 13.6532 4.59648 13.0818 3.75736 12.2426C2.91825 11.4035 2.3468 10.3344 2.11529 9.17054C1.88378 8.00665 2.0026 6.80025 2.45673 5.7039C2.91085 4.60754 3.67989 3.67047 4.66658 3.01118C5.65327 2.35189 6.81331 2 8 2C9.5913 2 11.1174 2.63214 12.2426 3.75736C13.3679 4.88258 14 6.4087 14 8Z",fill:"#52595B",stroke:"#52595B","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M8 10.4V8",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M8 5.02974L8 5.71411",stroke:"white","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})]),e("span",null,"Details")],-1))]),e("p",Te,l(a.service_des||"No description available"),1),t[7]||(t[7]=e("p",{class:"text-lg font-semibold text-gray-900"},"Contact for pricing",-1))]),t[8]||(t[8]=e("div",{class:"px-4 py-2 bg-gray-200 text-gray-500 rounded-lg font-bold cursor-not-allowed"}," Unavailable ",-1))])]))],2))),128)),j(v.value).length===0?(r(),i("div",ze," No services available in this category. ")):le("",!0)])])])])]),e("div",Ge,[e("div",Pe,[t[14]||(t[14]=e("div",{class:"p-6 border-b border-gray-200"},[e("h2",{class:"text-xl font-bold text-gray-900"},"Order Summary")],-1)),e("div",Qe,[e("div",Re,[e("div",Ue,[e("div",Ke,[(F=(f=(c=d.value)==null?void 0:c.businesses)==null?void 0:f[0])!=null&&F.file_id?(r(),i("img",{key:0,src:(V=(E=($=d.value)==null?void 0:$.businesses)==null?void 0:E[0])==null?void 0:V.file_id,alt:"Garage Logo",class:"w-15 h-15 rounded object-cover"},null,8,Ze)):(r(),i("span",qe,l(U.value),1))]),e("div",He,[e("h3",Je,l(h.value),1),e("div",Ye,[t[11]||(t[11]=e("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",class:"mr-1"},[e("path",{d:"M7.21483 1.48708L5.42934 5.10744L1.43406 5.69081C1.27253 5.71448 1.12084 5.78285 0.996112 5.88819C0.871389 5.99353 0.778606 6.13164 0.728243 6.28694C0.677881 6.44223 0.671946 6.60852 0.711109 6.767C0.750272 6.92549 0.832972 7.06987 0.949868 7.18384L3.84025 9.99955L3.15771 13.9781C3.13026 14.1389 3.1483 14.3041 3.20981 14.4552C3.27131 14.6062 3.37383 14.7371 3.50578 14.833C3.63773 14.9288 3.79385 14.9859 3.95652 14.9977C4.11919 15.0095 4.28192 14.9756 4.42634 14.8998L8.00043 13.0214L11.5745 14.8998C11.7189 14.975 11.8814 15.0085 12.0438 14.9964C12.2061 14.9843 12.3619 14.9271 12.4935 14.8314C12.6251 14.7356 12.7275 14.605 12.789 14.4543C12.8505 14.3035 12.8687 14.1386 12.8416 13.9781L12.1591 9.99955L15.0494 7.18384C15.1663 7.06987 15.249 6.92549 15.2882 6.767C15.3274 6.60852 15.3214 6.44223 15.2711 6.28694C15.2207 6.13164 15.1279 5.99353 15.0032 5.88819C14.8785 5.78285 14.7268 5.71448 14.5652 5.69081L10.57 5.10744L8.78447 1.48708C8.71203 1.34083 8.60016 1.21773 8.46149 1.13167C8.32282 1.0456 8.16286 1 7.99965 1C7.83644 1 7.67648 1.0456 7.53781 1.13167C7.39914 1.21773 7.28727 1.34083 7.21483 1.48708Z",fill:"#FE7E00"})],-1)),e("span",null,l(((O=d.value)==null?void 0:O.rating)||"0.0"),1)]),e("p",We,l(K.value),1)])]),e("div",Xe,[n.value.length===0?(r(),i("div",et," No services selected ")):(r(),i("div",tt,[(r(!0),i(C,null,S(n.value,a=>(r(),i("div",{key:a.id,class:"flex justify-between items-center py-2 border-b border-gray-200"},[e("div",null,[e("h4",st,l(a.service_name),1),e("p",ot,l(a.category_name),1)]),e("div",at,[e("p",lt,"£"+l(a.price),1),e("button",{onClick:z=>D(a.id),class:"text-sm text-coral-500 hover:text-coral-600"},"Remove",8,rt)])]))),128))]))])]),e("div",it,[e("div",nt,[t[12]||(t[12]=e("span",{class:"text-gray-600"},"Subtotal",-1)),e("span",dt,"£"+l(w.value.toFixed(2)),1)]),e("div",ct,[t[13]||(t[13]=e("span",null,"Total",-1)),e("span",null,"£"+l(I.value.toFixed(2)),1)])]),e("button",{disabled:n.value.length===0,class:y(["w-full py-3 rounded-lg font-medium mt-6 transition-colors",n.value.length===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-coral-500 text-white hover:bg-coral-600"]),onClick:Y},l(H.value),11,ut)])])])]))])]}),_:1})}}},xt=W(vt,[["__scopeId","data-v-7af6395b"]]);export{xt as default};
