import{l as C,f as m,o as u,a as e,t as E,r as n,d as L,b as T,c as F,w as I,k as U,u as N,j as h,n as O,I as w}from"./app-C7zuiOEw.js";import{P}from"./ProviderDashboardLayout-BQ6qSee8.js";import{S as V}from"./SetupLayout-C6r45dy3.js";import"./NotificationDropdown-Ywe_Y4sx.js";import"./x-BRj-0eBZ.js";import"./BackIcon-sjpbuZQf.js";import"./IconDocument-DLGVqC3k.js";const z={props:{title:String,pickedImage:Object,existingImageUrl:String,buttonTitle:String,onAddDocument:Function,onRemoveDocument:Function,isDisabled:Boolean}},$={class:"border-2 border-dashed border-gray-300 rounded-xl p-4 flex items-center justify-center h-56 relative"},H={key:0,class:"w-full h-full relative"},J=["src"],q=["disabled"],G={key:1,class:"w-full h-full"},K=["src"],Q={class:"text-center font-medium"};function W(S,l,a,i,y,c){return u(),m("div",$,[a.pickedImage?(u(),m("div",H,[e("img",{src:a.pickedImage.preview,alt:"Uploaded document",class:"w-full h-full object-cover rounded-lg"},null,8,J),e("button",{onClick:l[0]||(l[0]=(...r)=>a.onRemoveDocument&&a.onRemoveDocument(...r)),disabled:a.isDisabled,class:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 focus:outline-none disabled:opacity-50"},[...l[2]||(l[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])],8,q)])):a.existingImageUrl?(u(),m("div",G,[e("img",{src:a.existingImageUrl,alt:"Existing document",class:"w-full h-full object-cover rounded-lg"},null,8,K)])):(u(),m("button",{key:2,onClick:l[1]||(l[1]=(...r)=>a.onAddDocument&&a.onAddDocument(...r)),class:"flex flex-col items-center justify-center w-full h-full text-gray-500 hover:text-blue-600 focus:outline-none"},[l[3]||(l[3]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),e("span",Q,E(a.buttonTitle),1)]))])}const _=C(z,[["render",W]]),X={class:"w-full p-6 overflow-y-auto"},Y={class:"bg-white border-b border-gray-200 px-8 py-6"},Z={key:0,class:"flex justify-center items-center h-64"},ee={key:1,class:"space-y-6"},te={class:"grid grid-cols-1 sm:grid-cols-2 gap-6"},se={class:"mt-8"},oe=["disabled"],ae={key:0,class:"flex items-center"},le={key:1},re={__name:"Documents",setup(S){N();const l=n(null),a=n(!0),i=n(!1),y=n("front"),c=n([]),r=n([]),g=n([]),v=n([]),f=n([]),b=n(null),D=n({showError:!1,errorMessage:""}),A=L(()=>c.value.length===0&&r.value.length===0&&g.value.length===0&&v.value.length===0),x=d=>{y.value=d,f.value=[],l.value.click()},R=d=>{var s;const t=(s=d.target.files)==null?void 0:s[0];if(!t)return;const o=URL.createObjectURL(t);f.value=[{file:t,preview:o}],B()},B=()=>{switch(y.value){case"front":c.value=f.value;break;case"back":r.value=f.value;break;case"address":g.value=f.value;break;case"business":v.value=f.value;break}f.value=[]},M=async()=>{var d,t;try{a.value=!0;const o=localStorage.getItem("userData");if(!o)return;const s=JSON.parse(o),p=await U.post("/getDocuments",{user_id:s.id});p.data&&p.data.success?b.value=p.data.data:D.value={showError:!0,errorMessage:((t=(d=p.data)==null?void 0:d.errors)==null?void 0:t[0])||"Error while getting documents."}}catch(o){D.value={showError:!0,errorMessage:o.message}}finally{a.value=!1}},j=async()=>{if(i.value)return;const d=localStorage.getItem("userData");if(!d)return;const t=JSON.parse(d),o=new FormData;o.append("user_id",t.id),c.value.length>0&&o.append("id_card_front",c.value[0].file),r.value.length>0&&o.append("id_card_back",r.value[0].file),g.value.length>0&&o.append("proof_of_address",g.value[0].file),v.value.length>0&&o.append("business_registration_document",v.value[0].file);try{i.value=!0;const s=await U.post("/uploadDocuments",o);s.data.success?(c.value=[],r.value=[],g.value=[],v.value=[],b.value=s.data.data,w({type:"success",title:"Documents uploaded successfully!",message:s.data.message})):s.data.errors?(D.value={showError:!0,errorMessage:`Validation Error: ${s.data.errors.join(", ")}`},w({type:"error",title:"Upload failed",message:D.value.errorMessage})):w({type:"error",title:"Upload failed",message:s.data.message})}catch(s){console.error("Upload error:",s),D.value={showError:!0,errorMessage:s.message},w({type:"error",title:"Upload failed",message:D.value.errorMessage})}finally{i.value=!1}};return T(()=>{M()}),(d,t)=>(u(),F(P,null,{default:I(()=>[h(V,null,{default:I(()=>{var o,s,p,k;return[e("div",X,[e("div",Y,[t[6]||(t[6]=e("div",{class:"mb-8"},[e("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Upload Documents"),e("p",{class:"text-sm text-gray-600"},"Upload your personal & business documents to become a verified provider. This will show customers that you are a verified and trusted provider.")],-1)),a.value?(u(),m("div",Z,[...t[0]||(t[0]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-500"},null,-1)])])):(u(),m("div",ee,[e("div",te,[e("div",null,[t[1]||(t[1]=e("h3",{class:"text-lg font-medium text-gray-900 mb-3"},"ID Card Front",-1)),h(_,{title:"ID Card Front",pickedImage:c.value[0],existingImageUrl:(o=b.value)==null?void 0:o.id_card_front,buttonTitle:"Upload front of ID card",onAddDocument:()=>x("front"),onRemoveDocument:()=>c.value=[],isDisabled:i.value},null,8,["pickedImage","existingImageUrl","onAddDocument","onRemoveDocument","isDisabled"])]),e("div",null,[t[2]||(t[2]=e("h3",{class:"text-lg font-medium text-gray-900 mb-3"},"ID Card Back",-1)),h(_,{title:"ID Card Back",pickedImage:r.value[0],existingImageUrl:(s=b.value)==null?void 0:s.id_card_back,buttonTitle:"Upload back of ID card",onAddDocument:()=>x("back"),onRemoveDocument:()=>r.value=[],isDisabled:i.value},null,8,["pickedImage","existingImageUrl","onAddDocument","onRemoveDocument","isDisabled"])]),e("div",null,[t[3]||(t[3]=e("h3",{class:"text-lg font-medium text-gray-900 mb-3"},"Proof of Address",-1)),h(_,{title:"Proof of Address",pickedImage:g.value[0],existingImageUrl:(p=b.value)==null?void 0:p.proof_of_address,buttonTitle:"Upload proof of address",onAddDocument:()=>x("address"),onRemoveDocument:()=>g.value=[],isDisabled:i.value},null,8,["pickedImage","existingImageUrl","onAddDocument","onRemoveDocument","isDisabled"])]),e("div",null,[t[4]||(t[4]=e("h3",{class:"text-lg font-medium text-gray-900 mb-3"},"Business Registration",-1)),h(_,{title:"Business Document",pickedImage:v.value[0],existingImageUrl:(k=b.value)==null?void 0:k.business_registration_document,buttonTitle:"Upload business registration",onAddDocument:()=>x("business"),onRemoveDocument:()=>v.value=[],isDisabled:i.value},null,8,["pickedImage","existingImageUrl","onAddDocument","onRemoveDocument","isDisabled"])])])])),e("div",se,[e("button",{onClick:j,disabled:A.value||i.value,class:"bg-red-500 hover:bg-red-600 disabled:bg-gray-300 text-white font-semibold py-3 px-8 rounded-lg transition-colors"},[i.value?(u(),m("span",ae,[...t[5]||(t[5]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),O(" Uploading... ",-1)])])):(u(),m("span",le,"Save & Continue"))],8,oe)])]),e("input",{ref_key:"fileInput",ref:l,type:"file",accept:"image/*",class:"hidden",onChange:R},null,544)])]}),_:1})]),_:1}))}},ve=C(re,[["__scopeId","data-v-cbfd7b98"]]);export{ve as default};
