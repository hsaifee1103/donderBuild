import{l as k,r as v,c as w,o as n,w as h,k as f,u as D,a as t,f as d,g as C,E as S,j as P,F as B,p as A,t as N,i as U,B as x,I as l}from"./app-CTtqvBQy.js";import{P as E}from"./ProviderDashboardLayout-Bpkv7GAz.js";import{B as V}from"./BackIcon-CByhw0Ua.js";import"./NotificationDropdown-BoJJU9Nh.js";import"./x-DpUPLwB8.js";const j={class:"settings-wrapper"},F={class:"header"},I={class:"card"},$={class:"switch"},q=["onUpdate:modelValue","onChange","disabled"],L={key:0,class:"modal-overlay"},R={class:"modal-window"},M={class:"modal-actions"},J=["disabled"],O={key:0,class:"loader"},T={key:1},Y={__name:"Settings",setup(z){const g=D(),a=v([{key:"sign_up",title:"Sign Up",enabled:!1},{key:"receive_service_quotation",title:"Receive service quotation",enabled:!1},{key:"booking_job",title:"Booking job",enabled:!1},{key:"review_and_rating",title:"Review & rating",enabled:!1},{key:"promotional_offers",title:"Promotional & offers",enabled:!1}]),u=v(!1),p=v(!1),r=v(!1),i=JSON.parse(localStorage.getItem("userData")||"{}"),_=async()=>{if(!i||!i.notification_preferences)return;const e=(await f.post("/provider/profile",{provider_id:i.id})).data.data;a.value=a.value.map(s=>({...s,enabled:e.notification_preferences[s.key]??!1})),console.log("Loaded preferences:",a.value)},m=async c=>{var e;if(!u.value){u.value=!0;try{const s={user_id:i.id,sign_up:a.value[0].enabled,receive_service_quotation:a.value[1].enabled,booking_job:a.value[2].enabled,review_and_rating:a.value[3].enabled,promotional_offers:a.value[4].enabled},o=await f.post("/savePreferencesProvider",s);o.data.success?l({type:"success",title:"Updated",message:"Preferences updated successfully."}):l({type:"error",title:"Failed",message:((e=o.data.errors)==null?void 0:e[0])||"Unable to update preference."})}catch(s){l({type:"error",title:"Error",message:s.message})}u.value=!1}},y=async()=>{var c;if(!r.value){r.value=!0;try{const e=await f.post("/deleteProviderAccount",{id:i.id});e.data.success?(l({type:"success",title:"Account Deletion",message:"Your account deletion is being processed."}),p.value=!1,localStorage.clear(),g.push("/login")):l({type:"error",title:"Failed",message:((c=e.data.errors)==null?void 0:c[0])||"Error deleting account."})}catch(e){l({type:"error",title:"Error",message:e.message})}r.value=!1}};return _(),(c,e)=>(n(),w(E,null,{default:h(()=>[t("div",j,[t("div",F,[t("button",{class:"back-btn",onClick:e[0]||(e[0]=s=>S(g).back())},[P(V)]),e[3]||(e[3]=t("h1",{class:"title"},"Account Settings",-1))]),t("div",I,[e[5]||(e[5]=t("h2",{class:"section-title"},"Push Notification",-1)),(n(!0),d(B,null,A(a.value,(s,o)=>(n(),d("div",{class:"settings-item",key:s.key},[t("span",null,N(s.title),1),t("label",$,[U(t("input",{type:"checkbox","onUpdate:modelValue":b=>a.value[o].enabled=b,onChange:b=>m(o),disabled:u.value},null,40,q),[[x,a.value[o].enabled]]),e[4]||(e[4]=t("span",{class:"slider"},null,-1))])]))),128)),t("button",{class:"delete-account-btn",onClick:e[1]||(e[1]=s=>p.value=!0)}," Delete my account ")])]),p.value?(n(),d("div",L,[t("div",R,[e[6]||(e[6]=t("h3",{class:"modal-title"},"Delete Account",-1)),e[7]||(e[7]=t("p",{class:"modal-message"}," Are you sure you want to delete your account? This action cannot be undone. ",-1)),t("div",M,[t("button",{class:"cancel-btn",onClick:e[2]||(e[2]=s=>p.value=!1)},"Cancel"),t("button",{class:"confirm-btn",onClick:y,disabled:r.value},[r.value?(n(),d("span",O)):(n(),d("span",T,"Delete"))],8,J)])])])):C("",!0)]),_:1}))}},X=k(Y,[["__scopeId","data-v-d4499aab"]]);export{X as default};
