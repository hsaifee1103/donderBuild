import{r as i,d as k,b as ae,c as ie,o,w as N,k as V,j as ne,a as t,f as a,g,F as _,p as C,t as n,i as q,v as H,q as de}from"./app-U24E4X8J.js";import{S as ue}from"./SetupLayout-Dn1UP6Iz.js";import{P as ce}from"./ProviderDashboardLayout-DUza5JUE.js";import"./NotificationDropdown-C1vcB40o.js";import"./x-DORMN0nV.js";const ve={class:"max-w-7xl mx-auto"},ge={key:0,class:"flex justify-center mt-20"},fe={key:1,class:"mt-6"},pe={class:"px-6 py-4 bg-white border-b border-gray-200"},xe={class:"flex items-center justify-between"},me={class:"text-lg font-semibold text-gray-900"},be={class:"flex items-center space-x-4"},ye={class:"flex items-center"},we={class:"mr-2 text-sm text-gray-600"},he={class:"relative inline-flex items-center cursor-pointer"},ke=["checked","onChange","disabled"],_e=["onClick"],Ce={key:0},Se=["onClick"],Me={class:"flex items-center"},je={class:"text-md font-medium text-gray-900"},Ae={key:0,class:"flex items-center mt-1"},Ee={class:"text-sm text-gray-500"},$e={key:0,class:"text-md font-medium text-gray-900"},Be={key:1,class:"px-6 py-8 text-center text-gray-500"},Le={key:2,class:"text-center py-12"},Ve={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50"},ze={class:"bg-white rounded-t-lg w-full max-w-md"},Ie={class:"p-6"},Pe={class:"flex justify-between items-center mb-6"},Te={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Fe={class:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto"},De={class:"p-6"},Ne={class:"flex justify-between items-center mb-6"},qe={class:"text-xl font-bold text-gray-900"},He={class:"mb-4"},Ue={class:"relative"},Ge=["disabled"],Re={class:"mb-4"},We={class:"px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100"},Ye={class:"mb-4"},Je={class:"text-right text-sm text-gray-500 mt-1"},Ke={class:"grid grid-cols-2 gap-4 mb-4"},Qe={class:"relative"},Xe={key:0,class:"text-red-500 text-xs mt-1"},Ze={class:"relative"},Oe={key:0,class:"text-red-500 text-xs mt-1"},et={class:"mb-6"},tt={class:"relative rounded-md shadow-sm"},st={key:0,class:"text-red-500 text-xs mt-1"},rt={class:"flex space-x-3"},lt=["disabled"],ot={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},at={class:"bg-white rounded-lg w-full max-w-md max-h-[70vh] overflow-y-auto"},it={class:"p-6"},nt={class:"flex justify-between items-center mb-4"},dt={key:0},ut={class:"space-y-2"},ct=["onClick"],vt={key:1,class:"text-center py-8 text-gray-500"},gt={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ft={class:"bg-white rounded-lg w-full max-w-md max-h-[70vh] overflow-y-auto"},pt={class:"p-6"},xt={class:"flex justify-between items-center mb-4"},mt={class:"space-y-2"},bt=["onClick"],yt={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},wt={class:"bg-white rounded-lg w-full max-w-md"},ht={class:"p-6"},kt={class:"flex justify-between items-center mb-4"},_t={class:"space-y-2"},Ct=["onClick"],Bt={__name:"Services",setup(St){const S=i(!1),M=i(!1),j=i(!1),u=i([]),z=i([]),d=i(null),x=i(null),A=i(null),T=i(null),m=i(""),b=i(""),y=i(""),f=i(""),I=i(!0),w=i(!1),E=i(!1),$=i(!1),B=i(!1),L=i(!1),h=k(()=>A.value!==null),U=k(()=>x.value&&b.value&&y.value&&m.value&&f.value),v=i({duration:"",priceType:"",price:""}),G=()=>{let r=!0;return v.value={duration:"",priceType:"",price:""},b.value||(v.value.duration="Duration is required",r=!1),y.value||(v.value.priceType="Price type is required",r=!1),(!f.value||parseFloat(f.value)<=0)&&(v.value.price="Price is required and must be greater than 0",r=!1),r},F=k(()=>{if(!d.value)return[];const r=d.value.id,e=z.value.filter(l=>l.id===r).flatMap(l=>l.sub_categories);if(!d.value.sub_categories)return[];const s=d.value.sub_categories.map(l=>l.sub_cat_id);return e.filter(l=>!s.includes(l.id))}),R=k(()=>Array.from({length:24},(r,e)=>{const s=(e+1)*15,l=Math.floor(s/60),p=s%60;return l>0?p>0?`${l}h ${p}min`:`${l}h`:`${s}min`})),W=k(()=>!d.value||!d.value.workflow?[]:d.value.workflow.split(", ")),Y=async()=>{try{const r=await V.get("/categories");r.data&&r.data.success&&(z.value=r.data.data||[])}catch(r){console.error("Error fetching categories:",r)}},J=async()=>{S.value=!0;try{const r=await V.get("/get-servcies");r.data&&r.data.success&&(u.value=r.data.data||[])}catch(r){console.error("Error fetching services:",r)}finally{S.value=!1}},K=async r=>{var e;if(!M.value){M.value=!0;try{const s=await V.post("/service-status-update",{category_id:r.id,isActive:!r.isActive});s.data&&s.data.success?r.isActive=!r.isActive:console.error("Error updating category status:",(e=s.data)==null?void 0:e.errors)}catch(s){console.error("Error updating category status:",s)}finally{M.value=!1}}},Q=r=>{d.value=r,w.value=!0},X=()=>{w.value=!1,D(),E.value=!0},Z=(r,e)=>{d.value=r,A.value=e;const s=r.id,p=z.value.filter(c=>c.id===s).flatMap(c=>c.sub_categories).find(c=>c.id===e.sub_cat_id);p&&(T.value=p,x.value=p),m.value=e.serviceDescription||"",f.value=e.price||"",b.value=e.service_duration||"",y.value=e.priceType||"",I.value=e.isActive,E.value=!0},P=()=>{E.value=!1,D()},D=()=>{x.value=null,A.value=null,T.value=null,m.value="",b.value="",y.value="",f.value="",I.value=!0},O=r=>{x.value=r,$.value=!1},ee=r=>{b.value=r,B.value=!1},te=r=>{y.value=r,L.value=!1},se=()=>{let r=f.value.replace(/[^\d.]/g,"");const e=r.split(".");e.length>2&&(r=e[0]+"."+e.slice(1).join("")),e.length===2&&e[1].length>2&&(r=e[0]+"."+e[1].substring(0,2)),f.value=r},re=async()=>{var r,e,s;if(!(!d.value||!x.value)&&G()){j.value=!0;try{const l=parseFloat(f.value).toFixed(2),p={cat_id:d.value.id,sub_cat_id:x.value.id,service_des:m.value,service_duration:b.value,price_type:y.value,price:l,isActive:I.value};h.value&&(p.service_id=A.value.id);const c=await V.post("/service-price",p);c.data&&c.data.success?(h.value?le(c.data.data):oe(c.data.data),P(),alert(h.value?"Service updated successfully!":"Service added successfully!")):(console.error("Error saving service:",(r=c.data)==null?void 0:r.errors),alert("Error saving service: "+(((s=(e=c.data)==null?void 0:e.errors)==null?void 0:s[0])||"Unknown error")))}catch(l){console.error("Error saving service:",l),alert("Error saving service: "+l.message)}finally{j.value=!1}}},le=r=>{if(!d.value)return;const e=u.value.findIndex(l=>l.id===d.value.id);if(e===-1)return;u.value[e].sub_categories||(u.value[e].sub_categories=[]);const s=u.value[e].sub_categories.findIndex(l=>l.id===r.id);s!==-1&&(u.value[e].sub_categories[s]=r)},oe=r=>{if(!d.value)return;const e=u.value.findIndex(s=>s.id===d.value.id);e!==-1&&(u.value[e].sub_categories||(u.value[e].sub_categories=[]),u.value[e].sub_categories.push(r))};return ae(()=>{Y(),J()}),(r,e)=>(o(),ie(ce,null,{default:N(()=>[ne(ue,null,{default:N(()=>[t("div",ve,[e[16]||(e[16]=t("div",{class:"mt-5"},[t("h1",{class:"text-2xl px-6 font-bold text-gray-900"},"Services"),t("p",{class:"text-gray-600 px-6"},"Set fixed prices for your services")],-1)),e[17]||(e[17]=t("div",{class:"px-6 mt-4"},[t("p",{class:"text-gray-600"}," Enter the fixed prices from the services you have selected, there is a base price for each service to prevent undercutting. You can changes these prices later. ")],-1)),S.value?(o(),a("div",ge,[...e[10]||(e[10]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500"},null,-1)])])):(o(),a("div",fe,[(o(!0),a(_,null,C(u.value,s=>(o(),a("div",{key:s.id,class:"bg-white rounded-lg mb-4 overflow-hidden"},[t("div",pe,[t("div",xe,[t("h2",me,n(s.name),1),t("div",be,[t("div",ye,[t("span",we,n(s.isActive?"Active":"Inactive"),1),t("label",he,[t("input",{type:"checkbox",class:"sr-only peer",checked:s.isActive,onChange:l=>K(s),disabled:M.value},null,40,ke),e[11]||(e[11]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-red-500"},null,-1))])]),t("button",{onClick:l=>Q(s),class:"text-gray-500 hover:text-gray-700"},[...e[12]||(e[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1)])],8,_e)])])]),s.sub_categories&&s.sub_categories.length>0?(o(),a("div",Ce,[(o(!0),a(_,null,C(s.sub_categories,l=>(o(),a("div",{key:l.id,class:"border-b border-gray-200 last:border-b-0"},[t("div",{class:"px-6 py-4 flex items-center justify-between hover:bg-gray-50 cursor-pointer",onClick:p=>Z(s,l)},[t("div",Me,[e[14]||(e[14]=t("div",{class:"w-1.5 h-12 bg-red-500 bg-opacity-50 rounded mr-4"},null,-1)),t("div",null,[t("h3",je,n(l.service_name),1),l.service_duration?(o(),a("div",Ae,[e[13]||(e[13]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 text-gray-500 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t("span",Ee,n(l.service_duration),1)])):g("",!0)])]),l.price?(o(),a("div",$e," from £"+n(l.price),1)):g("",!0)],8,Se)]))),128))])):(o(),a("div",Be," No services added yet "))]))),128))])),!S.value&&u.value.length===0?(o(),a("div",Le,[...e[15]||(e[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1),t("h3",{class:"mt-2 text-lg font-medium text-gray-900"},"No services",-1),t("p",{class:"mt-1 text-gray-500"},"Get started by adding a service category.",-1)])])):g("",!0)]),w.value?(o(),a("div",Ve,[t("div",ze,[t("div",Ie,[t("div",Pe,[e[19]||(e[19]=t("h3",{class:"text-xl font-bold text-gray-900"},"Add new",-1)),t("button",{onClick:e[0]||(e[0]=s=>w.value=!1),class:"text-gray-500 hover:text-gray-700"},[...e[18]||(e[18]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("button",{onClick:X,class:"w-full flex items-center p-4 mb-4 bg-gray-50 rounded-lg hover:bg-gray-100"},[...e[20]||(e[20]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-red-500 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),t("span",{class:"text-gray-700 font-medium"},"Add new sub service",-1)])]),t("button",{onClick:e[1]||(e[1]=s=>w.value=!1),class:"w-full flex items-center p-4 bg-gray-50 rounded-lg hover:bg-gray-100"},[...e[21]||(e[21]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-gray-500 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),t("span",{class:"text-gray-700 font-medium"},"Close",-1)])])])])])):g("",!0),E.value?(o(),a("div",Te,[t("div",Fe,[t("div",De,[t("div",Ne,[t("h3",qe,n(h.value?"Edit Service":"Add New Service"),1),t("button",{onClick:P,class:"text-gray-500 hover:text-gray-700"},[...e[22]||(e[22]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",He,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Service name",-1)),t("div",Ue,[t("button",{onClick:e[2]||(e[2]=s=>$.value=!0),class:"w-full text-left px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500 bg-gray-50",disabled:h.value},n(x.value?x.value.name:"--Select Service--"),9,Ge),e[23]||(e[23]=t("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"},[t("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))])]),t("div",Re,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Service type",-1)),t("div",We,n(d.value?d.value.name:""),1)]),t("div",Ye,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Service description",-1)),q(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>m.value=s),rows:"4",class:"shadow-sm focus:ring-red-500 focus:border-red-500 mt-1 block w-full sm:text-sm border border-gray-300 rounded-md p-3",placeholder:"Write about your service",maxlength:"500"},null,512),[[H,m.value]]),t("div",Je,n(500-m.value.length)+" characters left ",1)]),e[33]||(e[33]=t("div",{class:"h-2 bg-gray-100 my-6"},null,-1)),e[34]||(e[34]=t("h3",{class:"text-lg font-bold text-gray-900 mb-2"},"Pricing and duration",-1)),e[35]||(e[35]=t("p",{class:"text-gray-600 mb-4"},"Add the pricing options and duration of the service.",-1)),t("div",Ke,[t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Duration *",-1)),t("div",Qe,[t("button",{onClick:e[4]||(e[4]=s=>B.value=!0),class:"w-full text-left px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500"},n(b.value||"Select"),1),e[27]||(e[27]=t("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"},[t("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))]),v.value.duration?(o(),a("p",Xe,n(v.value.duration),1)):g("",!0)]),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Price type *",-1)),t("div",Ze,[t("button",{onClick:e[5]||(e[5]=s=>L.value=!0),class:"w-full text-left px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-red-500 focus:border-red-500"},n(y.value||"Select"),1),e[29]||(e[29]=t("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"},[t("svg",{class:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"})])],-1))]),v.value.priceType?(o(),a("p",Oe,n(v.value.priceType),1)):g("",!0)])]),t("div",et,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Retail price *",-1)),t("div",tt,[e[31]||(e[31]=t("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[t("span",{class:"text-gray-500 sm:text-sm"},"£")],-1)),q(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=s=>f.value=s),onInput:se,class:de(["focus:ring-red-500 focus:border-red-500 block w-full pl-7 pr-12 sm:text-sm rounded-md py-2",v.value.price?"border-red-500":"border-gray-300"]),placeholder:"00.00"},null,34),[[H,f.value]])]),v.value.price?(o(),a("p",st,n(v.value.price),1)):g("",!0)]),t("div",rt,[t("button",{onClick:P,class:"flex-1 px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Cancel "),t("button",{onClick:re,class:"flex-1 px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-500 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",disabled:j.value||!U.value},n(j.value?"Saving...":"Save"),9,lt)])])])])):g("",!0),$.value?(o(),a("div",ot,[t("div",at,[t("div",it,[t("div",nt,[e[37]||(e[37]=t("h3",{class:"text-xl font-bold text-gray-900"},"Select service",-1)),t("button",{onClick:e[7]||(e[7]=s=>$.value=!1),class:"text-gray-500 hover:text-gray-700"},[...e[36]||(e[36]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),F.value.length>0?(o(),a("div",dt,[t("div",ut,[(o(!0),a(_,null,C(F.value,s=>(o(),a("button",{key:s.id,onClick:l=>O(s),class:"w-full text-left px-4 py-3 border border-gray-200 rounded-md hover:bg-gray-50"},n(s.name),9,ct))),128))])])):(o(),a("div",vt," All services in this category are already added. "))])])])):g("",!0),B.value?(o(),a("div",gt,[t("div",ft,[t("div",pt,[t("div",xt,[e[39]||(e[39]=t("h3",{class:"text-xl font-bold text-gray-900"},"Select duration",-1)),t("button",{onClick:e[8]||(e[8]=s=>B.value=!1),class:"text-gray-500 hover:text-gray-700"},[...e[38]||(e[38]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",mt,[(o(!0),a(_,null,C(R.value,s=>(o(),a("button",{key:s,onClick:l=>ee(s),class:"w-full text-left px-4 py-3 border border-gray-200 rounded-md hover:bg-gray-50"},n(s),9,bt))),128))])])])])):g("",!0),L.value?(o(),a("div",yt,[t("div",wt,[t("div",ht,[t("div",kt,[e[41]||(e[41]=t("h3",{class:"text-xl font-bold text-gray-900"},"Select price type",-1)),t("button",{onClick:e[9]||(e[9]=s=>L.value=!1),class:"text-gray-500 hover:text-gray-700"},[...e[40]||(e[40]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",_t,[(o(!0),a(_,null,C(W.value,s=>(o(),a("button",{key:s,onClick:l=>te(s),class:"w-full text-left px-4 py-3 border border-gray-200 rounded-md hover:bg-gray-50"},n(s),9,Ct))),128))])])])])):g("",!0)]),_:1})]),_:1}))}};export{Bt as default};
