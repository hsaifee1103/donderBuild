import{r as i,d as D,b as T,c as V,o as u,w as H,y as J,u as O,a,f as c,g as h,n as v,t as g,i as I,v as A,k as b,I as G}from"./app-C7zuiOEw.js";import{P as Y}from"./ProviderDashboardLayout-BQ6qSee8.js";/* empty css                                                                        */import"./NotificationDropdown-Ywe_Y4sx.js";import"./x-BRj-0eBZ.js";const $={class:"max-w-7xl mx-auto"},K={class:"bg-white rounded-lg overflow-hidden"},R={class:"px-6 py-2"},q={class:"flex items-start space-x-6",style:{"align-items":"center"}},W={class:"relative mb-4"},Q=["src","alt","userDataJson"],X={class:"p-6"},Z={key:0,class:"mb-6 p-4 bg-green-50 text-green-700 rounded-lg"},ee={key:1,class:"mb-6 p-4 bg-red-50 text-red-700 rounded-lg"},ae={class:"flex items-start"},te={class:"space-y-0 shadow border rounded-lg border-gray-200"},se={class:"p-4 border-b border-gray-200"},re={class:"p-4 border-b border-gray-200"},oe={class:"p-4 border-b border-gray-200"},le={class:"flex justify-between items-center"},ne={class:"text-gray-900"},ie={class:"p-4"},de={class:"flex justify-between items-center"},ue={class:"text-gray-900"},me={class:"mt-8 flex justify-between"},ce=["disabled"],ge={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},fe={key:1,class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ve=["disabled"],pe={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ye={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},he={class:"bg-white rounded-lg p-6 max-w-md w-full"},xe={class:"flex justify-end space-x-3"},_e=["disabled"],be="https://static.vecteezy.com/system/resources/previews/036/594/092/non_2x/man-empty-avatar-photo-placeholder-for-social-networks-resumes-forums-and-dating-sites-male-and-female-no-photo-images-for-unfilled-user-profile-free-vector.jpg",Ae={__name:"Profile",setup(we){const p=O(),w=i(null),n=i({first_name:"",last_name:"",email:"",phone:"",image_url:"",country_code:"+44",id:null}),l=i({first_name:"",last_name:"",phone:"",email:""}),f=i(!1),s=i(""),d=i(!1),m=i(!1),x=i(!1),y=i(!1),k=i({name:"United Kingdom",dial_code:"+44",code:"GB",flag:"gb"}),P=D(()=>`${n.value.first_name} ${n.value.last_name}`),C=D(()=>l.value.first_name.trim()!==""&&l.value.last_name.trim()!==""),M=async()=>{try{await J();const o=localStorage.getItem("userData");if(o)try{const e=JSON.parse(o);if(console.log("Loaded user data from localStorage:",o),n.value={first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",phone:e.mobile||"",image_url:(e==null?void 0:e.image_url)||"",country_code:e.country_code||"+44",id:e.id||null},l.value={first_name:e.first_name||"",last_name:e.last_name||"",phone:e.mobile||"",email:e.email||""},e.country_code){const r=F.find(t=>t.dial_code===e.country_code);r&&(k.value=r)}}catch(e){console.error("Error parsing user data:",e)}}catch(o){console.error("Error loading user data:",o)}},S=()=>{x.value=!0},B=async()=>{if(!C.value){s.value="First name and last name are required";return}d.value=!0,s.value="";try{const o={id:n.value.id,firstname:l.value.first_name,lastname:l.value.last_name};console.log("Sending update data:",o);const e=await b.post("/updateProfile",o);if(e.data&&e.data.success){n.value.first_name=l.value.first_name,n.value.last_name=l.value.last_name;const r=JSON.parse(localStorage.getItem("userData")||"{}");r.first_name=l.value.first_name,r.last_name=l.value.last_name,localStorage.setItem("userData",JSON.stringify(r)),G({type:"success",title:"Profile updated successfully",message:"Your profile has been updated successfully."}),f.value=!0,setTimeout(()=>{f.value=!1},3e3),x.value=!1}else e.data.errors&&Array.isArray(e.data.errors)&&e.data.errors.length>0?s.value=e.data.errors[0]:e.data.message?s.value=e.data.message:s.value="Failed to update profile. Please try again."}catch(o){if(console.error("Error updating profile:",o),o.response&&o.response.data){const e=o.response.data;e.errors&&Array.isArray(e.errors)&&e.errors.length>0?s.value=e.errors[0]:e.message?s.value=e.message:s.value="An error occurred while updating your profile. Please try again."}else s.value="An error occurred while updating your profile. Please try again."}finally{d.value=!1}},L=()=>{w.value.click()},z=async o=>{const e=o.target.files[0];if(e){if(!e.type.startsWith("image/")){s.value="Please select an image file";return}if(e.size>2*1024*1024){s.value="Image size must be less than 2MB";return}d.value=!0,s.value="";try{const r=new FormData;r.append("image",e),r.append("provider_id",n.value.id);const t=await b.post("/updateProfileImg",r,{headers:{"Content-Type":"multipart/form-data"}});if(t.data&&t.data.success){if(t.data.data&&t.data.data.image_url){n.value.image_url=t.data.data.image_url;const _=JSON.parse(localStorage.getItem("userData")||"{}");_.image=_.image||{},_.image.image_url=t.data.data.image_url,localStorage.setItem("userData",JSON.stringify(t.data.data)),f.value=!0,setTimeout(()=>{f.value=!1},3e3)}}else t.data.errors&&Array.isArray(t.data.errors)&&t.data.errors.length>0?s.value=t.data.errors[0]:t.data.message?s.value=t.data.message:s.value="Failed to upload image. Please try again."}catch(r){if(console.error("Error uploading image:",r),r.response&&r.response.data){const t=r.response.data;t.errors&&Array.isArray(t.errors)&&t.errors.length>0?s.value=t.errors[0]:t.message?s.value=t.message:s.value="An error occurred while uploading your image. Please try again."}else s.value="An error occurred while uploading your image. Please try again."}finally{d.value=!1}}},N=()=>{p.push("/provider/update-phone")},U=()=>{p.push("/provider/update-email")},j=()=>{y.value=!0},E=async()=>{m.value=!0;try{await b.post("/provider/logout"),localStorage.removeItem("authToken"),localStorage.removeItem("userData"),p.push("/login")}catch(o){console.error("Error during logout:",o),localStorage.removeItem("authToken"),localStorage.removeItem("userData"),p.push("/login")}finally{m.value=!1,y.value=!1}},F=[{name:"United Kingdom",dial_code:"+44",code:"GB",flag:"gb"},{name:"United States",dial_code:"+1",code:"US",flag:"us"},{name:"India",dial_code:"+91",code:"IN",flag:"in"},{name:"Germany",dial_code:"+49",code:"DE",flag:"de"},{name:"France",dial_code:"+33",code:"FR",flag:"fr"},{name:"Australia",dial_code:"+61",code:"AU",flag:"au"}];return T(()=>{M()}),(o,e)=>(u(),V(Y,null,{default:H(()=>[a("div",$,[e[17]||(e[17]=a("div",{class:"mt-5"},[a("h1",{class:"text-2xl px-6 font-bold text-gray-900"},"Personal Info")],-1)),a("div",K,[a("div",R,[a("div",q,[a("div",W,[a("img",{src:n.value.image_url||be,alt:P.value,class:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-md",userDataJson:JSON.stringify(n.value)},null,8,Q),a("input",{type:"file",ref_key:"fileInput",ref:w,onChange:z,class:"hidden",accept:"image/*"},null,544)]),a("button",{onClick:L,class:"text-red-500 hover:text-red-600 bg-red-100 hover:bg-red-200 rounded-md px-4 py-2 font-medium flex items-center"},[...e[3]||(e[3]=[a("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),v(" Change profile picture ",-1)])])])]),a("div",X,[e[16]||(e[16]=a("h2",{class:"text-lg font-semibold text-gray-900 mb-6"},"Personal Information",-1)),f.value?(u(),c("div",Z,[...e[4]||(e[4]=[a("div",{class:"flex items-start"},[a("svg",{class:"h-5 w-5 text-green-500 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),a("p",null,"Your profile has been updated successfully!")],-1)])])):h("",!0),s.value?(u(),c("div",ee,[a("div",ae,[e[5]||(e[5]=a("svg",{class:"h-5 w-5 text-red-500 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),a("p",null,g(s.value),1)])])):h("",!0),a("div",te,[a("div",se,[e[6]||(e[6]=a("p",{class:"text-sm font-medium text-gray-500 mb-1"},"First name",-1)),I(a("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>l.value.first_name=r),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500",onInput:S},null,544),[[A,l.value.first_name]])]),a("div",re,[e[7]||(e[7]=a("p",{class:"text-sm font-medium text-gray-500 mb-1"},"Last name",-1)),I(a("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>l.value.last_name=r),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500",onInput:S},null,544),[[A,l.value.last_name]])]),a("div",oe,[a("div",le,[a("div",null,[e[8]||(e[8]=a("p",{class:"text-sm font-medium text-gray-500 mb-1"},"Phone",-1)),a("p",ne,g(k.value.dial_code)+" "+g(n.value.phone),1)]),a("button",{onClick:N,class:"text-red-500 hover:text-red-600 font-medium flex items-center"},[...e[9]||(e[9]=[a("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),v(" Edit ",-1)])])])]),a("div",ie,[a("div",de,[a("div",null,[e[10]||(e[10]=a("p",{class:"text-sm font-medium text-gray-500 mb-1"},"Email",-1)),a("p",ue,g(n.value.email),1)]),a("button",{onClick:U,class:"text-red-500 hover:text-red-600 font-medium flex items-center"},[...e[11]||(e[11]=[a("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),v(" Edit ",-1)])])])])]),a("div",me,[a("button",{onClick:j,class:"px-4 py-2 text-red-500 hover:text-red-600 font-medium flex items-center",disabled:m.value},[m.value?(u(),c("svg",ge,[...e[12]||(e[12]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(u(),c("svg",fe,[...e[13]||(e[13]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"},null,-1)])])),e[14]||(e[14]=v(" Logout ",-1))],8,ce),a("button",{onClick:B,class:"px-6 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 font-medium flex items-center",disabled:d.value||!x.value||!C.value},[d.value?(u(),c("svg",pe,[...e[15]||(e[15]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):h("",!0),v(" "+g(d.value?"Saving...":"Save"),1)],8,ve)])])])]),y.value?(u(),c("div",ye,[a("div",he,[e[18]||(e[18]=a("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Are you sure you want to logout?",-1)),e[19]||(e[19]=a("p",{class:"text-gray-600 mb-6"}," By logging out, you will not have access to your bookings and notifications. To gain access again, you must log back in. ",-1)),a("div",xe,[a("button",{onClick:e[2]||(e[2]=r=>y.value=!1),class:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium"}," No, cancel "),a("button",{onClick:E,class:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 font-medium",disabled:m.value},g(m.value?"Logging out...":"Yes, logout"),9,_e)])])])):h("",!0)]),_:1}))}};export{Ae as default};
