import{l as j,r as y,c as p,d as B,e as R,a as V,o as r,w as T,k as I,u as L,b as e,f as o,j as g,n as N,E as h,t as n,F as _,p as f,q as v,g as M}from"./app-CWmiax_p.js";import{P as q}from"./ProviderDashboardLayout-bZZ5hgUH.js";import{c as A,a as E}from"./x-CM3hx-6f.js";import"./NotificationDropdown-V91OdzbG.js";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=A("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),O={class:"p-6 bg-white rounded-xl shadow-sm border border-gray-200"},$={class:"mb-6"},z={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},U={class:"flex flex-col sm:flex-row justify-between gap-4 mb-6"},G={class:"flex items-center gap-2 bg-gray-50 px-4 py-2 rounded-lg"},H={class:"text-sm font-medium text-gray-700"},P={key:0,class:"flex justify-center items-center py-12"},Y={key:1},J={class:"overflow-x-auto"},K={class:"min-w-full divide-y divide-gray-200"},Q={class:"bg-white divide-y divide-gray-200"},W={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},X={class:"px-6 py-4 whitespace-nowrap"},Z={class:"flex items-center"},ee={class:"flex-shrink-0 h-10 w-10"},te=["src"],se={key:1,class:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center"},ae={class:"text-gray-600 font-medium"},re={class:"ml-4"},oe={class:"text-sm font-medium text-gray-900"},ne={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},le={class:"text-xs"},ie={class:"px-6 py-4 whitespace-nowrap"},de={class:"px-6 py-4 whitespace-nowrap"},ce={class:"px-6 py-4 text-sm text-gray-500"},ue={key:0},pe={key:0,class:"text-xs text-gray-400"},me={key:1,class:"text-gray-400"},xe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},ye={key:2,class:"text-center py-12"},ge={__name:"Reports",setup(he){const u=R();L();const m=y(!0),c=y([]),l=y({start:"",end:""}),w=p(()=>{if(!l.value.start||!l.value.end)return"Select date range";const s=new Date(l.value.start),t=new Date(l.value.end);return`${s.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})} - ${t.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}`});p(()=>c.value.reduce((s,t)=>s+parseFloat(t.total_price),0)),p(()=>c.value.filter(s=>s.status==="completed").length),p(()=>c.value.filter(s=>s.status==="pending").length);const b=s=>{switch(s){case"completed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"in_progress":return"bg-blue-100 text-blue-800";case"upcoming":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},k=s=>s.replace("_"," ").replace(/\b\w/g,t=>t.toUpperCase()),D=async()=>{m.value=!0;try{const s=JSON.parse(localStorage.getItem("userData")||"{}"),t=await I.post("/get-all-booking",{provider_id:s.id,status:"completed",start_date:l.value.start,end_date:l.value.end});t.data&&t.data.success&&(c.value=t.data.data)}catch(s){console.error("Error fetching bookings:",s)}finally{m.value=!1}},S=()=>{const t=[["Booking ID","Customer","Date","Time","Type","Status","Services","Amount"].join(","),...c.value.map(d=>[d.id,d.customer_name,d.booking_date,d.booking_time,d.booking_type,d.status,d.services.map(C=>C.name).join("; "),d.total_price].join(","))].join(`
`),a=new Blob([t],{type:"text/csv;charset=utf-8;"}),x=URL.createObjectURL(a),i=document.createElement("a");i.setAttribute("href",x),i.setAttribute("download",`bookings-report-${l.value.start}-to-${l.value.end}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)};return B(()=>{if(u.query.startDate&&u.query.endDate)l.value={start:u.query.startDate,end:u.query.endDate};else{const s=new Date,t=new Date(s.getFullYear(),s.getMonth(),1),a=new Date(s.getFullYear(),s.getMonth()+1,0);l.value={start:t.toISOString().split("T")[0],end:a.toISOString().split("T")[0]}}D()}),(s,t)=>(r(),V(q,null,{default:T(()=>[e("div",O,[e("div",$,[e("div",z,[t[1]||(t[1]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-800"},"Booking Reports"),e("p",{class:"text-gray-500"},"View and analyze your booking data.")],-1)),e("button",{onClick:S,class:"mt-3 sm:mt-0 flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"},[g(h(F),{class:"w-4 h-4"}),t[0]||(t[0]=N(" Export CSV ",-1))])])]),e("div",U,[e("div",G,[g(h(E),{class:"w-4 h-4 text-gray-500"}),e("span",H,n(w.value),1)])]),m.value?(r(),o("div",P,[...t[2]||(t[2]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500"},null,-1)])])):c.value.length>0?(r(),o("div",Y,[e("div",J,[e("table",K,[t[3]||(t[3]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Booking ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Customer"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date & Time "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Services"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount")])],-1)),e("tbody",Q,[(r(!0),o(_,null,f(c.value,a=>(r(),o("tr",{key:a.id,class:"hover:bg-gray-50"},[e("td",W," #"+n(a.id),1),e("td",X,[e("div",Z,[e("div",ee,[a.customer_profile_image?(r(),o("img",{key:0,src:a.customer_profile_image,class:"h-10 w-10 rounded-full object-cover",alt:""},null,8,te)):(r(),o("div",se,[e("span",ae,n(a.customer_name.charAt(0)),1)]))]),e("div",re,[e("div",oe,n(a.customer_name),1)])])]),e("td",ne,[e("div",null,n(a.booking_date),1),e("div",le,n(a.booking_time),1)]),e("td",ie,[e("span",{class:v(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",a.booking_type==="normal"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"])},n(a.booking_type),3)]),e("td",de,[e("span",{class:v(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",b(a.status)])},n(k(a.status)),3)]),e("td",ce,[a.services&&a.services.length>0?(r(),o("div",ue,[(r(!0),o(_,null,f(a.services.slice(0,2),(x,i)=>(r(),o("div",{key:i},n(x.name),1))),128)),a.services.length>2?(r(),o("div",pe," +"+n(a.services.length-2)+" more ",1)):M("",!0)])):(r(),o("span",me,"No services"))]),e("td",xe," Â£"+n(a.total_price),1)]))),128))])])])])):(r(),o("div",ye,[...t[4]||(t[4]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No bookings found",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"Try adjusting your filters or date range.",-1)])]))])]),_:1}))}},be=j(ge,[["__scopeId","data-v-e5791811"]]);export{be as default};
