import{l as V,r as v,d as z,b as U,f as n,o as r,j,a,E as x,g as f,t as m,h as k,F as y,p as S,q as A,i as D,B as I,s as P,k as w,u as $,e as O}from"./app-CTtqvBQy.js";import{o as R,_ as q}from"./useOnboarding-Y2-85MG5.js";const J={class:"page"},W={class:"container"},Y={key:0,class:"flex justify-center py-8"},G={key:1,class:"mb-4 p-3 bg-red-50 text-red-700 rounded-lg"},H={class:"flex items-start"},K={class:"text-sm"},Q=["onClick"],X={class:"flex items-center"},Z=["checked","onChange"],ee={class:"ml-3 font-medium text-gray-900"},se={key:0,class:"group-body"},te={class:"space-y-3"},ae=["onUpdate:modelValue"],oe={class:"ml-3 text-gray-700"},le={__name:"SignupBusinessServices",setup(ne){const h=$(),C=O(),{step:B,totalSteps:E,nextStep:T}=R(),g=v(!1),d=v(!0),i=v(""),c=v([]),L=async()=>{var o,e,t;d.value=!0,i.value="";try{const s=localStorage.getItem("authToken");s&&P(s);const l=await w.get("/categories");l.data&&l.data.success?c.value=l.data.data.map(u=>({...u,selected:!1,expanded:!1,sub_categories:u.sub_categories.map(p=>({...p,selected:!1}))})):i.value=((o=l.data)==null?void 0:o.message)||"Failed to fetch categories."}catch(s){console.error("Error fetching categories:",s),i.value=((t=(e=s==null?void 0:s.response)==null?void 0:e.data)==null?void 0:t.message)||"Failed to fetch categories."}finally{d.value=!1}},M=o=>{const e=c.value.find(t=>t.id===o);e&&(e.expanded=!e.expanded)},F=o=>{const e=c.value.find(t=>t.id===o);e&&(e.selected=!e.selected,e.selected?(e.expanded=!0,e.sub_categories.forEach(t=>{t.selected=!0})):e.sub_categories.forEach(t=>{t.selected=!1}))},_=z(()=>c.value.some(o=>o.sub_categories.some(e=>e.selected)));async function b(){var o,e,t;if(_.value){g.value=!0,i.value="";try{const s=[];c.value.forEach(u=>{u.sub_categories.forEach(p=>{p.selected&&s.push(p.id)})});const l=await w.post("/add-business-step-2",{sub_cat_id:s});l.data&&l.data.success?(localStorage.setItem("onboarding-services",JSON.stringify({categories:c.value,selectedSubCategories:s})),T(),h.push({name:"SignupTeamSize",params:{userType:C.params.userType}})):i.value=((o=l.data)==null?void 0:o.message)||"Failed to save services."}catch(s){console.error("Error saving services:",s),i.value=((t=(e=s==null?void 0:s.response)==null?void 0:e.data)==null?void 0:t.message)||"An unexpected error occurred while saving services."}finally{g.value=!1}}}function N(){h.back()}return U(()=>{L()}),(o,e)=>(r(),n("div",J,[j(q,{step:x(B),"total-steps":x(E),"continue-disabled":!_.value||g.value,onBack:N,onContinue:b},null,8,["step","total-steps","continue-disabled"]),a("main",W,[e[4]||(e[4]=a("section",{class:"lead"},[a("p",{class:"eyebrow"},"ACCOUNT SETUP"),a("h1",{class:"title"},"Which Service Do You Provide?"),a("p",{class:"subtitle"},"Please carefully select the services you provide. Try to tailor your choices as closely as possible to your business.")],-1)),d.value?(r(),n("div",Y,[...e[0]||(e[0]=[a("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-red-500"},null,-1)])])):f("",!0),i.value?(r(),n("div",G,[a("div",H,[e[2]||(e[2]=a("svg",{class:"h-5 w-5 text-red-500 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),a("div",null,[e[1]||(e[1]=a("p",{class:"font-medium"},"Error",-1)),a("p",K,m(i.value),1)])])])):f("",!0),d.value?f("",!0):(r(),n("form",{key:2,class:"space-y-4",onSubmit:k(b,["prevent"])},[(r(!0),n(y,null,S(c.value,t=>(r(),n("div",{class:"group-box",key:t.id},[a("div",{class:"group-header",onClick:s=>M(t.id)},[a("div",X,[a("input",{type:"checkbox",checked:t.selected,class:"h-5 w-5 text-red-500 rounded",onChange:k(s=>F(t.id),["stop"])},null,40,Z),a("span",ee,m(t.name),1)]),(r(),n("svg",{class:A([{"rotate-180":t.expanded},"w-5 h-5 text-gray-500 transition-transform"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[3]||(e[3]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,Q),t.expanded?(r(),n("div",se,[a("div",te,[(r(!0),n(y,null,S(t.sub_categories,s=>(r(),n("label",{key:s.id,class:"sub-row"},[D(a("input",{type:"checkbox","onUpdate:modelValue":l=>s.selected=l,class:"h-4 w-4 text-red-500 rounded"},null,8,ae),[[I,s.selected]]),a("span",oe,m(s.name),1)]))),128))])])):f("",!0)]))),128))],32))])]))}},ce=V(le,[["__scopeId","data-v-27d4321e"]]);export{ce as default};
