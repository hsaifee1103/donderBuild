import{r as c,d as $,b as E,c as M,o as r,w as L,y as z,u as N,a,n as g,f as d,g as C,t as v,i as b,v as h,j as V,k as S}from"./app-7omrHMIl.js";import{C as F}from"./CustomerDashboardLayout-BJdMaqyE.js";import{C as A}from"./CountrySelector-fba8YR1S.js";import"./NotificationDropdown-Dm0J_f0s.js";import"./x-xBI7ug-0.js";import"./countries-DXaTS7mb.js";/* empty css                                                                        */const P={class:"max-w-7xl mx-auto"},H={class:"bg-white rounded-lg overflow-hidden"},J={class:"px-6 py-2"},O={class:"flex items-start space-x-6 align-items-center",style:{"align-items":"center"}},T={class:"relative mb-4"},G=["src","alt"],K={class:"p-6"},R={key:0,class:"mb-6 p-4 bg-green-50 text-green-700 rounded-lg"},W={key:1,class:"mb-6 p-4 bg-red-50 text-red-700 rounded-lg"},Y={class:"flex items-start"},q={class:"space-y-6 shadow border p-6 rounded-lg border-gray-200"},Q={class:"flex items-center justify-between p-4 border-b border-gray-200 hover:bg-gray-50"},X={class:"flex-1"},Z={key:0},ee={class:"text-gray-900"},ae={key:1,class:"mt-1"},te={key:1,class:"ml-4 flex space-x-2"},se=["disabled"],oe={class:"flex items-center justify-between p-4 border-b border-gray-200 hover:bg-gray-50"},le={class:"flex-1"},re={key:0},ne={class:"text-gray-900"},ie={key:1,class:"mt-1"},de={key:1,class:"ml-4 flex space-x-2"},ue=["disabled"],me={class:"flex items-center justify-between p-4 border-b border-gray-200 hover:bg-gray-50"},ve={class:"flex-1"},ce={key:0},pe={class:"text-gray-900"},fe={key:1,class:"mt-1 flex"},ge={class:"w-1/4 mr-2"},ye={key:1,class:"ml-4 flex space-x-2"},_e=["disabled"],xe={class:"flex items-center justify-between p-4 hover:bg-gray-50"},be={class:"flex-1"},he={key:0},ke={class:"text-gray-900"},we={key:1,class:"mt-1"},Ce={key:1,class:"ml-4 flex space-x-2"},Se=["disabled"],De="https://via.placeholder.com/150",ze={__name:"Profile",setup(je){N();const k=c(null),n=c({first_name:"",last_name:"",email:"",phone:"",image_url:"",country_code:"+44",id:null}),m=c({first_name:!1,last_name:!1,phone:!1,email:!1}),s=c({first_name:"",last_name:"",phone:"",email:""}),f=c(!1),i=c(""),u=c(!1),p=c({name:"United Kingdom",dial_code:"+44",code:"GB",flag:"gb"}),D=$(()=>`${n.value.first_name} ${n.value.last_name}`),j=async()=>{try{await z();const o=localStorage.getItem("userData");if(o)try{const e=JSON.parse(o);if(n.value={first_name:e.first_name||"",last_name:e.last_name||"",email:e.email||"",phone:e.mobile||"",image_url:e.image.image_url||"",country_code:e.country_code||"+44",id:e.id||null},s.value={first_name:e.first_name||"",last_name:e.last_name||"",phone:e.mobile||"",email:e.email||""},e.country_code){const t=U.find(l=>l.dial_code===e.country_code);t&&(p.value=t)}}catch(e){console.error("Error parsing user data:",e)}}catch(o){console.error("Error loading user data:",o)}},y=o=>{m.value[o]=!0,s.value[o]=n.value[o]},_=o=>{m.value[o]=!1,s.value[o]=n.value[o]},x=async o=>{u.value=!0,i.value="";try{const e={};switch(o){case"first_name":e.firstname=s.value.first_name;break;case"last_name":e.lastname=s.value.last_name;break;case"phone":e.mobile=s.value.phone,e.country_code=p.value.dial_code;break;case"email":e.email=s.value.email;break}const t=await S.post("/customer-profile/update",e);if(t.data&&t.data.success){switch(o){case"first_name":n.value.first_name=s.value.first_name;break;case"last_name":n.value.last_name=s.value.last_name;break;case"phone":n.value.phone=s.value.phone,n.value.country_code=p.value.dial_code;break;case"email":n.value.email=s.value.email;break}const l=JSON.parse(localStorage.getItem("userData")||"{}");switch(o){case"first_name":l.first_name=s.value.first_name;break;case"last_name":l.last_name=s.value.last_name;break;case"phone":l.mobile=s.value.phone,l.country_code=p.value.dial_code;break;case"email":l.email=s.value.email;break}localStorage.setItem("userData",JSON.stringify(l)),f.value=!0,setTimeout(()=>{f.value=!1},3e3),m.value[o]=!1}else t.data.errors&&Array.isArray(t.data.errors)&&t.data.errors.length>0?i.value=t.data.errors.join(", "):t.data.message?i.value=t.data.message:i.value="Failed to update profile. Please try again.",s.value[o]=n.value[o]}catch(e){console.error("Error updating profile:",e),e.response&&e.response.data&&e.response.data.errors?i.value=e.response.data.errors.join(", "):e.response&&e.response.data&&e.response.data.message?i.value=e.response.data.message:i.value="An error occurred while updating your profile. Please try again.",s.value[o]=n.value[o]}finally{u.value=!1}},I=()=>{k.value.click()},B=async o=>{const e=o.target.files[0];if(e){if(!e.type.startsWith("image/")){i.value="Please select an image file";return}if(e.size>2*1024*1024){i.value="Image size must be less than 2MB";return}u.value=!0,i.value="";try{const t=new FormData;t.append("image",e);const l=await S.post("/customer-profile/image",t,{headers:{"Content-Type":"multipart/form-data"}});if(l.data&&l.data.success){if(l.data.data&&l.data.data.file_path){n.value.image_url=l.data.data.file_path;const w=JSON.parse(localStorage.getItem("userData")||"{}");w.image_url=l.data.data.file_path,localStorage.setItem("userData",JSON.stringify(w)),f.value=!0,setTimeout(()=>{f.value=!1},3e3)}}else l.data.errors&&Array.isArray(l.data.errors)&&l.data.errors.length>0?i.value=l.data.errors.join(", "):l.data.message?i.value=l.data.message:i.value="Failed to upload image. Please try again."}catch(t){console.error("Error uploading image:",t),t.response&&t.response.data&&t.response.data.errors?i.value=t.response.data.errors.join(", "):t.response&&t.response.data&&t.response.data.message?i.value=t.response.data.message:i.value="An error occurred while uploading your image. Please try again."}finally{u.value=!1}}},U=[{name:"United Kingdom",dial_code:"+44",code:"GB",flag:"gb"},{name:"United States",dial_code:"+1",code:"US",flag:"us"},{name:"India",dial_code:"+91",code:"IN",flag:"in"},{name:"Germany",dial_code:"+49",code:"DE",flag:"de"},{name:"France",dial_code:"+33",code:"FR",flag:"fr"},{name:"Australia",dial_code:"+61",code:"AU",flag:"au"}];return E(()=>{j()}),(o,e)=>(r(),M(F,null,{default:L(()=>[a("div",P,[e[29]||(e[29]=a("div",{class:"mt-5"},[a("h1",{class:"text-2xl px-6 font-bold text-gray-900"},"Personal Info")],-1)),a("div",H,[a("div",J,[a("div",O,[a("div",T,[a("img",{src:n.value.image_url||De,alt:D.value,class:"w-24 h-24 rounded-full object-cover border-4 border-white shadow-md"},null,8,G),a("input",{type:"file",ref_key:"fileInput",ref:k,onChange:B,class:"hidden",accept:"image/*"},null,544)]),a("button",{onClick:I,class:"text-red-500 hover:text-red-600 bg-red-100 hover:bg-red-200 rounded-md px-4 py-2 font-medium flex items-center"},[...e[17]||(e[17]=[a("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})],-1),g(" Change Image ",-1)])])])]),a("div",K,[e[28]||(e[28]=a("h2",{class:"text-lg font-semibold text-gray-900 mb-6"},"Personal Information",-1)),f.value?(r(),d("div",R,[...e[18]||(e[18]=[a("div",{class:"flex items-start"},[a("svg",{class:"h-5 w-5 text-green-500 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),a("p",null,"Your profile has been updated successfully!")],-1)])])):C("",!0),i.value?(r(),d("div",W,[a("div",Y,[e[19]||(e[19]=a("svg",{class:"h-5 w-5 text-red-500 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[a("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),a("p",null,v(i.value),1)])])):C("",!0),a("div",q,[a("div",Q,[a("div",X,[e[20]||(e[20]=a("p",{class:"text-sm font-medium text-gray-500"},"First name",-1)),m.value.first_name?(r(),d("div",ae,[b(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.first_name=t),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"},null,512),[[h,s.value.first_name]])])):(r(),d("div",Z,[a("p",ee,v(n.value.first_name),1)]))]),m.value.first_name?(r(),d("div",te,[a("button",{onClick:e[2]||(e[2]=t=>_("first_name")),class:"px-3 py-1 text-gray-600 hover:text-gray-800"}," Cancel "),a("button",{onClick:e[3]||(e[3]=t=>x("first_name")),class:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",disabled:u.value},v(u.value?"Saving...":"Save"),9,se)])):(r(),d("button",{key:0,onClick:e[1]||(e[1]=t=>y("first_name")),class:"ml-4 text-red-500 hover:text-red-600 font-medium flex items-center"},[...e[21]||(e[21]=[a("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),g(" Edit ",-1)])]))]),a("div",oe,[a("div",le,[e[22]||(e[22]=a("p",{class:"text-sm font-medium text-gray-500"},"Last name",-1)),m.value.last_name?(r(),d("div",ie,[b(a("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.value.last_name=t),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"},null,512),[[h,s.value.last_name]])])):(r(),d("div",re,[a("p",ne,v(n.value.last_name),1)]))]),m.value.last_name?(r(),d("div",de,[a("button",{onClick:e[6]||(e[6]=t=>_("last_name")),class:"px-3 py-1 text-gray-600 hover:text-gray-800"}," Cancel "),a("button",{onClick:e[7]||(e[7]=t=>x("last_name")),class:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",disabled:u.value},v(u.value?"Saving...":"Save"),9,ue)])):(r(),d("button",{key:0,onClick:e[5]||(e[5]=t=>y("last_name")),class:"ml-4 text-red-500 hover:text-red-600 font-medium flex items-center"},[...e[23]||(e[23]=[a("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),g(" Edit ",-1)])]))]),a("div",me,[a("div",ve,[e[24]||(e[24]=a("p",{class:"text-sm font-medium text-gray-500"},"Phone",-1)),m.value.phone?(r(),d("div",fe,[a("div",ge,[V(A,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=t=>p.value=t)},null,8,["modelValue"])]),b(a("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>s.value.phone=t),type:"tel",class:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"},null,512),[[h,s.value.phone]])])):(r(),d("div",ce,[a("p",pe,v(n.value.phone),1)]))]),m.value.phone?(r(),d("div",ye,[a("button",{onClick:e[11]||(e[11]=t=>_("phone")),class:"px-3 py-1 text-gray-600 hover:text-gray-800"}," Cancel "),a("button",{onClick:e[12]||(e[12]=t=>x("phone")),class:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",disabled:u.value},v(u.value?"Saving...":"Save"),9,_e)])):(r(),d("button",{key:0,onClick:e[10]||(e[10]=t=>y("phone")),class:"ml-4 text-red-500 hover:text-red-600 font-medium flex items-center"},[...e[25]||(e[25]=[a("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),g(" Edit ",-1)])]))]),a("div",xe,[a("div",be,[e[26]||(e[26]=a("p",{class:"text-sm font-medium text-gray-500"},"Email",-1)),m.value.email?(r(),d("div",we,[b(a("input",{"onUpdate:modelValue":e[13]||(e[13]=t=>s.value.email=t),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"},null,512),[[h,s.value.email]])])):(r(),d("div",he,[a("p",ke,v(n.value.email),1)]))]),m.value.email?(r(),d("div",Ce,[a("button",{onClick:e[15]||(e[15]=t=>_("email")),class:"px-3 py-1 text-gray-600 hover:text-gray-800"}," Cancel "),a("button",{onClick:e[16]||(e[16]=t=>x("email")),class:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",disabled:u.value},v(u.value?"Saving...":"Save"),9,Se)])):(r(),d("button",{key:0,onClick:e[14]||(e[14]=t=>y("email")),class:"ml-4 text-red-500 hover:text-red-600 font-medium flex items-center"},[...e[27]||(e[27]=[a("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),g(" Edit ",-1)])]))])])])])])]),_:1}))}};export{ze as default};
