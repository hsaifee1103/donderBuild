import{l as Pe,r as f,d as Oe,J as Ze,f as r,g as d,o as l,b as e,F as R,p as T,t as n,q as y,K as ft,i as ce,v as ue,k as I,I as q,z as bt,c as de,a as ee,w as _t,e as yt,u as ht,n as A,L as Ve,M as B}from"./app-Dc5tvvr1.js";import{P as xt}from"./ProviderDashboardLayout-CxuYajoD.js";import{_ as wt}from"./StatusTimeline-C3Tb0-m6.js";import{l as Ct}from"./index-BJbuQlN4.js";import"./NotificationDropdown-DMUdgZ-P.js";import"./x-C7--vmmO.js";const kt={key:0,class:"fixed inset-0 bg-black/40 backdrop-blur-sm z-60 flex items-end sm:items-center justify-center"},Mt={class:"bg-white w-full sm:max-w-md rounded-t-2xl sm:rounded-2xl shadow-lg overflow-hidden max-h-[95vh]"},$t={class:"flex justify-between items-center px-4 py-3 border-b border-gray-100"},Dt=["disabled"],jt={class:"p-5 border-b border-gray-100"},Vt={class:"font-medium"},Ht={class:"text-xs text-gray-500"},St={class:"font-semibold"},Bt={class:"flex justify-between items-center mt-4 font-semibold"},It={class:"p-5"},Et={class:"grid grid-cols-2 gap-4"},Lt=["disabled"],At={width:"34",height:"28",viewBox:"0 0 34 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Rt=["fill"],Tt=["fill"],Nt=["fill"],Pt=["fill"],Ot=["disabled"],Zt={width:"33",height:"28",viewBox:"0 0 33 28",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ft=["fill"],qt=["disabled"],zt={key:0,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ut={key:1},Jt={key:2},Gt={class:"p-5 border-t"},Wt={class:"font-semibold"},Kt={key:0,class:"fixed inset-0 z-70 flex items-end sm:items-center justify-center bg-black/50"},Yt={class:"bg-white w-full sm:max-w-md max-h-[95vh] rounded-t-2xl sm:rounded-2xl shadow-xl overflow-y-auto"},Qt={class:"flex justify-between items-center px-4 py-3 border-b"},Xt=["disabled"],es={class:"p-5 space-y-5"},ts=["disabled"],ss={class:"sticky bottom-0 pt-5 border-t border-gray-100 bg-white"},os={class:"flex justify-between items-center mb-3 px-1"},as={class:"font-semibold text-gray-900 text-base"},ls=["disabled"],rs={key:0,class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ns={key:1},is={key:2},ds={__name:"BookingPaymentModal",props:{booking:Object,show:Boolean},emits:["close","success"],setup(E,{emit:K}){const w=Ct("pk_test_51SnNCKAeoTwVR6BPo0LCcZlDptfnv7dlIWUWZisaHH2hIgiqodlfD8np3jKymUkDTHJuR0xHHeJn8mvxwEXbzqrP00jg3nHLOf"),M=E,g=K,v=f(null),a=f(!1),_=f(!1),b=f(!1);let m=null,C=null,j=null;const k=f({name:""});Oe(async()=>{m=await w,C=m.elements()}),Ze(a,async O=>{if(!O)return;await bt(),j||(j=C.create("card",{hidePostalCode:!0,style:{base:{fontSize:"16px",color:"#333"}}}));const p=document.getElementById("card-element");p&&!p.children.length&&j.mount("#card-element")});const N=JSON.parse(localStorage.getItem("userData")||"{}").id,P=O=>{_.value||(v.value=O)},ve=()=>{if(!(_.value||!v.value)){if(v.value==="cash")return z();v.value==="card"&&(a.value=!0)}},z=async()=>{if(!_.value){_.value=!0;try{await I.post("/paymentstatus",{customer_id:M.booking.customer_id,booking_id:M.booking.id,status:"completed",message:"payment done",payment_type:"cash"}),q({type:"success",message:"Cash payment completed!"}),g("success"),me()}catch(O){console.error("Cash payment error:",O),q({type:"error",message:"Failed to process cash payment. Please try again."})}finally{_.value=!1}}},U=async()=>{var O,p;if(!(b.value||!k.value.name.trim())){b.value=!0;try{const{paymentMethod:$,error:te}=await m.createPaymentMethod({type:"card",card:j,billing_details:{name:k.value.name}});if(te)throw te;const J=parseFloat(M.booking.total_price),fe=(p=(O=(await I.post("/create_payment_intent",{amount:J,payment_method_id:$.id,provider_id:N})).data)==null?void 0:O.data)==null?void 0:p.payment_intent_id;await I.post("/capture_payment_intent",{payment_intent_id:fe,booking_id:M.booking.id,provider_id:N,booking_type:"normal",tap_to_pay:!1,amount:J}),q({type:"success",message:"Card payment successful!"}),g("success"),me()}catch($){console.error("Card payment error:",$),q({type:"error",message:$.message||"Failed to process card payment. Please try again."})}finally{b.value=!1}}},me=()=>{!_.value&&!b.value&&g("close")};return(O,p)=>E.show?(l(),r("div",kt,[e("div",Mt,[e("div",$t,[p[4]||(p[4]=e("h2",{class:"text-lg font-semibold text-gray-800"},"Booking payment",-1)),e("button",{onClick:me,class:"text-gray-400 hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",disabled:_.value}," ✕ ",8,Dt)]),e("div",jt,[p[6]||(p[6]=e("h3",{class:"font-medium mb-3"},"Order Summary",-1)),(l(!0),r(R,null,T(E.booking.services,($,te)=>(l(),r("div",{key:te,class:"py-3 border-b flex justify-between"},[e("div",null,[e("p",Vt,n($.sub_category_name||$.category_name||"Service"),1),e("p",Ht," ⏱ "+n($.service_duration||"N/A"),1)]),e("p",St,"£"+n($.price),1)]))),128)),e("div",Bt,[p[5]||(p[5]=e("span",null,"Total to pay",-1)),e("span",null,"£"+n(E.booking.total_price),1)])]),e("div",It,[p[10]||(p[10]=e("h3",{class:"font-medium mb-3"},"Payment option",-1)),e("div",Et,[e("button",{onClick:p[0]||(p[0]=$=>P("cash")),disabled:_.value,class:y(["py-4 border rounded-xl flex flex-col items-center disabled:opacity-50 disabled:cursor-not-allowed",v.value==="cash"?"bg-red-500 text-white border-red-500":"border-gray-300 text-gray-800 hover:bg-gray-50"])},[(l(),r("svg",At,[e("path",{d:"M18.09 4.67174C18.0687 4.67174 18.0475 4.66834 18.0273 4.66167L3.93101 0.0101818C3.82612 -0.0244309 3.71303 0.0325426 3.67841 0.137436L2.22749 4.53441C2.20045 4.61637 2.12387 4.67174 2.03756 4.67174H0.2C0.0895432 4.67174 0 4.76128 0 4.87174V23.0233C0 23.1337 0.0895431 23.2233 0.2 23.2233H15.044C15.0653 23.2233 15.0864 23.2267 15.1066 23.2334L29.2029 27.8848C29.3078 27.9195 29.4208 27.8625 29.4555 27.7576L30.9064 23.3606C30.9334 23.2786 31.01 23.2233 31.0963 23.2233H32.9339C33.0443 23.2233 33.1339 23.1337 33.1339 23.0233V4.87174C33.1339 4.76128 33.0443 4.67174 32.9339 4.67174H18.09ZM31.1924 8.24562C31.1924 8.38246 31.058 8.47859 30.9329 8.42305C30.2436 8.11693 29.6887 7.56201 29.3826 6.87271C29.327 6.74764 29.4231 6.61318 29.56 6.61318H30.9924C31.1029 6.61318 31.1924 6.70272 31.1924 6.81318V8.24562ZM27.3104 21.1212C27.2887 21.2141 27.207 21.2818 27.1115 21.2818H6.02233C5.92687 21.2818 5.84514 21.2141 5.82347 21.1212C5.39447 19.2805 3.94274 17.8288 2.10204 17.3998C2.00907 17.3781 1.94144 17.2963 1.94144 17.2009V10.6941C1.94144 10.5986 2.00907 10.5169 2.10204 10.4952C3.94275 10.0662 5.39448 8.61449 5.82347 6.77378C5.84514 6.68081 5.92687 6.61318 6.02233 6.61318H27.1115C27.207 6.61318 27.2887 6.68081 27.3104 6.77378C27.7394 8.61449 29.1911 10.0662 31.0318 10.4952C31.1248 10.5169 31.1924 10.5986 31.1924 10.6941V17.2009C31.1924 17.2964 31.1248 17.3781 31.0318 17.3998C29.1911 17.8288 27.7394 19.2805 27.3104 21.1212ZM10.6806 4.28181C10.8964 4.35302 10.8451 4.67174 10.6179 4.67174H4.50318C4.36692 4.67174 4.27055 4.53846 4.31325 4.40907L4.91369 2.58947C4.9483 2.48458 5.06139 2.4276 5.16628 2.46222L10.6806 4.28181ZM3.57388 6.61318C3.71072 6.61318 3.80685 6.74764 3.75131 6.87271C3.44519 7.562 2.89028 8.11688 2.20098 8.42303C2.07591 8.47858 1.94144 8.38245 1.94144 8.2456V6.81318C1.94144 6.70272 2.03098 6.61318 2.14144 6.61318H3.57388ZM1.94144 19.6493C1.94144 19.5125 2.0759 19.4164 2.20097 19.4719C2.89027 19.778 3.44519 20.3329 3.75131 21.0222C3.80685 21.1473 3.71072 21.2818 3.57388 21.2818H2.14144C2.03098 21.2818 1.94144 21.1922 1.94144 21.0818V19.6493ZM22.4533 23.6131C22.2375 23.5419 22.2887 23.2232 22.516 23.2232H28.6307C28.767 23.2232 28.8633 23.3565 28.8206 23.4859L28.2202 25.3055C28.1856 25.4104 28.0725 25.4674 27.9676 25.4327L22.4533 23.6131ZM29.56 21.2818C29.4231 21.2818 29.327 21.1473 29.3826 21.0222C29.6887 20.3329 30.2436 19.778 30.9329 19.4719C31.058 19.4164 31.1924 19.5125 31.1924 19.6493V21.0818C31.1924 21.1922 31.1029 21.2818 30.9924 21.2818H29.56Z",fill:v.value!=="cash"?"#EC5B70":"#fff"},null,8,Rt),e("path",{d:"M16.5669 8.9429C13.8074 8.9429 11.5624 11.188 11.5624 13.9475C11.5624 16.707 13.8074 18.9521 16.5669 18.9521C19.3264 18.9521 21.5715 16.707 21.5715 13.9475C21.5715 11.188 19.3265 8.9429 16.5669 8.9429ZM16.5669 17.0106C14.8779 17.0106 13.5038 15.6365 13.5038 13.9475C13.5038 12.2585 14.8779 10.8843 16.5669 10.8843C18.256 10.8843 19.6301 12.2584 19.6301 13.9475C19.6301 15.6365 18.256 17.0106 16.5669 17.0106Z",fill:v.value!=="cash"?"#EC5B70":"#fff"},null,8,Tt),e("path",{d:"M5.15562 13.1768C5.15562 13.0663 5.24516 12.9768 5.35562 12.9768H8.40704C8.5175 12.9768 8.60704 13.0663 8.60704 13.1768V14.7182C8.60704 14.8287 8.5175 14.9182 8.40704 14.9182H5.35562C5.24516 14.9182 5.15562 14.8287 5.15562 14.7182V13.1768Z",fill:v.value!=="cash"?"#EC5B70":"#fff"},null,8,Nt),e("path",{d:"M24.6131 13.1768C24.6131 13.0663 24.7026 12.9768 24.8131 12.9768H27.8645C27.975 12.9768 28.0645 13.0663 28.0645 13.1768V14.7182C28.0645 14.8287 27.975 14.9182 27.8645 14.9182H24.8131C24.7026 14.9182 24.6131 14.8287 24.6131 14.7182V13.1768Z",fill:v.value!=="cash"?"#EC5B70":"#fff"},null,8,Pt)])),p[7]||(p[7]=e("span",null,"Cash",-1))],10,Lt),e("button",{onClick:p[1]||(p[1]=$=>P("card")),disabled:_.value,class:y(["py-4 border rounded-xl flex flex-col items-center disabled:opacity-50 disabled:cursor-not-allowed",v.value==="card"?"bg-red-500 text-white border-red-500":"border-gray-300 text-gray-800 hover:bg-gray-50"])},[(l(),r("svg",Zt,[e("path",{d:"M8.90918 0.0996094H28.7637C30.8138 0.099629 32.4814 1.76825 32.4814 3.81836V16.5459C32.4812 18.5958 30.8136 20.2637 28.7637 20.2637H27.3906V24.1816C27.3906 26.2317 25.7229 27.9003 23.6729 27.9004H3.81836C1.76824 27.9004 0.0996094 26.2318 0.0996094 24.1816V11.4541C0.0998499 9.40419 1.76839 7.73633 3.81836 7.73633H23.6729C25.7228 7.7364 27.3904 9.40423 27.3906 11.4541V17.918H28.7637C29.5205 17.9179 30.1365 17.3027 30.1367 16.5459V3.81836C30.1367 3.06136 29.5207 2.44533 28.7637 2.44531H8.90918C8.15217 2.44531 7.53613 3.06135 7.53613 3.81836C7.53604 4.46598 7.01092 4.99121 6.36328 4.99121C5.7158 4.99102 5.19053 4.46586 5.19043 3.81836C5.19043 1.76824 6.85906 0.0996094 8.90918 0.0996094ZM3.81836 10.082C3.0615 10.082 2.44555 10.6973 2.44531 11.4541V24.1816C2.44531 24.9387 3.06135 25.5547 3.81836 25.5547H23.6729C24.4298 25.5546 25.0459 24.9386 25.0459 24.1816V15.1729H6.36328C5.71575 15.1727 5.19043 14.6476 5.19043 14C5.19043 13.3524 5.71575 12.8273 6.36328 12.8271H25.0459V11.4541C25.0457 10.6973 24.4297 10.0821 23.6729 10.082H3.81836ZM16.0361 20.4639H21.127C21.7747 20.4639 22.2998 20.989 22.2998 21.6367C22.2996 22.2843 21.7745 22.8096 21.127 22.8096H16.0361C15.3887 22.8094 14.8635 22.2842 14.8633 21.6367C14.8633 20.9891 15.3885 20.464 16.0361 20.4639Z",fill:v.value!=="card"?"#EC5B70":"#fff",stroke:"white","stroke-width":"0.2"},null,8,Ft)])),p[8]||(p[8]=e("span",null,"Manual card entry",-1))],10,Ot)]),e("button",{onClick:ve,disabled:_.value||!v.value,class:"mt-6 w-full bg-red-500 hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed text-white py-3 rounded-lg font-semibold transition-colors flex items-center justify-center gap-2"},[_.value?(l(),r("svg",zt,[...p[9]||(p[9]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):d("",!0),_.value?(l(),r("span",Jt,"Processing...")):(l(),r("span",Ut,"Continue"))],8,qt)]),e("div",Gt,[e("p",Wt,"Total to Receive £"+n(E.booking.total_price),1)])]),a.value?(l(),r("div",Kt,[e("div",Yt,[e("div",Qt,[p[11]||(p[11]=e("h3",{class:"text-lg font-semibold"},"Manual card entry",-1)),e("button",{onClick:p[2]||(p[2]=$=>a.value=!1),class:"text-gray-400 hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",disabled:b.value}," ✕ ",8,Xt)]),e("div",es,[e("div",null,[p[12]||(p[12]=e("label",{class:"block text-sm font-medium mb-1"},"Card holder full name",-1)),ce(e("input",{"onUpdate:modelValue":p[3]||(p[3]=$=>k.value.name=$),type:"text",disabled:b.value,class:"w-full border border-gray-300 rounded-lg p-3 focus:ring-red-500 focus:border-red-500 disabled:opacity-50 disabled:cursor-not-allowed"},null,8,ts),[[ue,k.value.name]])]),p[15]||(p[15]=ft('<div data-v-b68156c8><label class="block text-sm font-medium mb-1" data-v-b68156c8>Card details</label><div id="card-element" class="border border-gray-300 rounded-lg p-3 disabled:opacity-50" data-v-b68156c8></div><p id="card-errors" class="text-red-600 text-sm mt-1" data-v-b68156c8></p></div><div class="pt-6 border-t border-gray-200" data-v-b68156c8><h4 class="text-base font-semibold mb-2" data-v-b68156c8>How it works</h4><div class="text-sm text-gray-600 space-y-2" data-v-b68156c8><div data-v-b68156c8><span class="font-medium text-gray-800" data-v-b68156c8>Step 1:</span> Ask your client for authorisation to process this payment on their card. </div><div data-v-b68156c8><span class="font-medium text-gray-800" data-v-b68156c8>Step 2:</span> Add your client&#39;s card details for payment. </div><div data-v-b68156c8><span class="font-medium text-gray-800" data-v-b68156c8>Step 3:</span> Tap <span class="font-semibold text-red-500" data-v-b68156c8>Pay Now</span> to complete the transaction securely. </div></div></div>',2)),e("div",ss,[e("div",os,[p[13]||(p[13]=e("span",{class:"text-gray-700 text-sm font-medium"},"To pay",-1)),e("span",as,"£"+n(E.booking.total_price),1)]),e("button",{onClick:U,disabled:b.value||!k.value.name.trim(),class:"w-full bg-red-500 hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed text-white py-3 rounded-lg font-semibold transition-colors flex items-center justify-center gap-2"},[b.value?(l(),r("svg",rs,[...p[14]||(p[14]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):d("",!0),b.value?(l(),r("span",is,"Processing...")):(l(),r("span",ns,"Pay Now"))],8,ls)])])])])):d("",!0)])):d("",!0)}},cs=Pe(ds,[["__scopeId","data-v-b68156c8"]]),us={class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},vs={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},ms={class:"flex justify-between items-center mb-4"},ps={class:"text-lg font-semibold"},gs={class:"space-y-4"},fs={class:"relative"},bs={class:"flex gap-3 mt-6"},_s=["disabled"],ys=["disabled"],hs={key:0},xs={key:1,class:"flex items-center"},ws={__name:"AdditionalServiceModal",props:{booking:{type:Object,required:!0},service:{type:Object,default:null}},emits:["close","save","delete"],setup(E,{emit:K}){const w=E,M=K,g=f(!1),v=f({name:"",price:"",duration:"30"});Ze(()=>w.service,b=>{b?v.value={name:b.additional_service_name||b.sub_category_name||"",price:b.price||"",duration:b.service_duration||"30"}:v.value={name:"",price:"",duration:"30"}},{immediate:!0});const a=async()=>{var b;if(confirm("Are you sure you want to delete this service?")){g.value=!0;try{const C=JSON.parse(localStorage.getItem("userData")||"{}").id,j=parseFloat(w.booking.total_price||0),k=parseFloat(w.service.price||0),H=j-k,N={booking_id:w.booking.id,service_id:w.service.id,total_price:H},P=await I.post("/delete_additional_service",N);P.data&&P.data.success?M("delete",w.service.id,H):q({type:"error",message:((b=P.data)==null?void 0:b.message)||"Failed to delete service"})}catch(m){console.error("Error deleting service:",m),q({type:"error",message:"An error occurred while deleting the service"})}finally{g.value=!1}}},_=async()=>{var b,m;if(!v.value.name.trim()||!v.value.price){q({type:"warning",message:"Please fill in all required fields"});return}g.value=!0;try{const j=JSON.parse(localStorage.getItem("userData")||"{}").id,k=parseFloat(w.booking.total_price||0),H=parseFloat(v.value.price);let N=k;if(w.service){const U=parseFloat(w.service.price||0);N=k-U+H}else N=k+H;const P={provider_id:j,booking_id:w.booking.id,additional_service_name:v.value.name,price:v.value.price,service_duration:`${v.value.duration} min`,total_price:N};w.service&&(P.service_id=w.service.id);const ve=w.service?"/update_additional_service":"/add_additional_service",z=await I.post(ve,P);if(z.data&&z.data.success){const U={id:z.data.data.id||((b=w.service)==null?void 0:b.id),additional_service_name:v.value.name,price:v.value.price,service_duration:`${v.value.duration} min`,total_price:N};M("save",U)}else q({type:"error",message:((m=z.data)==null?void 0:m.message)||`Failed to ${w.service?"update":"add"} service`})}catch(C){console.error("Error saving service:",C),q({type:"error",message:`An error occurred while ${w.service?"updating":"adding"} the service`})}finally{g.value=!1}};return(b,m)=>(l(),r("div",us,[e("div",vs,[e("div",ms,[e("h3",ps,n(E.service?"Edit Service":"Add Additional Service"),1),e("button",{onClick:m[0]||(m[0]=C=>b.$emit("close")),class:"text-gray-500 hover:text-gray-700"}," ✕ ")]),e("div",gs,[e("div",null,[m[5]||(m[5]=e("label",{class:"block text-sm font-medium mb-1"},"Service Name*",-1)),ce(e("input",{"onUpdate:modelValue":m[1]||(m[1]=C=>v.value.name=C),type:"text",class:"w-full border border-gray-300 rounded-lg p-3 focus:ring-red-500 focus:border-red-500",placeholder:"Service name"},null,512),[[ue,v.value.name]])]),e("div",null,[m[7]||(m[7]=e("label",{class:"block text-sm font-medium mb-1"},"Price (£)",-1)),e("div",fs,[m[6]||(m[6]=e("span",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"},"£",-1)),ce(e("input",{"onUpdate:modelValue":m[2]||(m[2]=C=>v.value.price=C),type:"number",step:"0.01",min:"0",class:"w-full border border-gray-300 rounded-lg p-3 pl-8 focus:ring-red-500 focus:border-red-500",placeholder:"0.00"},null,512),[[ue,v.value.price]])])]),e("div",null,[m[8]||(m[8]=e("label",{class:"block text-sm font-medium mb-1"},"Duration (minutes)",-1)),ce(e("input",{"onUpdate:modelValue":m[3]||(m[3]=C=>v.value.duration=C),type:"number",min:"15",step:"15",class:"w-full border border-gray-300 rounded-lg p-3 focus:ring-red-500 focus:border-red-500",placeholder:"30"},null,512),[[ue,v.value.duration]])])]),e("div",bs,[E.service?(l(),r("button",{key:0,onClick:a,disabled:g.value,class:"px-4 border border-red-200 text-red-600 rounded-lg py-3 hover:bg-red-50 disabled:opacity-50",title:"Delete Service"},[...m[9]||(m[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,_s)):d("",!0),e("button",{onClick:m[4]||(m[4]=C=>b.$emit("close")),class:"flex-1 border border-gray-300 rounded-lg py-3"}," Cancel "),e("button",{onClick:_,disabled:!v.value.name.trim()||!v.value.price||g.value,class:"flex-1 bg-red-500 text-white rounded-lg py-3 disabled:bg-red-300 flex items-center justify-center"},[g.value?(l(),r("div",xs,[...m[10]||(m[10]=[e("svg",{class:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):(l(),r("span",hs,n(E.service?"Update":"Add")+" Service",1))],8,ys)])])]))}},Cs={class:"max-w-7xl mx-auto px-6 py-5"},ks={class:"flex items-center justify-between mb-6"},Ms=["disabled"],$s={key:0,class:"flex justify-center items-center py-16"},Ds={key:1,class:"text-center py-16 bg-white rounded-lg"},js={key:2,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Vs={key:0,class:"flex border-b border-gray-200 mb-6"},Hs={key:0,class:"bg-red-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center"},Ss={key:0,class:"bg-red-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center"},Bs={key:1},Is={class:"flex gap-4 mb-6"},Es=["onClick"],Ls={key:0},As={key:0,class:"flex flex-col items-center justify-center py-12 text-center text-gray-500"},Rs=["onClick"],Ts={class:"flex gap-4"},Ns={class:"mb-3 rounded-lg overflow-hidden h-24 w-24 bg-gray-100 flex-shrink-0"},Ps=["src","alt"],Os={key:1,class:"w-full h-full p-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Zs={class:"flex-1"},Fs={class:"font-semibold text-gray-900 mb-1"},qs={class:"text-sm text-gray-600 mb-1"},zs={class:"text-sm text-gray-600 mb-2"},Us={key:0,class:"text-sm text-gray-500"},Js={key:0,class:"text-red-500"},Gs={class:"mt-2"},Ws={key:1},Ks={key:0,class:"flex flex-col items-center justify-center py-12 text-center text-gray-500"},Ys=["onClick"],Qs={class:"flex gap-4"},Xs={class:"mb-3 rounded-lg overflow-hidden h-24 w-24 bg-gray-100 flex-shrink-0"},eo=["src","alt"],to={key:1,class:"w-full h-full p-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},so={class:"flex-1"},oo={class:"font-semibold text-gray-900 mb-1"},ao={class:"text-sm text-gray-600 mb-1"},lo={class:"text-sm text-gray-600 mb-2"},ro={key:0,class:"text-sm text-gray-500"},no={key:0,class:"text-red-500"},io={class:"mt-2"},co={key:2},uo={key:0,class:"flex flex-col items-center justify-center py-12 text-center text-gray-500"},vo=["onClick"],mo={class:"flex gap-4"},po={class:"mb-3 rounded-lg overflow-hidden h-24 w-24 bg-gray-100 flex-shrink-0"},go=["src","alt"],fo={key:1,class:"w-full h-full p-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},bo={class:"flex-1"},_o={class:"font-semibold text-gray-900 mb-1"},yo={class:"text-sm text-gray-600 mb-1"},ho={class:"text-sm text-gray-600 mb-2"},xo={key:0,class:"text-sm text-gray-500"},wo={key:0,class:"text-red-500"},Co={class:"mt-2"},ko={key:2},Mo={class:"flex gap-4 mb-6"},$o=["onClick"],Do={key:0},jo=["onClick"],Vo={class:"flex gap-4"},Ho={class:"flex-1"},So={class:"flex justify-between items-center mb-2"},Bo={class:"font-semibold text-gray-900 mb-1"},Io={class:"font-semibold text-gray-900 mb-2"},Eo={class:"flex gap-20 items-center mb-2 border-b pb-2 border-gray-300"},Lo={class:"flex-1 border-r"},Ao={key:0,class:"font-semibold text-sm text-gray-900 mb-2"},Ro={class:"flex-1"},To={class:"font-semibold text-sm text-gray-900 mb-2"},No={class:"text-gray-600"},Po={key:0,class:"font-medium"},Oo={key:1,class:"font-medium"},Zo={key:2,class:"font-medium"},Fo={class:"mt-2"},qo={key:1},zo=["onClick"],Uo={class:"flex gap-4"},Jo={class:"flex-1"},Go={class:"flex justify-between items-center mb-2"},Wo={class:"font-semibold text-gray-900 mb-1"},Ko={class:"font-semibold text-gray-900 mb-2"},Yo={class:"flex gap-20 items-center mb-2 border-b pb-2 border-gray-300"},Qo={class:"flex-1 border-r"},Xo={key:0,class:"font-semibold text-sm text-gray-900 mb-2"},e1={class:"flex-1"},t1={class:"font-semibold text-sm text-gray-900 mb-2"},s1={class:"text-gray-600"},o1={key:0,class:"font-medium"},a1={key:1,class:"font-medium"},l1={key:2,class:"font-medium"},r1={class:"mt-2"},n1={key:2},i1=["onClick"],d1={class:"flex gap-4"},c1={class:"flex-1"},u1={class:"flex justify-between items-center mb-2"},v1={class:"font-semibold text-gray-900 mb-1"},m1={class:"font-semibold text-gray-900 mb-2"},p1={class:"flex gap-20 items-center mb-2 border-b pb-2 border-gray-300"},g1={class:"flex-1 border-r"},f1={key:0,class:"font-semibold text-sm text-gray-900 mb-2"},b1={class:"flex-1"},_1={class:"font-semibold text-sm text-gray-900 mb-2"},y1={class:"text-gray-600"},h1={key:0,class:"font-medium"},x1={key:1,class:"font-medium"},w1={key:2,class:"font-medium"},C1={class:"mt-2"},k1={key:0,class:"md:hidden border-b border-gray-200 px-4 py-3 mb-4"},M1={class:"bg-white rounded-lg overflow-hidden"},$1={key:0,class:"flex border-b border-gray-200"},D1={key:0,class:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full h-5 w-5 inline-flex items-center justify-center"},j1={key:0,class:"ml-2 bg-red-600 text-white text-xs font-bold rounded-full h-5 w-5 inline-flex items-center justify-center"},V1={key:1,class:"py-2 space-y-6"},H1={class:"bg-black rounded-lg p-8 flex items-center justify-center mb-6"},S1={class:"position-relative"},B1={key:0,class:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4"},I1={class:"flex items-start gap-3"},E1={class:"flex-1"},L1={class:"text-sm text-blue-900 font-medium mb-3"},A1={class:"flex gap-3"},R1=["disabled"],T1=["disabled"],N1={class:"text-start mb-6"},P1={class:"flex items-start gap-8"},O1={class:"text-5xl font-bold text-gray-900 border-r-2 border-black pr-5"},Z1={class:"text-left"},F1={class:"text-sm font-medium text-gray-900"},q1={class:"text-sm text-gray-500"},z1={class:"border-t border-gray-200 pt-4 pb-4"},U1={class:"flex items-center gap-3 mb-3"},J1=["src"],G1={class:"font-medium text-gray-900"},W1={class:"text-sm text-gray-500"},K1={key:0,class:"bg-gray-50 rounded-lg p-4"},Y1={class:"flex items-center justify-between"},Q1={class:"font-semibold text-gray-900 mb-1"},X1={class:"inline-flex items-center gap-2 text-sm"},ea={class:"px-2 py-0.5 bg-yellow-400 text-gray-900 rounded font-medium"},ta={class:"px-2 py-0.5 bg-gray-200 text-gray-700 rounded text-xs font-medium uppercase"},sa={class:"text-sm text-gray-600 mt-1"},oa={class:"space-y-3"},aa={class:"border-t border-gray-200 pt-4"},la={class:"space-y-3 mb-4"},ra=["onClick"],na={class:"flex-1"},ia={class:"font-medium text-gray-900"},da={key:0,class:"ml-2 text-xs bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded"},ca={key:0,class:"flex items-center gap-1 text-sm text-gray-500 mt-1"},ua={class:"font-medium text-gray-900"},va={key:0,class:"mb-4"},ma={class:"space-y-2 mb-3"},pa={class:"flex justify-between text-gray-700"},ga={key:0,class:"flex justify-between text-gray-700"},fa={class:"border-t-2 border-gray-900 pt-3 mb-4"},ba={class:"flex justify-between items-center"},_a={class:"text-2xl font-bold text-gray-900"},ya={key:1,class:"bg-green-50 border border-green-200 rounded-lg p-3 flex items-start gap-2 mb-4"},ha={class:"space-y-2"},xa={key:1,class:"space-y-3 mb-6"},wa={key:0,class:"flex items-center gap-4"},Ca={key:1},ka={class:"w-10 h-10 bg-white bg-opacity-20 rounded flex items-center justify-center flex-shrink-0"},Ma={class:"text-left flex-1"},$a={class:"font-medium"},Da={class:"text-sm opacity-90"},ja={key:2},Va={key:2,class:"py-2 space-y-6"},Ha={class:"text-2xl font-bold text-gray-900 mb-2"},Sa={class:"text-start mb-6"},Ba={class:"text-2xl font-bold text-gray-900 mb-2"},Ia={class:"flex items-start gap-8"},Ea={class:"text-5xl font-bold text-gray-900 border-r-2 border-black pr-5"},La={class:"text-left"},Aa={class:"text-sm font-medium text-gray-900"},Ra={class:"text-sm text-gray-500"},Ta={class:"border-t border-gray-200 pt-4 pb-4"},Na={class:"flex items-center gap-3 mb-3"},Pa=["src"],Oa={class:"font-medium text-gray-900"},Za={class:"text-sm text-gray-500"},Fa={class:"mb-6"},qa={class:"space-y-2 mb-4"},za={class:"flex justify-between items-center text-sm"},Ua={class:"text-gray-600 truncate flex items-center gap-2"},Ja={class:"text-gray-600 text-sm"},Ga={class:"space-y-2 mb-4 border-t py-2 border-gray-300"},Wa={class:"flex justify-between items-center text-sm"},Ka={class:"text-gray-600 truncate flex items-center gap-2"},Ya={class:"text-gray-600 text-sm"},Qa={class:"text-gray-600"},Xa={key:0,class:"font-medium"},el={key:1,class:"font-medium"},tl={key:2,class:"font-medium"},sl={class:"space-y-2 mb-4 border-t py-2 border-gray-300"},ol={class:"flex justify-between items-center text-sm"},al={class:"text-gray-600 truncate flex items-center gap-2"},ll={class:"text-gray-600 text-sm"},rl={class:"font-medium text-gray-900"},nl={class:"flex items-center text-sm text-gray-600 mt-1"},il={class:"bg-yellow-500 text-black px-2 py-1 rounded font-medium"},dl={class:"flex items-center text-xs text-gray-500 mt-2 space-x-4 list-disc"},cl={class:"space-y-6"},ul={key:0,class:"w-[368px] rounded-xl bg-gray-50 shadow-sm p-6 text-center space-y-4 border border-gray-200"},vl={class:"text-4xl font-bold text-gray-900"},ml={class:"flex items-center justify-center gap-2 text-gray-500 text-sm font-medium"},pl={width:"11",height:"14",viewBox:"0 0 11 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},gl=["fill"],fl={class:"text-gray-500 text-sm font-medium bg-white rounded-lg py-4 px-6 my-2"},bl={key:2,class:"w-[368px] rounded-xl p-6 text-center space-y-4 bg-[#DFF6E6]"},_l={class:"text-4xl font-bold text-[#265935]"},yl={class:"max-w-xl text-gray-800 space-y-4"},hl={class:"space-y-3 leading-relaxed text-[15px]"},xl={class:"flex items-center gap-2 mt-3"},wl=["src"],Cl={key:3,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},kl={class:"bg-white rounded-xl shadow-xl w-[414px] p-6 relative"},Ml={class:"space-y-4"},$l=["disabled"],Dl={key:4,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},jl={class:"bg-white rounded-xl shadow-xl w-[414px] p-6 relative max-h-[90vh] overflow-y-auto"},Vl={key:0,class:"flex justify-center py-8"},Hl={key:1,class:"space-y-6"},Sl=["min"],Bl={key:0,class:"mt-1 text-sm text-red-600"},Il={key:0},El={class:"grid grid-cols-3 gap-2"},Ll=["onClick"],Al={key:1,class:"text-center py-4 text-gray-500 text-sm"},Rl=["disabled"],Tl={key:1,class:"bg-gray-50 rounded-lg h-full flex items-center justify-center"},Nl={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Pl={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},Ol={class:"mb-6"},Zl={class:"bg-gray-50 p-4 rounded-lg"},Fl={class:"font-medium text-gray-900"},ql={class:"text-sm text-gray-600"},zl={class:"text-sm text-gray-600"},Ul={class:"space-y-3"},Jl={class:"space-y-3"},Gl=["href"],Wl=["href"],Kl="https://via.placeholder.com/150",Yl={__name:"Bookings",setup(E){const K=f(!1),w=ht(),M=f(!0),g=f([]),v=f([]),a=f(null),_=f("booking"),b=f("jobs"),m=f(!1),C=f(!1),j=f(!1),k=f(!1),H=f(null),N=o=>{H.value=o,k.value=!0},P=()=>{H.value=null,k.value=!0},ve=o=>{if(!a.value)return;if(H.value){const i=a.value.services.findIndex(c=>c.id===o.id);i!==-1&&(a.value.services[i]={...a.value.services[i],...o})}else a.value.services.push(o);a.value.total_price=o.total_price;const t=g.value.findIndex(i=>i.id===a.value.id);t!==-1&&(g.value[t].services=[...a.value.services],g.value[t].total_price=o.total_price),k.value=!1,H.value=null},z=(o,t)=>{if(!a.value)return;a.value.services=a.value.services.filter(c=>c.id!==o),a.value.total_price=t;const i=g.value.findIndex(c=>c.id===a.value.id);i!==-1&&(g.value[i].services=a.value.services,g.value[i].total_price=t),k.value=!1,H.value=null},U=o=>({confirmed:"in_shop",in_shop:"pickup_available",pickup_available:"completed"})[o],me=o=>({confirmed:"Vehicle Arrived",in_shop:"Ready for Pickup",pickup_available:"Complete & Raise Invoice"})[o]||"Update Status",O=o=>({confirmed:"Mark vehicle as in shop",in_shop:"Mark as ready for customer",pickup_available:"Mark as completed and create invoice"})[o]||"",p=o=>({confirmed:"bg-orange-500 hover:bg-orange-600",in_shop:"bg-blue-500 hover:bg-blue-600",pickup_available:"bg-green-500 hover:bg-green-600"})[o]||"bg-gray-500",$=o=>({render(){return B("svg",{width:52,height:36,viewBox:"0 0 52 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[B("rect",{width:51.4286,height:36,rx:4,fill:"white"}),B("path",{d:"M22 24.7143L28.8571 17.8571L22 11",stroke:"#37A0CC","stroke-width":2})])}}),te=()=>{if(!a.value)return;const o=U(a.value.booking_status);o&&De(o)},J=f(!1),ke=de(()=>{if(!a.value)return"";const o=a.value;if(o.booking_reshedule_status==="pending"&&o.request_date){const i=new Date(o.request_date).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"});return`${`${o.customer_first_name||""} ${o.customer_last_name||""}`.trim()} wants to reschedule the date to ${i} at ${o.request_time||""}.`}return""}),fe=async o=>{var t,i;if(!(J.value||!a.value)){J.value=!0;try{const s={provider_id:JSON.parse(localStorage.getItem("userData")||"{}").id,booking_id:a.value.id,action:o?"accepted":"rejected"},u=await I.post("/respondToRescheduleBooking",s);if(u.data&&u.data.success){if(showNotification({type:"success",message:`Reschedule request ${o?"accepted":"declined"}.`}),u.data.data){const x=u.data.data;a.value.booking_time=x.booking_time,a.value.booking_date=x.booking_date,a.value.booking_reshedule_status=x.booking_reshedule_status;const h=g.value.findIndex(S=>S.id===x.id);h!==-1&&(g.value[h].booking_time=x.booking_time,g.value[h].booking_date=x.booking_date,g.value[h].booking_reshedule_status=x.booking_reshedule_status)}}else showNotification({type:"error",message:((i=(t=u.data)==null?void 0:t.errors)==null?void 0:i[0])||"Error processing request."})}catch(c){console.error(c),showNotification({type:"error",message:"Failed to process request."})}finally{J.value=!1}}},Fe=[{label:"Upcoming",value:"upcoming"},{label:"In Progress",value:"in_progress"},{label:"Past",value:"past"}],be=f(!1),Me=f(0),_e=f(!1),qe=async()=>{var o;try{_e.value=!0;const i=JSON.parse(localStorage.getItem("userData")||"{}").id;if(!i||!a.value){alert("Something went wrong — missing provider or booking details.");return}const c={provider_id:i,booking_id:a.value.id,offered_price:Me.value,message:`Offer submitted for booking #${a.value.id}`},s=await I.post("/submitOffer",c);_e.value=!1,s.data&&s.data.success?(alert("Offer submitted successfully!"),be.value=!1,await oe()):alert(((o=s.data)==null?void 0:o.message)||"Failed to submit offer. Please try again.")}catch(t){console.error("Error submitting offer:",t),alert("An unexpected error occurred while submitting the offer.")}},ye=f(!1),L=f(""),Y=f(""),$e=f([]),He=f([]),se=f([]),he=f(!1),xe=f(!1),Q=f(""),ze=async()=>{ye.value=!0,L.value="",Y.value="",se.value=[],Q.value="",$e.value.length===0&&await Ue()},Ue=async()=>{var o;try{he.value=!0;const i=JSON.parse(localStorage.getItem("userData")||"{}").id,c=await I.get(`/get-business-holidays-and-days?provider_id=${i}`);c.data&&c.data.success?($e.value=c.data.data.business_days||[],He.value=c.data.data.business_holidays||[]):console.error("Failed to fetch business hours:",(o=c.data)==null?void 0:o.message)}catch(t){console.error("Error fetching business hours:",t)}finally{he.value=!1}},Je=()=>{if(!L.value)return;const o=new Date(L.value),i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][o.getDay()];if(He.value.some(u=>u.date===L.value)){se.value=[],Q.value="Selected date is a holiday.";return}const s=$e.value.find(u=>u.day===i);s&&(s.is_active||s.is_active==1||s.is_active=="1")?(Q.value="",Ge(s.open_time,s.close_time)):(se.value=[],Q.value="Business is closed on this day.")},Ge=(o,t)=>{const i=[],c=parseInt(o),s=parseInt(t),u=new Date,h=new Date(L.value).toDateString()===u.toDateString(),S=u.getHours();for(let V=c;V<=s;V++){if(h&&V<=S)continue;const F=V<10?`0${V}`:`${V}`;i.push(`${F}:00`)}se.value=i},We=async()=>{var o;try{if(!L.value||!Y.value){alert("Please select date and time.");return}xe.value=!0;const c={provider_id:JSON.parse(localStorage.getItem("userData")||"{}").id,booking_id:a.value.id,new_date:L.value,time:Y.value},s=await I.post("/providerRescheduleRequest",c);s.data&&s.data.success?(alert("Booking scheduled successfully!"),ye.value=!1,a.value&&(a.value.request_date=L.value,a.value.booking_time=Y.value,a.value.request_date_status="sent"),await oe()):alert(((o=s.data)==null?void 0:o.message)||"Failed to schedule booking.")}catch(t){console.error("Error scheduling booking:",t),alert("An error occurred while scheduling.")}finally{xe.value=!1}},Ke=[{label:"New",value:"new"},{label:"Responded",value:"responded"},{label:"Rejected",value:"rejected"}],pe=f("upcoming"),ge=f("new"),Se=()=>{m.value=window.innerWidth<768},G=o=>o?(typeof o=="string"?new Date(o):o).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"short",year:"numeric"}):"",Be=de(()=>{const o=new Date;return o.setHours(0,0,0,0),console.log("Bookings:",g.value),g.value?g.value.filter(t=>t.booking_date?new Date(t.booking_date)>=o&&!["cancelled","completed"].includes(t.booking_status):!["cancelled","completed"].includes(t.booking_status)).sort((t,i)=>{if(!t.booking_date)return 1;if(!i.booking_date)return-1;const c=new Date(t.booking_date),s=new Date(i.booking_date);return c-s}):[]}),Ie=de(()=>g.value?g.value.filter(o=>["in_shop","pickup_available"].includes(o.booking_status)):[]),Ee=de(()=>{const o=new Date;return o.setHours(0,0,0,0),g.value.filter(t=>{if(t.booking_date){const i=new Date(t.booking_date);if(["cancelled","completed","pickup_available","in_shop"].includes(t.booking_status)||i<o&&!["pickup_available","in_shop"].includes(t.booking_status))return!0}return["cancelled","completed"].includes(t.booking_status)}).sort((t,i)=>{if(!t.booking_date)return 1;if(!i.booking_date)return-1;const c=new Date(t.booking_date);return new Date(i.booking_date)-c})}),Ye=o=>{const t=new Date;return t.setHours(0,0,0,0),o.booking_date?new Date(o.booking_date)>=t&&!["cancelled","completed"].includes(o.booking_status):!["cancelled","completed"].includes(o.booking_status)},we=de(()=>g.value.filter(o=>o.booking_status==="pending").length),Ce=de(()=>v.value.filter(o=>o.provider_request_payment_status==="pending"||o.provider_request_payment_status==="accepted").length),Qe=yt(),oe=async()=>{var o,t;M.value=!0;try{const c=JSON.parse(localStorage.getItem("userData")||"{}").id;if(!c){console.error("Provider ID not found");return}const s=await I.post("/getBookingsByProvider",{provider_id:c});(o=s.data)!=null&&o.success?g.value=s.data.data.bookings||[]:g.value=[];const u=await I.post("/getRequestByProvider",{provider_id:c});(t=u.data)!=null&&t.success?v.value=u.data.data||[]:v.value=[];const x=Qe.query.bookingId;if(x){const h=g.value.find(S=>S.id==x);h&&(a.value=h,_.value="booking")}}catch(i){console.error("Error loading bookings/requests:",i)}finally{M.value=!1}},Xe=async()=>{await oe()},et=()=>{a.value=null},ae=(o,t)=>{a.value=o,_.value=t},Le=()=>{b.value="jobs",g.value.length>0&&(!a.value||_.value)},Ae=()=>{b.value="requests",v.value.length>0&&(!a.value||_.value)},De=async o=>{if(a.value)try{const t=await I.post("/updateBookingStatus",{booking_id:a.value.id,status:o});if(t.data&&t.data.success){a.value.booking_status=o;const i=g.value.findIndex(c=>c.id===a.value.id);i!==-1&&(g.value[i].booking_status=o),await oe(),o==="completed"&&Re()}else alert("Failed to update booking status. Please try again.")}catch(t){console.error("Error updating booking status:",t),alert("An error occurred while updating the booking status. Please try again.")}},Re=()=>{j.value=!0},tt=async()=>{j.value=!1,await oe()},X=o=>o.category_name||o.sub_category_name||o.additional_service_name||"Service",le=o=>o?new Date(o).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"short",year:"numeric"}):"",Te=o=>{if(!o)return"";const[t,i]=o.split(":");return`${t}:${i}`},re=(o,t)=>{if(!o)return"";const[i,c]=o.split(":"),s=new Date;s.setHours(parseInt(i),parseInt(c));let u=0;t&&t.length>0&&t.forEach(Z=>{if(Z.service_duration){const D=Z.service_duration.match(/(\d+)/);D&&(u+=parseInt(D[0]))}});const x=new Date(s.getTime()+u*6e4),h=Z=>Z.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1}),S=Math.floor(u/60),V=u%60,F=S>0?`${S}hr ${V}min`:`${V}min`;return`${h(s)} -${h(x)} (${F})`},st=o=>(o.customer_first_name=o.customer_first_name||"",o.customer_first_name),ot=o=>(o.customer_profile_image=o.customer_profile_image||"",o.customer_profile_image||Kl),ne=o=>o?o.charAt(0).toUpperCase()+o.slice(1).replace("_"," "):"Unknown",ie=o=>{switch(o){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-green-100 text-green-800";case"in_shop":case"pickup_available":return"bg-orange-100 text-orange-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},at=o=>{const t={pending:1,confirmed:2,in_shop:3,pickup_available:4,completed:5,cancelled:6,default:5},i=t[o]||t.default;return B("svg",{width:301,height:190,viewBox:"0 0 321 190",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[B("path",{d:"M316.336 160.305C318.697 160.305 320.617 158.391 320.554 156.031C319.546 118.22 305.196 81.9765 280.048 53.724C278.478 51.9605 275.768 51.8789 274.047 53.4951L245.222 80.5634C243.501 82.1796 243.423 84.8802 244.972 86.6615C261.771 105.973 271.463 130.454 272.438 156.031C272.528 158.39 274.433 160.305 276.794 160.305H316.336Z",fill:i>=5?"#34A356":"#393E42"}),B("path",{d:"M270.636 49.9751C272.305 48.3057 272.309 45.5942 270.595 43.9698C243.147 17.9464 207.372 2.46521 169.612 0.2703C167.255 0.133297 165.281 1.99205 165.206 4.3518L163.964 43.8743C163.89 46.234 165.745 48.1986 168.1 48.3626C193.633 50.1397 217.798 60.5968 236.572 77.9932C238.304 79.5979 241.006 79.6049 242.675 77.9355L270.636 49.9751Z",fill:i>=4?"#931F4D":"#393E42"}),B("path",{d:"M160.305 4.27482C160.305 1.9139 158.391 -0.00595053 156.03 0.0569853C125.883 0.860915 96.5713 10.1542 71.468 26.8672C69.5028 28.1755 69.044 30.848 70.4043 32.7776L93.1874 65.0963C94.5477 67.0259 97.2105 67.48 99.1905 66.1942C116.165 55.1712 135.807 48.9436 156.031 48.173C158.391 48.0831 160.305 46.1777 160.305 43.8168V4.27482Z",fill:i>=3?"#FE7E00":"#393E42"}),B("path",{d:"M67.0281 35.2258C65.6167 33.3332 62.9344 32.9386 61.0801 34.4C44.5177 47.4527 30.6928 63.6456 20.3986 82.0499C19.2461 84.1104 20.0564 86.6977 22.1469 87.7948L57.1597 106.171C59.2501 107.268 61.8271 106.458 63.0031 104.411C69.926 92.3593 79.028 81.6982 89.845 72.9712C91.6824 71.4887 92.0782 68.8167 90.6669 66.9241L67.0281 35.2258Z",fill:i>=2?"#37A0CC":"#393E42"}),B("path",{d:"M20.1776 91.6777C18.0573 90.6393 15.4912 91.5141 14.5097 93.6613C5.74282 112.84 0.846062 133.561 0.100287 154.636C0.016792 156.995 1.9199 158.926 4.28072 158.947L43.8212 159.291C46.182 159.312 48.104 157.413 48.2145 155.055C48.8647 141.172 52.0886 127.53 57.7219 114.824C58.6788 112.666 57.8097 110.108 55.6894 109.07L20.1776 91.6777Z",fill:i>=1?"#EC5B70":"#393E42"}),B("path",{d:"M5.2631 142.772C2.91714 142.506 0.794333 144.193 0.591676 146.545C0.36695 149.153 0.206154 151.767 0.109434 154.383C0.0222129 156.742 1.92228 158.676 4.28306 158.7L43.823 159.107C46.1837 159.131 48.1087 157.237 48.2229 154.878C48.2702 153.902 48.3302 152.926 48.403 151.951C48.5788 149.597 46.9006 147.48 44.5546 147.215L5.2631 142.772Z",fill:i>=1?"#EC5B70":"#393E42"})])},lt=(o,t)=>{const c={pending:"Pending",confirmed:"Confirmed",in_shop:"Vehicle In Shop",pickup_available:"Ready for Pickup",completed:"Completed",cancelled:"Cancelled"}[o]||"Unknown";return B("span",{class:"ml-4 text-white text-lg font-medium absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center"},[`${t==="booking"?"Booking":"Request"}`,B("br"),B("span",{class:"font-bold"},c)])},rt=o=>{a.value=o,C.value=!0},nt=()=>{C.value=!1},it=o=>{if(!o.booking_date||!o.booking_time)return"#";const[t,i]=o.booking_time.split(":"),c=new Date(o.booking_date);c.setHours(parseInt(t),parseInt(i));let s=0;o.services&&o.services.length>0&&o.services.forEach(D=>{if(D.service_duration){const W=D.service_duration.match(/(\d+)/);W&&(s+=parseInt(W[0]))}});const u=new Date(c.getTime()+s*6e4),x=D=>D.toISOString().replace(/[-:]/g,"").replace(/\.\d{3}/,"")+"Z",h=x(c),S=x(u),F=`Donderstorm - ${o.services&&o.services.length>0?X(o.services[0])+(o.services.length>1?` (+${o.services.length-1} more)`:""):"Car Service"}`,Z=`Service at ${o.customer_name}`;return`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(F)}&dates=${h}/${S}&details=${encodeURIComponent(Z)}`},dt=o=>{if(!o.booking_date||!o.booking_time)return"#";const[t,i]=o.booking_time.split(":"),c=new Date(o.booking_date);c.setHours(parseInt(t),parseInt(i));let s=0;o.services&&o.services.length>0&&o.services.forEach(D=>{if(D.service_duration){const W=D.service_duration.match(/(\d+)/);W&&(s+=parseInt(W[0]))}});const u=new Date(c.getTime()+s*6e4),x=c.toISOString(),h=u.toISOString(),V=`Donderstorm - ${o.services&&o.services.length>0?X(o.services[0])+(o.services.length>1?` (+${o.services.length-1} more)`:""):"Car Service"}`,F=`Service at ${o.customer_name}`,Z=o.customer_name;return`https://outlook.live.com/calendar/0/deeplink/compose?path=/calendar/action/compose&rru=addevent&startdt=${encodeURIComponent(x)}&enddt=${encodeURIComponent(h)}&subject=${encodeURIComponent(V)}&body=${encodeURIComponent(F)}&location=${encodeURIComponent(Z)}`},ct=o=>{if(!o.booking_date||!o.booking_time)return;const[t,i]=o.booking_time.split(":"),c=new Date(o.booking_date);c.setHours(parseInt(t),parseInt(i));let s=0;o.services&&o.services.length>0&&o.services.forEach(W=>{if(W.service_duration){const Ne=W.service_duration.match(/(\d+)/);Ne&&(s+=parseInt(Ne[0]))}});const u=new Date(c.getTime()+s*6e4),h=`Donderstorm - ${o.services&&o.services.length>0?X(o.services[0])+(o.services.length>1?` (+${o.services.length-1} more)`:""):"Car Service"}`,S=`Service at ${o.customer_name}`,V=o.customer_name,F=["BEGIN:VCALENDAR","VERSION:2.0","PRODID:-//Donderstorm//NONSGML v1.0//EN","BEGIN:VEVENT",`UID:${o.id}@donderstorm.com`,`DTSTAMP:${je(new Date)}`,`DTSTART:${je(c)}`,`DTEND:${je(u)}`,`SUMMARY:${h}`,`DESCRIPTION:${S}`,`LOCATION:${V}`,"END:VEVENT","END:VCALENDAR"].join(`\r
`),Z=new Blob([F],{type:"text/calendar;charset=utf-8"}),D=document.createElement("a");D.href=window.URL.createObjectURL(Z),D.setAttribute("download","booking.ics"),document.body.appendChild(D),D.click(),document.body.removeChild(D)},je=o=>o.toISOString().replace(/[-:]/g,"").replace(/\.\d{3}/,""),ut=()=>{w.push("/provider/dashboard")},vt=o=>{w.push({path:"/provider/messages",query:{bookingId:o.id,customerId:o.customer_id,openChat:"true"}})},mt=o=>{K.value=!0},pt=o=>!o||!o.services?0:o.services.reduce((t,i)=>t+parseFloat(i.price||0),0),gt=async o=>{var t,i,c;try{console.log("Downloading invoice for booking:",{id:o.id,booking_ref:o.booking_ref,provider_id:o.provider_id});const s=await I.post("/download-invoice",{booking_id:o.id,booking_type:"normal"},{responseType:"blob",headers:{Accept:"application/pdf"}});console.log("Response type:",typeof s.data),console.log("Is Blob:",s.data instanceof Blob);let u;s.data instanceof Blob?u=s.data:u=new Blob([s.data],{type:"application/pdf"}),console.log("Blob size:",u.size);const x=window.URL.createObjectURL(u),h=document.createElement("a");h.href=x,h.download=`invoice_${o.booking_ref||o.id}.pdf`,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(x),console.log("Invoice downloaded successfully")}catch(s){console.error("Error downloading invoice:",s),console.error("Error response:",(t=s.response)==null?void 0:t.data);const u=((c=(i=s.response)==null?void 0:i.data)==null?void 0:c.message)||s.message||"Failed to download invoice";alert(`Failed to download invoice: ${u}`)}};return Oe(()=>{Se(),window.addEventListener("resize",Se),oe()}),(o,t)=>(l(),ee(xt,null,{default:_t(()=>{var i,c;return[e("div",Cs,[t[79]||(t[79]=e("div",{class:"text-sm text-gray-500 mb-2"},[e("span",null,"Provider Account"),e("span",{class:"mx-2"},"›"),e("span",null,"Bookings")],-1)),e("div",ks,[t[18]||(t[18]=e("h1",{class:"text-3xl font-bold text-gray-900"},"Bookings",-1)),e("button",{onClick:Xe,disabled:M.value,class:"flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 disabled:opacity-50 transition-colors"},[(l(),r("svg",{class:y(["w-5 h-5",{"animate-spin":M.value}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...t[17]||(t[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),A(" "+n(M.value?"Refreshing...":"Refresh"),1)],8,Ms)]),M.value?(l(),r("div",$s,[...t[19]||(t[19]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500"},null,-1)])])):d("",!0),!M.value&&g.value.length===0&&v.value.length===0?(l(),r("div",Ds,[t[20]||(t[20]=e("div",{class:"flex justify-center mb-6"},[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z",stroke:"#E5E7EB","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),t[21]||(t[21]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"You don't have any bookings yet.",-1)),t[22]||(t[22]=e("p",{class:"text-gray-500 mb-8"},"When customers make bookings, they will appear here.",-1)),e("button",{onClick:ut,class:"px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium"}," Back to Dashboard ")])):d("",!0),!M.value&&(g.value.length>0||v.value.length>0)?(l(),r("div",js,[e("div",{class:y(["lg:col-span-2 space-y-6",{"hidden md:block":a.value&&m.value,block:!a.value||!m.value}])},[m.value?(l(),r("div",Vs,[e("button",{onClick:Le,class:y(["flex-1 px-4 py-3 text-sm font-medium transition-colors flex items-center justify-center gap-2",b.value==="jobs"?"bg-red-400 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},[A(" Jobs ("+n(g.value.length)+") ",1),we.value>0?(l(),r("span",Hs,n(we.value),1)):d("",!0)],2),e("button",{onClick:Ae,class:y(["flex-1 px-4 py-3 text-sm font-medium transition-colors flex items-center justify-center gap-2",b.value==="requests"?"bg-red-400 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},[A(" Requests ("+n(v.value.length)+") ",1),Ce.value>0?(l(),r("span",Ss,n(Ce.value),1)):d("",!0)],2)])):d("",!0),b.value==="jobs"?(l(),r("div",Bs,[e("div",Is,[(l(),r(R,null,T(Fe,s=>e("button",{key:s.value,onClick:u=>pe.value=s.value,class:y(["px-4 py-2 rounded-lg text-sm font-medium transition-all",pe.value===s.value?"bg-red-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},n(s.label),11,Es)),64))]),pe.value==="upcoming"?(l(),r("div",Ls,[t[25]||(t[25]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Upcoming",-1)),Be.value.length===0?(l(),r("div",As,[...t[23]||(t[23]=[e("svg",{class:"w-16 h-16 mb-4 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("p",{class:"text-lg font-medium text-gray-900"},"No upcoming bookings",-1),e("p",{class:"text-sm"},"New bookings will appear here",-1)])])):(l(!0),r(R,{key:1},T(Be.value,s=>(l(),r("div",{key:`booking-${s.id}`,onClick:u=>ae(s,"booking"),class:y(["bg-white rounded-lg p-4 border-2 cursor-pointer transition-all hover:shadow-md mb-4",a.value&&a.value.id===s.id&&_.value==="booking"?"border-red-500":"border-gray-200"])},[e("div",Ts,[e("div",Ns,[s.customer_profile_image?(l(),r("img",{key:0,src:s.customer_profile_image,alt:s.customer_name,class:"w-full h-full object-cover"},null,8,Ps)):(l(),r("svg",Os,[...t[24]||(t[24]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])]))]),e("div",Zs,[e("h3",Fs,n(s.customer_name),1),e("p",qs,n(le(s.booking_date)),1),e("p",zs,n(re(s.booking_time,s.services)),1),s.services&&s.services.length>0?(l(),r("p",Us,[A(n(X(s.services[0]))+" ",1),s.services.length>1?(l(),r("span",Js," (+"+n(s.services.length-1)+" more service) ",1)):d("",!0)])):d("",!0),e("div",Gs,[e("span",{class:y(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",ie(s.booking_status)])},n(ne(s.booking_status)),3)])])])],10,Rs))),128))])):pe.value==="in_progress"?(l(),r("div",Ws,[t[28]||(t[28]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"In Progress",-1)),Ie.value.length===0?(l(),r("div",Ks,[...t[26]||(t[26]=[e("svg",{class:"w-16 h-16 mb-4 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1),e("p",{class:"text-lg font-medium text-gray-900"},"No jobs in progress",-1),e("p",{class:"text-sm"},"Active jobs will appear here",-1)])])):(l(!0),r(R,{key:1},T(Ie.value,s=>(l(),r("div",{key:`booking-${s.id}`,onClick:u=>ae(s,"booking"),class:y(["bg-white rounded-lg p-4 border-2 cursor-pointer transition-all hover:shadow-md mb-4",a.value&&a.value.id===s.id&&_.value==="booking"?"border-red-500":"border-gray-200"])},[e("div",Qs,[e("div",Xs,[s.customer_profile_image?(l(),r("img",{key:0,src:s.customer_profile_image,alt:s.customer_name,class:"w-full h-full object-cover"},null,8,eo)):(l(),r("svg",to,[...t[27]||(t[27]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])]))]),e("div",so,[e("h3",oo,n(s.customer_name),1),e("p",ao,n(le(s.booking_date)),1),e("p",lo,n(re(s.booking_time,s.services)),1),s.services&&s.services.length>0?(l(),r("p",ro,[A(n(X(s.services[0]))+" ",1),s.services.length>1?(l(),r("span",no," (+"+n(s.services.length-1)+" more service) ",1)):d("",!0)])):d("",!0),e("div",io,[e("span",{class:y(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",ie(s.booking_status)])},n(ne(s.booking_status)),3)])])])],10,Ys))),128))])):pe.value==="past"?(l(),r("div",co,[t[31]||(t[31]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Past",-1)),Ee.value.length===0?(l(),r("div",uo,[...t[29]||(t[29]=[e("svg",{class:"w-16 h-16 mb-4 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),e("p",{class:"text-lg font-medium text-gray-900"},"No past bookings",-1),e("p",{class:"text-sm"},"Completed or cancelled bookings will appear here",-1)])])):(l(!0),r(R,{key:1},T(Ee.value,s=>(l(),r("div",{key:`booking-${s.id}`,onClick:u=>ae(s,"booking"),class:y(["bg-white rounded-lg p-4 border-2 cursor-pointer transition-all hover:shadow-md mb-4",a.value&&a.value.id===s.id&&_.value==="booking"?"border-red-500":"border-gray-200"])},[e("div",mo,[e("div",po,[s.customer_profile_image?(l(),r("img",{key:0,src:s.customer_profile_image,alt:s.customer_name,class:"w-full h-full object-cover"},null,8,go)):(l(),r("svg",fo,[...t[30]||(t[30]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])]))]),e("div",bo,[e("h3",_o,n(s.customer_name),1),e("p",yo,n(le(s.booking_date)),1),e("p",ho,n(re(s.booking_time,s.services)),1),s.services&&s.services.length>0?(l(),r("p",xo,[A(n(X(s.services[0]))+" ",1),s.services.length>1?(l(),r("span",wo," (+"+n(s.services.length-1)+" more service) ",1)):d("",!0)])):d("",!0),e("div",Co,[e("span",{class:y(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",ie(s.booking_status)])},n(ne(s.booking_status)),3)])])])],10,vo))),128))])):d("",!0)])):b.value==="requests"?(l(),r("div",ko,[e("div",Mo,[(l(),r(R,null,T(Ke,s=>e("button",{key:s.value,onClick:u=>ge.value=s.value,class:y(["px-4 py-2 rounded-lg text-sm font-medium transition-all",ge.value===s.value?"bg-red-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},n(s.label),11,$o)),64))]),ge.value==="new"?(l(),r("div",Do,[t[34]||(t[34]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"New Requests",-1)),(l(!0),r(R,null,T(v.value.filter(s=>s.provider_request_payment_status==="pending"||s.provider_request_payment_status==="accepted"),s=>(l(),r("div",{key:`req-${s.id}`,onClick:u=>ae(s,"request"),class:y(["bg-white rounded-lg p-4 border-2 cursor-pointer transition-all hover:shadow-md mb-4",a.value&&a.value.id===s.id&&_.value==="request"?"border-red-500":"border-gray-200"])},[e("div",Vo,[e("div",Ho,[e("div",So,[e("h3",Bo,n(s.customer_first_name),1),e("p",Io," £"+n(s.estimated_price),1)]),e("div",Eo,[e("div",Lo,[t[32]||(t[32]=e("p",{class:"text-sm text-gray-900 mb-2"},"Service",-1)),s.services&&s.services.length>0?(l(),r("p",Ao,n(s.services.map(u=>u.sub_category_name).join(s.services.length>1?", ":" and ")),1)):d("",!0)]),e("div",Ro,[t[33]||(t[33]=e("p",{class:"text-sm text-gray-900 mb-2"},"Schedule",-1)),e("p",To,[e("div",No,[s.availability_type==="on_date"?(l(),r("span",Po," On: "+n(G(s.request_date)),1)):s.availability_type==="before_date"?(l(),r("span",Oo," Before: "+n(G(s.request_date)),1)):s.availability_type==="flexible"?(l(),r("span",Zo," Flexible scheduling ")):d("",!0)])])])]),e("div",Fo,[e("span",{class:y(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",ie(s.provider_request_payment_status)])},n(ne(s.provider_request_payment_status)),3)])])])],10,jo))),128))])):ge.value==="responded"?(l(),r("div",qo,[t[37]||(t[37]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Responded Requests",-1)),(l(!0),r(R,null,T(v.value.filter(s=>s.provider_request_payment_status==="offer_sent"),s=>{var u,x;return l(),r("div",{key:`req-${s.id}`,onClick:h=>ae(s,"request"),class:y(["bg-white rounded-lg p-4 border-2 cursor-pointer transition-all hover:shadow-md mb-4",a.value&&((u=a.value)==null?void 0:u.id)===((x=o.req)==null?void 0:x.id)&&_.value==="request"?"border-red-500":"border-gray-200"])},[e("div",Uo,[e("div",Jo,[e("div",Go,[e("h3",Wo,n(s.customer_first_name),1),e("p",Ko," £"+n(s.estimated_price),1)]),e("div",Yo,[e("div",Qo,[t[35]||(t[35]=e("p",{class:"text-sm text-gray-900 mb-2"},"Service",-1)),s.services&&s.services.length>0?(l(),r("p",Xo,n(s.services.map(h=>h.sub_category_name).join(s.services.length>1?", ":" and ")),1)):d("",!0)]),e("div",e1,[t[36]||(t[36]=e("p",{class:"text-sm text-gray-900 mb-2"},"Schedule",-1)),e("p",t1,[e("div",s1,[s.availability_type==="on_date"?(l(),r("span",o1," On: "+n(G(s.request_date)),1)):s.availability_type==="before_date"?(l(),r("span",a1," Before: "+n(G(s.request_date)),1)):s.availability_type==="flexible"?(l(),r("span",l1," Flexible scheduling ")):d("",!0)])])])]),e("div",r1,[e("span",{class:y(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",ie(s.provider_request_payment_status)])},n(ne(s.provider_request_payment_status)),3)])])])],10,zo)}),128))])):ge.value==="rejected"?(l(),r("div",n1,[t[40]||(t[40]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Rejected Requests",-1)),(l(!0),r(R,null,T(v.value.filter(s=>s.provider_request_payment_status==="rejected"),s=>(l(),r("div",{key:`req-${s.id}`,onClick:u=>ae(s,"request"),class:y(["bg-white rounded-lg p-4 border-2 cursor-pointer transition-all hover:shadow-md mb-4",a.value&&a.value.id===s.id&&_.value==="request"?"border-red-500":"border-gray-200"])},[e("div",d1,[e("div",c1,[e("div",u1,[e("h3",v1,n(s.customer_first_name),1),e("p",m1," £"+n(s.estimated_price),1)]),e("div",p1,[e("div",g1,[t[38]||(t[38]=e("p",{class:"text-sm text-gray-900 mb-2"},"Service",-1)),s.services&&s.services.length>0?(l(),r("p",f1,n(s.services.map(u=>u.sub_category_name).join(s.services.length>1?", ":" and ")),1)):d("",!0)]),e("div",b1,[t[39]||(t[39]=e("p",{class:"text-sm text-gray-900 mb-2"},"Schedule",-1)),e("p",_1,[e("div",y1,[s.availability_type==="on_date"?(l(),r("span",h1," On: "+n(G(s.request_date)),1)):s.availability_type==="before_date"?(l(),r("span",x1," Before: "+n(G(s.request_date)),1)):s.availability_type==="flexible"?(l(),r("span",w1," Flexible scheduling ")):d("",!0)])])])]),e("div",C1,[e("span",{class:y(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",ie(s.provider_request_payment_status)])},n(ne(s.provider_request_payment_status)),3)])])])],10,i1))),128))])):d("",!0)])):d("",!0)],2),e("div",{class:y(["lg:col-span-1",{"hidden md:block":!a.value&&m.value,block:a.value||!m.value}])},[a.value&&m.value?(l(),r("div",k1,[e("button",{onClick:et,class:"flex items-center text-sm font-medium text-[#111827]"},[...t[41]||(t[41]=[e("svg",{class:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),A(" Back to bookings ",-1)])])])):d("",!0),e("div",M1,[m.value?d("",!0):(l(),r("div",$1,[e("button",{onClick:Le,class:y(["flex-1 px-6 py-3 text-sm font-medium transition-colors",b.value==="jobs"?"bg-red-400 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},[t[42]||(t[42]=A(" Jobs ",-1)),we.value>0?(l(),r("span",D1,n(we.value),1)):d("",!0)],2),e("button",{onClick:Ae,class:y(["flex-1 px-6 py-3 text-sm font-medium transition-colors",b.value==="requests"?"bg-red-400 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},[t[43]||(t[43]=A(" Requests ",-1)),Ce.value>0?(l(),r("span",j1,n(Ce.value),1)):d("",!0)],2)])),a.value&&_.value==="booking"?(l(),r("div",V1,[e("div",H1,[e("div",S1,[(l(),ee(Ve(at(a.value.booking_status)))),(l(),ee(Ve(lt(a.value.booking_status,_.value))))])]),ke.value?(l(),r("div",B1,[e("div",I1,[t[44]||(t[44]=e("svg",{class:"w-5 h-5 text-blue-500 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("div",E1,[e("p",L1,n(ke.value),1),e("div",A1,[e("button",{onClick:t[0]||(t[0]=s=>fe(!1)),disabled:J.value,class:"px-4 py-2 bg-red-100 text-red-600 text-sm font-medium rounded hover:bg-red-200 transition-colors disabled:opacity-50"}," Decline ",8,R1),e("button",{onClick:t[1]||(t[1]=s=>fe(!0)),disabled:J.value,class:"px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded hover:bg-blue-700 transition-colors disabled:opacity-50"}," Accept ",8,T1)])])])])):d("",!0),e("div",N1,[e("div",P1,[e("div",O1,n(Te(a.value.booking_time)),1),e("div",Z1,[e("div",F1,n(le(a.value.booking_date)),1),e("div",q1,n(re(a.value.booking_time,a.value.services)),1)])])]),e("div",z1,[e("div",U1,[e("img",{src:a.value.customer_profile_image||"/assets/images/placeholder.png",alt:"Customer",class:"w-12 h-12 rounded-full object-cover"},null,8,J1),e("div",null,[e("div",G1,n(a.value.customer_first_name)+" "+n(a.value.customer_last_name),1),e("div",W1,n(_.value==="booking"?"Booking ref":"Request ref")+": "+n(a.value.booking_ref||a.value.id),1)])]),a.value.cardetails?(l(),r("div",K1,[e("div",Y1,[e("div",null,[e("div",Q1,n(a.value.cardetails.car_make),1),e("div",X1,[e("span",ea,n(a.value.cardetails.car_model),1),e("span",ta,n(a.value.cardetails.fuel_type||"Petrol"),1)]),e("div",sa,n(a.value.cardetails.fuel_type||"Petrol")+" • "+n(a.value.cardetails.transmission||"Manual")+" • Registered year "+n(a.value.cardetails.yearOfManufacture),1)]),t[45]||(t[45]=e("img",{src:"/assets/images/car_image.png",alt:"Car",class:"w-20 h-auto"},null,-1))])])):d("",!0)]),e("div",oa,[e("button",{onClick:t[2]||(t[2]=s=>rt(a.value)),class:"w-full flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[...t[46]||(t[46]=[e("div",{class:"w-10 h-10 bg-red-100 rounded flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1),e("div",{class:"text-left flex-1"},[e("div",{class:"font-medium text-gray-900"},"Add to Calendar"),e("div",{class:"text-sm text-gray-500"},"Set yourself a reminder")],-1)])]),e("button",{onClick:t[3]||(t[3]=s=>vt(a.value)),class:"w-full flex items-center gap-3 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[...t[47]||(t[47]=[e("div",{class:"w-10 h-10 bg-red-100 rounded flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1),e("div",{class:"text-left flex-1"},[e("div",{class:"font-medium text-gray-900"},"Chat with Customer"),e("div",{class:"text-sm text-gray-500"},"Share or ask more info about booking")],-1)])])]),e("div",aa,[t[55]||(t[55]=e("h3",{class:"font-semibold text-gray-900 mb-4"},"Order Summary",-1)),e("div",la,[(l(!0),r(R,null,T(a.value.services,(s,u)=>(l(),r("div",{key:u,onClick:x=>N(s),class:"flex justify-between items-start cursor-pointer hover:bg-gray-50 p-2 rounded transition-colors"},[e("div",na,[e("div",ia,[A(n(X(s))+" ",1),s.additional_service_name?(l(),r("span",da,"Additional")):d("",!0)]),s.service_duration?(l(),r("div",ca,[t[48]||(t[48]=e("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),A(" "+n(s.service_duration),1)])):d("",!0)]),e("div",ua,"£"+n(s.price),1)],8,ra))),128))]),["pending","cancelled","completed"].includes(a.value.booking_status)?d("",!0):(l(),r("div",va,[e("button",{onClick:P,class:"flex items-center gap-2 text-red-500 hover:text-red-700 font-medium transition-colors"},[...t[49]||(t[49]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z","clip-rule":"evenodd"})],-1),A(" Add new service ",-1)])])])),e("div",ma,[e("div",pa,[t[50]||(t[50]=e("span",null,"Service Price",-1)),e("span",null,"£"+n(pt(a.value).toFixed(2)),1)]),a.value.has_vat?(l(),r("div",ga,[e("span",null,"VAT ("+n(a.value.vat_percentage)+"%)",1),e("span",null,"£"+n(parseFloat(a.value.vat_amount||0).toFixed(2)),1)])):d("",!0)]),e("div",fa,[e("div",ba,[t[51]||(t[51]=e("span",{class:"font-semibold text-gray-900"},"Total to pay",-1)),e("span",_a,"£"+n(a.value.total_price),1)])]),Ye(a.value)&&_.value==="booking"?(l(),r("div",ya,[...t[52]||(t[52]=[e("svg",{class:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),e("span",{class:"text-sm text-green-800"},"Reschedule up to 1 day before appointment",-1)])])):d("",!0),e("div",ha,[e("button",{onClick:t[4]||(t[4]=s=>mt(a.value)),class:"w-full flex items-center justify-between p-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"},[...t[53]||(t[53]=[e("span",{class:"font-medium text-gray-900"},"Check Status",-1),e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])]),a.value.booking_status!=="pending"&&a.value.booking_status!=="cancelled"?(l(),r("button",{key:0,onClick:t[5]||(t[5]=s=>gt(a.value)),class:"w-full flex items-center justify-between p-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"},[...t[54]||(t[54]=[e("span",{class:"font-medium text-gray-900"},"Download Invoice",-1),e("svg",{class:"w-5 h-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])])):d("",!0)])]),a.value.booking_status!=="cancelled"?(l(),r("div",xa,[a.value.booking_status==="pending"?(l(),r("div",wa,[e("button",{onClick:t[6]||(t[6]=s=>De("confirmed")),class:"w-full p-4 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors font-medium"}," Accept "),e("button",{onClick:t[7]||(t[7]=s=>De("cancelled")),class:"w-full p-4 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors font-medium"}," Decline ")])):U(a.value.booking_status)?(l(),r("div",Ca,[e("button",{onClick:te,class:y(["w-full flex items-center gap-3 p-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",p(a.value.booking_status)])},[e("div",ka,[(l(),ee(Ve($(a.value.booking_status))))]),e("div",Ma,[e("div",$a,n(me(a.value.booking_status)),1),e("div",Da,n(O(a.value.booking_status)),1)]),t[56]||(t[56]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 opacity-75",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1))],2)])):a.value.booking_status==="completed"&&a.value.payment_type===null?(l(),r("div",ja,[e("button",{onClick:Re,class:"w-full flex items-center gap-3 p-3 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors"},[...t[57]||(t[57]=[e("div",{class:"w-10 h-10 bg-white bg-opacity-20 rounded flex items-center justify-center flex-shrink-0"},[e("svg",{width:"52",height:"36",viewBox:"0 0 52 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("rect",{width:"51.4286",height:"36",rx:"4",fill:"white"}),e("path",{d:"M22 24.7143L28.8571 17.8571L22 11",stroke:"#37A0CC","stroke-width":"2"})])],-1),e("div",{class:"text-left flex-1"},[e("div",{class:"font-medium"},"Record Payment"),e("div",{class:"text-sm opacity-90"},"Mark payment as received")],-1)])])])):d("",!0)])):d("",!0)])):d("",!0),a.value&&_.value==="request"?(l(),r("div",Va,[e("h2",Ha,n(a.value.services.map(s=>s.category_name).join(a.value.services.length>1?", ":" and ")),1),e("div",Sa,[e("h2",Ba,n(a.value.customer_name),1),e("div",Ia,[e("div",Ea,n(Te(a.value.booking_time)),1),e("div",La,[e("div",Aa,n(le(a.value.booking_date)),1),e("div",Ra,n(re(a.value.booking_time,a.value.services)),1)])])]),e("div",Ta,[e("div",Na,[e("img",{src:ot(a.value),alt:"Provider",class:"w-12 h-12 rounded-full object-cover"},null,8,Pa),e("div",null,[e("div",Oa,n(st(a.value)),1),e("div",Za,n(_.value==="booking"?"Booking ref":"Request ref")+": "+n(a.value.booking_ref||a.value.id),1)])])]),e("div",Fa,[e("div",qa,[e("div",za,[e("span",Ua,[t[59]||(t[59]=e("div",null,[e("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("circle",{cx:"20",cy:"20",r:"20",fill:"#D9D9D9"}),e("path",{d:"M29.2997 16.9232C27.7851 16.6856 26.72 15.284 26.8893 13.7983C26.9123 13.5971 26.958 13.399 27.0255 13.2081C27.201 12.7039 27.0209 12.1215 26.5875 11.7564C25.6716 10.9659 24.6331 10.3297 23.5128 9.87291C23.2684 9.76991 22.9967 9.75131 22.7406 9.82006C22.4845 9.88881 22.2586 10.041 22.0987 10.2525C21.2121 11.4376 19.5037 11.6454 18.35 10.7203C18.1804 10.5839 18.0285 10.4267 17.898 10.2525C17.7381 10.041 17.5122 9.88881 17.2561 9.82006C17 9.75131 16.7283 9.76991 16.484 9.87291C15.4506 10.2935 14.4864 10.8672 13.6236 11.5746C13.1683 11.9439 12.9795 12.5491 13.1642 13.0702C13.6803 14.4391 12.9833 16.0444 11.5672 16.6301C11.3149 16.7354 11.0487 16.8038 10.7769 16.8334C10.2065 16.9042 9.73339 17.326 9.6179 17.8703C9.35831 19.0213 9.33507 20.2129 9.5496 21.3731C9.64977 21.9352 10.1291 22.3765 10.7169 22.4494C12.232 22.61 13.3587 23.9495 13.2618 25.4401C13.2431 25.7396 13.1731 26.0336 13.0549 26.3094C12.8309 26.8272 13.0048 27.4552 13.4688 27.8368C14.3786 28.6136 15.4069 29.2397 16.5146 29.6913C16.6522 29.7441 16.7975 29.7737 16.9447 29.7791C17.1442 29.783 17.3415 29.7364 17.5181 29.6436C17.6948 29.5508 17.8451 29.4149 17.9551 29.2484C18.191 28.8942 18.5092 28.6025 18.8826 28.3984C19.256 28.1943 19.6733 28.0839 20.0988 28.0766C20.5242 28.0693 20.9451 28.1654 21.3253 28.3566C21.7054 28.5478 22.0335 28.8284 22.2813 29.1743C22.4404 29.4006 22.6736 29.5642 22.9405 29.6369C23.2075 29.7096 23.4914 29.6868 23.7433 29.5725C24.7556 29.1236 25.6973 28.5298 26.5387 27.8099C26.98 27.4374 27.1596 26.8409 26.9704 26.3301C26.4385 24.967 27.1182 23.3555 28.5256 22.7565C28.7635 22.6542 29.0142 22.5846 29.2707 22.5495C29.8345 22.463 30.2919 22.0354 30.3962 21.4944C30.5186 20.929 30.5853 20.3529 30.5953 19.7745C30.5952 19.164 30.5313 18.5552 30.4045 17.9581C30.2986 17.4286 29.8511 17.011 29.2997 16.9232ZM23.5306 19.7745C23.5306 21.7134 21.936 23.305 19.9984 23.3066C18.0607 23.3083 16.4678 21.7134 16.4662 19.7745C16.4645 17.8355 18.0607 16.2435 19.9984 16.2419C21.936 16.2402 23.5289 17.8339 23.5306 19.7745Z",fill:"#182224","fill-opacity":"0.75"})])],-1)),e("div",null,[t[58]||(t[58]=e("p",{class:"text-gray-900 text-xs font-semibold"}," SERVICES ",-1)),e("p",Ja,n(a.value.services.map(s=>s.category_name).join(a.value.services.length>1?", ":" and ")),1)])]),t[60]||(t[60]=e("span",{class:"font-medium"},[e("svg",{width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M2 2L7 7L2 12",stroke:"#182224","stroke-width":"2","stroke-linecap":"square"})])],-1))])]),e("div",Ga,[e("div",Wa,[e("span",Ka,[t[62]||(t[62]=e("div",null,[e("svg",{width:"40",height:"41",viewBox:"0 0 40 41",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("circle",{cx:"20",cy:"20.5",r:"20",fill:"#D9D9D9"}),e("path",{d:"M16.25 10.5C16.9414 10.5 17.5 11.0586 17.5 11.75V13H22.5V11.75C22.5 11.0586 23.0586 10.5 23.75 10.5C24.4414 10.5 25 11.0586 25 11.75V13H26.875C27.9102 13 28.75 13.8398 28.75 14.875V16.75H11.25V14.875C11.25 13.8398 12.0898 13 13.125 13H15V11.75C15 11.0586 15.5586 10.5 16.25 10.5ZM11.25 18H28.75V28.625C28.75 29.6602 27.9102 30.5 26.875 30.5H13.125C12.0898 30.5 11.25 29.6602 11.25 28.625V18ZM13.75 21.125V22.375C13.75 22.7188 14.0312 23 14.375 23H15.625C15.9688 23 16.25 22.7188 16.25 22.375V21.125C16.25 20.7812 15.9688 20.5 15.625 20.5H14.375C14.0312 20.5 13.75 20.7812 13.75 21.125ZM18.75 21.125V22.375C18.75 22.7188 19.0312 23 19.375 23H20.625C20.9688 23 21.25 22.7188 21.25 22.375V21.125C21.25 20.7812 20.9688 20.5 20.625 20.5H19.375C19.0312 20.5 18.75 20.7812 18.75 21.125ZM24.375 20.5C24.0312 20.5 23.75 20.7812 23.75 21.125V22.375C23.75 22.7188 24.0312 23 24.375 23H25.625C25.9688 23 26.25 22.7188 26.25 22.375V21.125C26.25 20.7812 25.9688 20.5 25.625 20.5H24.375ZM13.75 26.125V27.375C13.75 27.7188 14.0312 28 14.375 28H15.625C15.9688 28 16.25 27.7188 16.25 27.375V26.125C16.25 25.7812 15.9688 25.5 15.625 25.5H14.375C14.0312 25.5 13.75 25.7812 13.75 26.125ZM19.375 25.5C19.0312 25.5 18.75 25.7812 18.75 26.125V27.375C18.75 27.7188 19.0312 28 19.375 28H20.625C20.9688 28 21.25 27.7188 21.25 27.375V26.125C21.25 25.7812 20.9688 25.5 20.625 25.5H19.375ZM23.75 26.125V27.375C23.75 27.7188 24.0312 28 24.375 28H25.625C25.9688 28 26.25 27.7188 26.25 27.375V26.125C26.25 25.7812 25.9688 25.5 25.625 25.5H24.375C24.0312 25.5 23.75 25.7812 23.75 26.125Z",fill:"#182224","fill-opacity":"0.75"})])],-1)),e("div",null,[t[61]||(t[61]=e("p",{class:"text-gray-900 text-xs font-semibold"}," TO BE DONE ON ",-1)),e("p",Ya,[e("div",Qa,[a.value.availability_type==="on_date"?(l(),r("span",Xa," On: "+n(G(a.value.request_date)),1)):a.value.availability_type==="before_date"?(l(),r("span",el," Before: "+n(G(a.value.request_date)),1)):a.value.availability_type==="flexible"?(l(),r("span",tl," Flexible scheduling ")):d("",!0)])])])]),t[63]||(t[63]=e("span",{class:"font-medium"},[e("svg",{width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M2 2L7 7L2 12",stroke:"#182224","stroke-width":"2","stroke-linecap":"square"})])],-1))])]),e("div",sl,[e("div",ol,[e("span",al,[t[65]||(t[65]=e("div",null,[e("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("circle",{cx:"20",cy:"20",r:"20",fill:"#D9D9D9"}),e("path",{d:"M20 10C14.4938 10 10 14.4941 10 20C10 25.5063 14.4941 30 20 30C25.5063 30 30 25.5059 30 20C30 14.4938 25.5059 10 20 10ZM20 12.3828C23.8017 12.3828 26.9617 15.1823 27.527 18.8281H25.495C24.2067 18.8281 22.9826 18.3111 22.1367 17.4097C20.9805 16.1775 19.0196 16.1771 17.8633 17.4097C17.0174 18.3111 15.7933 18.8281 14.5049 18.8281H12.473C13.0383 15.1823 16.1983 12.3828 20 12.3828ZM20 22.3438C19.0308 22.3438 18.2422 21.5552 18.2422 20.5859C18.2422 19.6166 19.0308 18.8281 20 18.8281C20.9693 18.8281 21.7578 19.6166 21.7578 20.5859C21.7578 21.5552 20.9693 22.3438 20 22.3438ZM12.907 22.7772C13.5777 22.5141 14.062 22.3438 14.7266 22.3438C16.8628 22.3438 18.5242 24.2474 18.2024 26.3863H18.201C18.1532 26.7137 18.0591 27.0309 17.9235 27.3295C15.6282 26.6783 13.7707 24.9755 12.907 22.7772ZM22.077 27.3293C21.9376 27.0229 21.8456 26.7057 21.799 26.3863H21.7976C21.4227 23.8939 23.7234 21.8374 26.1083 22.4435C26.3597 22.5074 26.6743 22.613 27.0929 22.7773C26.2293 24.9754 24.372 26.6781 22.077 27.3293Z",fill:"#182224","fill-opacity":"0.75"})])],-1)),e("div",null,[t[64]||(t[64]=e("p",{class:"text-gray-900 text-xs font-semibold"}," VEHICLE INFO ",-1)),e("p",ll,[e("h3",rl,n(((i=a.value.cardetails)==null?void 0:i.car_make)||"Unknown"),1),e("div",nl,[e("span",il,n(a.value.cardetails.car_model||"No Registration"),1)]),e("ul",dl,[e("li",null,n(a.value.cardetails.fuelType||"N/A"),1),e("li",null,n(a.value.cardetails.transmission||"N/A"),1),e("li",null,n(a.value.cardetails.yearOfManufacture||"N/A"),1)])])])]),t[66]||(t[66]=e("span",{class:"font-medium"},[e("img",{src:"/assets/images/car_image.png",class:"h-16 w-24",alt:"",srcset:""})],-1))])])]),e("div",cl,[a.value.provider_request_payment_status=="pending"?(l(),r("div",ul,[t[68]||(t[68]=e("div",{class:"flex items-center justify-center gap-2 text-gray-500 text-sm font-medium"},[e("svg",{width:"11",height:"14",viewBox:"0 0 11 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.2083 5.25H9.33332V4.08332C9.33332 1.83176 7.50159 0 5.25 0C2.99841 0 1.16668 1.83176 1.16668 4.08332V5.25H0.291676C0.130457 5.25 0 5.38046 0 5.54168V12.8334C0 13.4768 0.523223 14 1.16668 14H9.33335C9.97678 14 10.5 13.4768 10.5 12.8333V5.54168C10.5 5.38046 10.3695 5.25 10.2083 5.25ZM6.1233 11.3428C6.13241 11.4251 6.10594 11.5077 6.05068 11.5696C5.99542 11.6313 5.91623 11.6667 5.83335 11.6667H4.66668C4.5838 11.6667 4.50461 11.6313 4.44935 11.5696C4.39409 11.5078 4.36759 11.4251 4.37672 11.3428L4.56072 9.68825C4.26193 9.47092 4.08335 9.12712 4.08335 8.75C4.08335 8.10657 4.60657 7.58332 5.25003 7.58332C5.89348 7.58332 6.4167 8.10655 6.4167 8.75C6.4167 9.12712 6.23812 9.47092 5.93934 9.68825L6.1233 11.3428ZM7.58332 5.25H2.91668V4.08332C2.91668 2.79675 3.96342 1.75 5.25 1.75C6.53658 1.75 7.58332 2.79675 7.58332 4.08332V5.25Z",fill:"#182224","fill-opacity":"0.75"})]),e("span",null,"TASK PRICE (ESTIMATED)")],-1)),e("div",vl," £"+n(a.value.estimated_price),1),e("button",{class:"w-full bg-[#F25E69] hover:bg-[#e3525e] text-white font-medium py-3 rounded-lg flex items-center justify-center gap-2 transition-colors",onClick:t[8]||(t[8]=s=>be.value=!0)},[...t[67]||(t[67]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1),e("span",null,"Make an Offer",-1)])])])):d("",!0),a.value.provider_request_payment_status=="offer_sent"||a.value.provider_request_payment_status=="rejected"?(l(),r("div",{key:1,class:y(["w-[368px] rounded-xl p-6 text-center space-y-4",a.value.provider_request_payment_status=="offer_sent"?"bg-[#DFEDF3]":"bg-[#E450241A]"])},[e("div",ml,[(l(),r("svg",pl,[e("path",{d:"M10.2083 5.25H9.33332V4.08332C9.33332 1.83176 7.50159 0 5.25 0C2.99841 0 1.16668 1.83176 1.16668 4.08332V5.25H0.291676C0.130457 5.25 0 5.38046 0 5.54168V12.8334C0 13.4768 0.523223 14 1.16668 14H9.33335C9.97678 14 10.5 13.4768 10.5 12.8333V5.54168C10.5 5.38046 10.3695 5.25 10.2083 5.25ZM6.1233 11.3428C6.13241 11.4251 6.10594 11.5077 6.05068 11.5696C5.99542 11.6313 5.91623 11.6667 5.83335 11.6667H4.66668C4.5838 11.6667 4.50461 11.6313 4.44935 11.5696C4.39409 11.5078 4.36759 11.4251 4.37672 11.3428L4.56072 9.68825C4.26193 9.47092 4.08335 9.12712 4.08335 8.75C4.08335 8.10657 4.60657 7.58332 5.25003 7.58332C5.89348 7.58332 6.4167 8.10655 6.4167 8.75C6.4167 9.12712 6.23812 9.47092 5.93934 9.68825L6.1233 11.3428ZM7.58332 5.25H2.91668V4.08332C2.91668 2.79675 3.96342 1.75 5.25 1.75C6.53658 1.75 7.58332 2.79675 7.58332 4.08332V5.25Z",fill:a.value.provider_request_payment_status=="offer_sent"?"#207294BF":"#CA4016","fill-opacity":"0.75"},null,8,gl)])),e("span",{class:y(a.value.provider_request_payment_status=="offer_sent"?"text-[#207294BF]":"text-[#CA4016]")},"OFFERED PRICE "+n(a.value.provider_request_payment_status=="offer_sent"?"":"REJECTED"),3)]),e("div",{class:y(["text-4xl font-bold",a.value.provider_request_payment_status=="offer_sent"?"text-[#207294BF]":"text-[#CA4016]"])}," £"+n(a.value.provider_price),3),e("div",fl,n(a.value.provider_request_payment_status=="offer_sent"?"Waiting for Acceptance":"Offer rejected"),1)],2)):d("",!0),a.value.provider_request_payment_status=="accepted"?(l(),r("div",bl,[t[70]||(t[70]=e("div",{class:"flex items-center justify-center gap-2 text-gray-500 text-sm font-medium"},[e("svg",{width:"11",height:"14",viewBox:"0 0 11 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.2083 5.25H9.33332V4.08332C9.33332 1.83176 7.50159 0 5.25 0C2.99841 0 1.16668 1.83176 1.16668 4.08332V5.25H0.291676C0.130457 5.25 0 5.38046 0 5.54168V12.8334C0 13.4768 0.523223 14 1.16668 14H9.33335C9.97678 14 10.5 13.4768 10.5 12.8333V5.54168C10.5 5.38046 10.3695 5.25 10.2083 5.25ZM6.1233 11.3428C6.13241 11.4251 6.10594 11.5077 6.05068 11.5696C5.99542 11.6313 5.91623 11.6667 5.83335 11.6667H4.66668C4.5838 11.6667 4.50461 11.6313 4.44935 11.5696C4.39409 11.5078 4.36759 11.4251 4.37672 11.3428L4.56072 9.68825C4.26193 9.47092 4.08335 9.12712 4.08335 8.75C4.08335 8.10657 4.60657 7.58332 5.25003 7.58332C5.89348 7.58332 6.4167 8.10655 6.4167 8.75C6.4167 9.12712 6.23812 9.47092 5.93934 9.68825L6.1233 11.3428ZM7.58332 5.25H2.91668V4.08332C2.91668 2.79675 3.96342 1.75 5.25 1.75C6.53658 1.75 7.58332 2.79675 7.58332 4.08332V5.25Z",fill:"#265935","fill-opacity":"0.75"})]),e("span",{class:"text-[#265935]"},"OFFERED PRICE ACCEPTED ")],-1)),e("div",_l," £"+n(a.value.provider_price),1),e("button",{class:"w-full bg-[#265935] hover:bg-[#e3525e] text-white font-medium py-3 rounded-lg flex items-center justify-center gap-2 transition-colors",onClick:ze},[...t[69]||(t[69]=[e("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12.2451 10.5381C13.1262 10.0317 14.1496 9.82922 15.1572 9.96191C16.133 10.0905 17.0407 10.5271 17.751 11.2061L18.4863 10.4062L18.5293 10.3799C18.5456 10.3754 18.5633 10.3757 18.5801 10.3809C18.6135 10.3911 18.6383 10.4196 18.6436 10.4541L19.1816 13.9639C19.1859 13.9929 19.1755 14.0226 19.1543 14.043C19.133 14.0633 19.1031 14.072 19.0742 14.0664L15.8271 13.4414C15.7949 13.4352 15.7682 13.4121 15.7578 13.3809C15.7476 13.3497 15.7552 13.3152 15.7773 13.291L16.8076 12.1611C16.5202 11.8758 16.1814 11.6468 15.8086 11.4873C15.4593 11.3379 15.0866 11.2516 14.708 11.2324L14.5459 11.2285C13.6659 11.2285 12.8215 11.5779 12.1992 12.2002C11.5771 12.8224 11.2275 13.6669 11.2275 14.5469C11.2276 15.4266 11.5772 16.2704 12.1992 16.8926C12.8215 17.5148 13.6659 17.8643 14.5459 17.8643C15.2139 17.8669 15.8675 17.6671 16.4189 17.29C16.9703 16.9131 17.3939 16.3772 17.6338 15.7539L17.6475 15.7295C17.6644 15.7082 17.6906 15.6953 17.7188 15.6953H18.9209C18.9493 15.6953 18.976 15.7088 18.9932 15.7314C19.0103 15.754 19.0163 15.7833 19.0088 15.8105C18.7325 16.7886 18.1415 17.6485 17.3281 18.2578C16.5148 18.8671 15.524 19.1924 14.5078 19.1826C13.4916 19.1728 12.5065 18.829 11.7051 18.2041C10.9036 17.5792 10.3296 16.7078 10.0723 15.7246C9.81501 14.7415 9.88873 13.701 10.2812 12.7637C10.6738 11.8263 11.364 11.0445 12.2451 10.5381Z",fill:"white",stroke:"white","stroke-width":"0.181818","stroke-linejoin":"round"}),e("path",{d:"M17.2728 4.54572C17.2728 4.30813 17.2263 4.07533 17.1383 3.85949M17.2728 4.54572L17.1383 3.85949M17.2728 4.54572V7.9995M10.0001 19.0912H2.72736C2.24515 19.0912 1.78269 18.8996 1.44171 18.5586C1.10074 18.2177 0.90918 17.7552 0.90918 17.273V4.54572C0.90918 4.06351 1.10074 3.60105 1.44171 3.26007C1.78269 2.9191 2.24515 2.72754 2.72736 2.72754H15.4546C15.9368 2.72754 16.3993 2.9191 16.7403 3.26007C16.9133 3.43304 17.0478 3.63728 17.1383 3.85949",stroke:"white","stroke-width":"1.36364","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12.7275 0.90918V4.54554",stroke:"white","stroke-width":"1.36364","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M5.4541 0.90918V4.54554",stroke:"white","stroke-width":"1.36364","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M0.90918 8.18164H17.2728",stroke:"white","stroke-width":"1.36364","stroke-linecap":"round","stroke-linejoin":"round"})],-1),e("span",null,"Schedule Booking",-1)])])])):d("",!0),e("div",yl,[t[71]||(t[71]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Details",-1)),e("div",hl,[e("p",null,n(a.value.note||"No additional details provided."),1)]),e("div",xl,[(l(!0),r(R,null,T(a.value.vehicle_img,(s,u)=>(l(),r("img",{key:u,src:s,alt:"Car",class:"w-20 h-20 object-cover rounded-lg border border-gray-200 shadow-sm"},null,8,wl))),128))])]),be.value?(l(),r("div",Cl,[e("div",kl,[e("button",{class:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",onClick:t[9]||(t[9]=s=>be.value=!1)}," ✕ "),t[73]||(t[73]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-5"},"Make an Offer",-1)),e("div",Ml,[e("div",null,[t[72]||(t[72]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Offer Amount (£)",-1)),ce(e("input",{type:"number","onUpdate:modelValue":t[10]||(t[10]=s=>Me.value=s),class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-[#265935] focus:border-[#265935] outline-none",placeholder:"0.00"},null,512),[[ue,Me.value]])]),e("button",{onClick:qe,disabled:_e.value,class:"w-full bg-[#265935] hover:bg-[#1e462a] text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50"},n(_e.value?"Submitting...":"Submit Offer"),9,$l)])])])):d("",!0),ye.value?(l(),r("div",Dl,[e("div",jl,[e("button",{class:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",onClick:t[11]||(t[11]=s=>ye.value=!1)}," ✕ "),t[77]||(t[77]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-5"},"Schedule Booking",-1)),he.value?(l(),r("div",Vl,[...t[74]||(t[74]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#265935]"},null,-1)])])):(l(),r("div",Hl,[e("div",null,[t[75]||(t[75]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Select Date",-1)),ce(e("input",{type:"date","onUpdate:modelValue":t[12]||(t[12]=s=>L.value=s),min:new Date().toISOString().split("T")[0],onChange:Je,class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-[#265935] focus:border-[#265935] outline-none"},null,40,Sl),[[ue,L.value]]),Q.value?(l(),r("p",Bl,n(Q.value),1)):d("",!0)]),se.value.length>0?(l(),r("div",Il,[t[76]||(t[76]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Select Time",-1)),e("div",El,[(l(!0),r(R,null,T(se.value,s=>(l(),r("button",{key:s,onClick:u=>Y.value=s,class:y(["px-2 py-2 text-sm rounded-lg border transition-colors",Y.value===s?"bg-[#265935] text-white border-[#265935]":"border-gray-200 hover:border-[#265935] text-gray-700"])},n(s),11,Ll))),128))])])):L.value&&!Q.value&&!he.value?(l(),r("div",Al," No available slots for this date. ")):d("",!0),e("button",{onClick:We,disabled:xe.value||!L.value||!Y.value,class:"w-full bg-[#265935] hover:bg-[#1e462a] text-white font-medium py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},n(xe.value?"Scheduling...":"Confirm Schedule"),9,Rl)]))])])):d("",!0)])])):d("",!0)]),a.value?d("",!0):(l(),r("div",Tl,[...t[78]||(t[78]=[e("div",{class:"text-center"},[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No booking selected"),e("p",{class:"mt-1 text-sm text-gray-500"},"Select a booking to view details")],-1)])]))],2)])):d("",!0)]),C.value?(l(),r("div",Nl,[e("div",Pl,[e("div",{class:"flex justify-between items-center mb-4"},[t[81]||(t[81]=e("h3",{class:"text-xl font-bold text-gray-900"},"Add to Calendar",-1)),e("button",{onClick:nt,class:"text-gray-500 hover:text-gray-700"},[...t[80]||(t[80]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Ol,[t[82]||(t[82]=e("p",{class:"text-gray-600 mb-2"},"Event Details",-1)),e("div",Zl,[e("p",Fl,n(a.value.customer_name),1),e("p",ql,n(le(a.value.booking_date)),1),e("p",zl,n(re(a.value.booking_time,a.value.services)),1)])]),e("div",Ul,[e("div",Jl,[e("a",{href:it(a.value),target:"_blank",class:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[...t[83]||(t[83]=[e("div",{class:"w-10 h-10 bg-blue-100 rounded flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-blue-500",viewBox:"0 0 24 24"},[e("path",{fill:"#4285F4",d:"M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z"})])],-1),e("div",{class:"text-left flex-1"},[e("div",{class:"font-medium text-gray-900"},"Google Calendar"),e("div",{class:"text-sm text-gray-500"},"Add to your Google Calendar")],-1)])],8,Gl),e("a",{href:dt(a.value),target:"_blank",class:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[...t[84]||(t[84]=[e("div",{class:"w-10 h-10 bg-blue-50 rounded flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-[#0078D4]",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M11.5 15H17.5V13H11.5V15ZM11.5 10.5H17.5V8.5H11.5V10.5ZM11.5 5.5H17.5V3.5H11.5V5.5ZM9.5 3.5H3.5V15H9.5V3.5ZM9.5 0.5H1.5C0.95 0.5 0.5 0.95 0.5 1.5V17.5C0.5 18.05 0.95 18.5 1.5 18.5H9.5V23.5L19.5 20.5V18.5H22.5C23.05 18.5 23.5 18.05 23.5 17.5V1.5C23.5 0.95 23.05 0.5 22.5 0.5H9.5ZM21.5 16.5H11.5V2.5H21.5V16.5Z",fill:"currentColor"})])],-1),e("div",{class:"text-left flex-1"},[e("div",{class:"font-medium text-gray-900"},"Outlook Calendar"),e("div",{class:"text-sm text-gray-500"},"Add to your Outlook Calendar")],-1)])],8,Wl),e("button",{onClick:t[13]||(t[13]=s=>ct(a.value)),class:"w-full flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[...t[85]||(t[85]=[e("div",{class:"w-10 h-10 bg-gray-100 rounded flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-black",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M16 2V4M8 2V4M3 10H21M5 4H19C20.1046 4 21 4.89543 21 6V20C21 21.1046 20.1046 22 19 22H5C3.89543 22 3 21.1046 3 20V6C3 4.89543 3.89543 4 5 4Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1),e("div",{class:"text-left flex-1"},[e("div",{class:"font-medium text-gray-900"},"iOS / Apple Calendar"),e("div",{class:"text-sm text-gray-500"},"Add to Apple Calendar")],-1)])])])])])])):d("",!0),j.value?(l(),ee(cs,{key:1,show:j.value,booking:a.value,onClose:t[14]||(t[14]=s=>j.value=!1),onSuccess:tt},null,8,["show","booking"])):d("",!0),K.value?(l(),ee(wt,{key:2,"booking-id":(c=a.value)==null?void 0:c.id,onClose:t[15]||(t[15]=s=>K.value=!1),type:"provider"},null,8,["booking-id"])):d("",!0),k.value?(l(),ee(ws,{key:3,booking:a.value,service:H.value,onClose:t[16]||(t[16]=s=>k.value=!1),onSave:ve,onDelete:z},null,8,["booking","service"])):d("",!0)]}),_:1}))}},ar=Pe(Yl,[["__scopeId","data-v-2cdafc49"]]);export{ar as default};
