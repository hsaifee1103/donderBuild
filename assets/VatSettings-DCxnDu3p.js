import{l as _,c as w,o as p,w as S,m as T,W as v,a as e,f as c,g as h,q as f,i as u,U as m,n as y,v as b,t as o}from"./app-CTtqvBQy.js";import{S as x}from"./SetupLayout-oCnZY9_I.js";import"./BackIcon-CByhw0Ua.js";import"./IconDocument-DbfsIkoI.js";const A={name:"VatSettings",components:{SetupLayout:x},data(){return{settings:{has_vat:!1,vat_percentage:null},originalSettings:{},isValid:!0,loading:!1}},mounted(){this.loadSettings()},methods:{async loadSettings(){var i;try{this.loading=!0;const t=await v.get("/api/provider/vat-settings");t.data.success&&(this.settings={has_vat:t.data.data.has_vat||!1,vat_percentage:t.data.data.vat_percentage||null},this.originalSettings={...this.settings})}catch(t){console.error("Failed to load VAT settings:",t),(i=this.$toast)==null||i.error("Failed to load VAT settings")}finally{this.loading=!1}},async saveSettings(){var i,t,g,d,s,n,r,a;if(this.validateSettings())try{this.loading=!0;const l=await v.post("/api/provider/vat-settings",{has_vat:this.settings.has_vat,vat_percentage:this.settings.has_vat?this.settings.vat_percentage:null});l.data.success?((i=this.$toast)==null||i.success("VAT settings updated successfully"),this.originalSettings={...this.settings}):(t=this.$toast)==null||t.error(l.data.message||"Failed to update settings")}catch(l){console.error("Failed to update VAT settings:",l);const V=((s=(d=(g=l.response)==null?void 0:g.data)==null?void 0:d.error)==null?void 0:s[0])||((r=(n=l.response)==null?void 0:n.data)==null?void 0:r.message)||"Failed to update settings";(a=this.$toast)==null||a.error(V)}finally{this.loading=!1}},handleVatToggle(){this.settings.has_vat||(this.settings.vat_percentage=null),this.validateSettings()},validatePercentage(){this.settings.vat_percentage!==null&&(this.settings.vat_percentage<0?this.settings.vat_percentage=0:this.settings.vat_percentage>100&&(this.settings.vat_percentage=100)),this.validateSettings()},validateSettings(){var i;return this.settings.has_vat?(this.isValid=this.settings.vat_percentage!==null&&this.settings.vat_percentage>0&&this.settings.vat_percentage<=100,!this.isValid&&this.settings.vat_percentage!==null&&((i=this.$toast)==null||i.warning("VAT percentage must be between 0 and 100"))):this.isValid=!0,this.isValid},calculateVat(i){return this.settings.vat_percentage?(i*(this.settings.vat_percentage/100)).toFixed(2):"0.00"},calculateTotal(i){const t=parseFloat(this.calculateVat(i));return(i+t).toFixed(2)}}},C={class:"business-content"},F={class:"form-container"},k={class:"form-group"},P={class:"radio-group"},B={key:0,class:"form-group"},N={key:1,class:"pricing-preview-box"},U={class:"preview-content"},I={class:"preview-row vat-row"},L={class:"preview-row total-row"},M=["disabled"];function q(i,t,g,d,s,n){const r=T("SetupLayout");return p(),w(r,null,{default:S(()=>[e("div",C,[t[18]||(t[18]=e("h2",{class:"page-title"},"VAT Settings",-1)),t[19]||(t[19]=e("p",{class:"page-description"}," Configure your VAT/tax settings. This will be applied to all your services when customers book. ",-1)),e("div",F,[e("div",k,[t[11]||(t[11]=e("label",{class:"form-label"},"Is your business VAT registered?",-1)),e("div",P,[e("label",{class:f(["radio-option",{active:s.settings.has_vat}])},[u(e("input",{type:"radio",value:!0,"onUpdate:modelValue":t[0]||(t[0]=a=>s.settings.has_vat=a),onChange:t[1]||(t[1]=(...a)=>n.handleVatToggle&&n.handleVatToggle(...a))},null,544),[[m,s.settings.has_vat]]),t[7]||(t[7]=e("span",{class:"radio-circle"},null,-1)),t[8]||(t[8]=e("span",null,"Yes",-1))],2),e("label",{class:f(["radio-option",{active:!s.settings.has_vat}])},[u(e("input",{type:"radio",value:!1,"onUpdate:modelValue":t[2]||(t[2]=a=>s.settings.has_vat=a),onChange:t[3]||(t[3]=(...a)=>n.handleVatToggle&&n.handleVatToggle(...a))},null,544),[[m,s.settings.has_vat]]),t[9]||(t[9]=e("span",{class:"radio-circle"},null,-1)),t[10]||(t[10]=e("span",null,"No",-1))],2)])]),s.settings.has_vat?(p(),c("div",B,[t[12]||(t[12]=e("label",{class:"form-label"},[y(" VAT Percentage "),e("span",{class:"required"},"*")],-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>s.settings.vat_percentage=a),type:"number",min:"0",max:"100",step:"0.01",placeholder:"e.g., 20",class:"form-input",onInput:t[5]||(t[5]=(...a)=>n.validatePercentage&&n.validatePercentage(...a))},null,544),[[b,s.settings.vat_percentage,void 0,{number:!0}]]),t[13]||(t[13]=e("p",{class:"field-hint"},"Enter your VAT rate as a percentage (e.g., 20 for 20%)",-1))])):h("",!0),s.settings.has_vat&&s.settings.vat_percentage?(p(),c("div",N,[t[16]||(t[16]=e("h4",{class:"preview-title"},"Pricing Preview",-1)),t[17]||(t[17]=e("p",{class:"preview-subtitle"},"How pricing will appear to customers:",-1)),e("div",U,[t[15]||(t[15]=e("div",{class:"preview-row"},[e("span",null,"Service Price:"),e("span",null,"£100.00")],-1)),e("div",I,[e("span",null,"VAT ("+o(s.settings.vat_percentage)+"%):",1),e("span",null,"£"+o(n.calculateVat(100)),1)]),e("div",L,[t[14]||(t[14]=e("span",null,"Total Payable:",-1)),e("span",null,"£"+o(n.calculateTotal(100)),1)])])])):h("",!0),e("button",{onClick:t[6]||(t[6]=(...a)=>n.saveSettings&&n.saveSettings(...a)),class:"continue-btn",disabled:!s.isValid||s.loading},o(s.loading?"Saving...":"Save VAT Settings"),9,M)])])]),_:1})}const R=_(A,[["render",q],["__scopeId","data-v-e028d177"]]);export{R as default};
