import{r as u,J as N,d as m,b as j,c as D,o as s,w as M,L as B,k as p,u as L,e as F,a as o,f as a,g as h,F as P,p as V,q as A,t as f,h as R}from"./app-IgbZzkPW.js";import{P as S}from"./ProviderDashboardLayout-Cb3-j8bR.js";import{C as z}from"./CustomerDashboardLayout-BAt8w28n.js";import"./NotificationDropdown-r037V1rt.js";import"./x-CgxBf4w-.js";const I={class:"container mx-auto px-4 py-8 max-w-4xl"},J={class:"flex justify-between items-center mb-6"},T={key:0,class:"flex justify-center py-12"},$={key:1,class:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center"},q={key:2,class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden divide-y divide-gray-100"},E=["onClick"],H={class:"flex items-start space-x-4"},O={class:"flex-shrink-0"},U=["src"],Y={key:1,class:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center text-red-500"},G={class:"flex-1 min-w-0 pr-8"},K={class:"flex justify-between items-start"},Q={class:"text-xs text-gray-500 whitespace-nowrap ml-2"},W={class:"text-gray-600 leading-relaxed"},X={key:0,class:"absolute top-6 right-6 w-2.5 h-2.5 bg-red-500 rounded-full"},Z=["onClick"],ie={__name:"Notifications",setup(ee){const l=L(),g=F(),i=u([]),d=u(!0),n=u(window.location.pathname.includes("/provider")?"provider":"customer");N(()=>g.path,t=>{n.value=t.includes("/provider")?"provider":"customer"});const y=m(()=>n.value==="provider"?S:z),x=m(()=>i.value.filter(t=>!t.is_read).length),k=async()=>{try{d.value=!0;const t=n.value==="provider"?"/getNotificationProvider":"/getNotificationCustomer",e=await p.get(t);e.data&&e.data.success&&(i.value=e.data.data||[])}catch(t){console.error("Failed to fetch notifications:",t)}finally{d.value=!1}},_=async()=>{try{const t=n.value==="provider"?"/readNotificationProvider":"/readNotificationCustomer",e=await p.get(t);e.data&&e.data.success&&(i.value=i.value.map(r=>({...r,is_read:1})))}catch(t){console.error("Failed to mark notifications as read:",t)}},w=async t=>{if(confirm("Are you sure you want to delete this notification?"))try{const e=n.value==="provider"?"/deleteNotificationProvider":"/deleteNotificationCustomer",r=await p.post(e,{id:t});r.data&&r.data.success&&(i.value=i.value.filter(c=>c.id!==t))}catch(e){console.error("Failed to delete notification:",e)}},v=t=>n.value==="provider"?t.customer_image||t.image:t.provider_image||t.image,b=t=>{if(!t)return"";const e=new Date(t);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).format(e)},C=t=>{if(t.data){let e=t.data;if(typeof e=="string")try{e=JSON.parse(e)}catch{}e.booking_id?n.value==="provider"?l.push("/provider/bookings"):l.push("/my-bookings"):e.type==="message"&&(n.value==="provider"?l.push("/provider/messages"):l.push("/messages"))}};return j(()=>{k()}),(t,e)=>(s(),D(B(y.value),null,{default:M(()=>[o("div",I,[o("div",J,[e[0]||(e[0]=o("h1",{class:"text-2xl font-bold text-gray-900"},"Notifications",-1)),x.value>0?(s(),a("button",{key:0,onClick:_,class:"text-sm font-medium text-red-600 hover:text-red-700 transition-colors"}," Mark all as read ")):h("",!0)]),d.value?(s(),a("div",T,[...e[1]||(e[1]=[o("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-500"},null,-1)])])):i.value.length===0?(s(),a("div",$,[...e[2]||(e[2]=[o("div",{class:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"},[o("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})])],-1),o("h3",{class:"text-lg font-medium text-gray-900"},"No notifications",-1),o("p",{class:"text-gray-500 mt-1"},"You're all caught up! Check back later for updates.",-1)])])):(s(),a("div",q,[(s(!0),a(P,null,V(i.value,r=>(s(),a("div",{key:r.id,class:A(["p-6 hover:bg-gray-50 transition-colors relative group cursor-pointer",{"bg-red-50/30":!r.is_read}]),onClick:c=>C(r)},[o("div",H,[o("div",O,[v(r)?(s(),a("img",{key:0,src:v(r),class:"w-12 h-12 rounded-full object-cover border border-gray-200",alt:""},null,8,U)):(s(),a("div",Y,[...e[3]||(e[3]=[o("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])]))]),o("div",G,[o("div",K,[o("span",Q,f(b(r.created_at)),1)]),o("p",W,f(r.message),1)]),r.is_read?h("",!0):(s(),a("div",X)),o("button",{onClick:R(c=>w(r.id),["stop"]),class:"absolute top-4 right-4 p-2 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity bg-white/80 rounded-full hover:bg-red-50",title:"Delete notification"},[...e[4]||(e[4]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Z)])],10,E))),128))]))])]),_:1}))}};export{ie as default};
