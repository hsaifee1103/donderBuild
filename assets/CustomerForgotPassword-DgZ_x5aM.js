import{r as s,b as f,e as p,k as y,u as g}from"./app-ClV_mout.js";import{_ as h}from"./AuthLayout-B1Yj2HMU.js";import{C as v}from"./CountrySelector-B0eqjvXV.js";import{c as b}from"./countries-DXaTS7mb.js";/* empty css                                                                        */const S={name:"CustomerForgotPassword",components:{AuthLayout:h,CountrySelector:v},setup(){const d=g(),i=p(),a=s(""),c=s(!1),r=s(""),t=s({name:"United Kingdom",dial_code:"+44",code:"GB",flag:"gb"}),u=s(!1),m=async()=>{if(a.value.trim()){c.value=!0,r.value="";try{const e={country_code:t.value.dial_code,mobile:a.value,user_type:"customer"};console.log("Checking user with data:",e);const o=await y.post("/user/email-by-mobile",e);if(console.log("API response:",o.data),o.data&&o.data.success){const{masked_email:n,email:l}=o.data.data;localStorage.setItem("forgotPasswordEmail",l),d.push({path:"/customer/forgot-password/confirm-email",query:{mobile:a.value,countryCode:t.value.dial_code,maskedEmail:n}})}else r.value="No account found with this mobile number. Please check and try again."}catch(e){if(console.error("Error checking user:",e),e.response){const o=e.response.data;r.value=o.message||"An error occurred while checking user information."}else r.value="Network error. Please check your connection."}finally{c.value=!1,u.value=!1}}};return f(()=>{const e=i.query.mobile,o=i.query.countryCode;if(e&&o){a.value=e;const n=b.find(l=>l.dial_code===o);n&&(t.value=n),u.value=!0,m()}}),{phoneNumber:a,isLoading:c,errorMessage:r,selectedCountry:t,handleContinue:m,autoSubmit:u}}};export{S as default};
