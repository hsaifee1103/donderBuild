import{u as x,c as k,f as r,o as i,b as t,g as u,K as w,F as b,p as _,q as g,t as p,n as C,h as M}from"./app-CWmiax_p.js";const N={class:"absolute right-0 top-full mt-2 w-80 sm:w-96 bg-white border border-gray-200 rounded-xl shadow-xl z-50 overflow-hidden"},$={class:"p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50"},B={class:"flex space-x-2"},j={class:"max-h-[400px] overflow-y-auto"},V={key:0,class:"p-8 text-center text-gray-500"},D={key:1,class:"p-8 text-center text-gray-500 flex flex-col items-center"},z={key:2,class:"divide-y divide-gray-100"},I=["onClick"],S={class:"flex items-start space-x-3"},L={class:"flex-shrink-0"},T=["src"],A={key:1,class:"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center text-red-500"},q={class:"flex-1 min-w-0 pr-6"},E={class:"text-sm text-gray-600 leading-snug line-clamp-2 mb-1.5"},F={class:"text-xs text-gray-400 flex items-center"},H={key:0,class:"absolute top-4 right-4 w-2 h-2 bg-red-500 rounded-full"},J=["onClick","disabled"],K={key:0},O={key:1},R={class:"p-3 border-t border-gray-100 bg-gray-50 text-center"},G={__name:"NotificationDropdown",props:{notifications:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},userType:{type:String,required:!0},deletingId:{type:[String,Number],default:null}},emits:["mark-all-read","delete","view-all","close"],setup(n,{emit:m}){const a=n,h=m,d=x(),f=k(()=>a.notifications.filter(s=>!s.is_read).length),c=s=>a.userType==="provider"?s.customer_image||s.image:s.provider_image||s.image,v=s=>{if(!s)return"";const e=new Date(s),l=Math.floor((new Date-e)/1e3);return l<60?"Just now":l<3600?`${Math.floor(l/60)}m ago`:l<86400?`${Math.floor(l/3600)}h ago`:l<604800?`${Math.floor(l/86400)}d ago`:e.toLocaleDateString()},y=s=>{if(console.log("Notification clicked:",s),s.data){let e=s.data;if(typeof e=="string")try{e=JSON.parse(e)}catch(o){console.error("Error parsing notification data",o)}e.booking_id?a.userType==="provider"?d.push("/provider/bookings"):d.push("/my-bookings"):e.type==="message"&&(a.userType==="provider"?d.push("/provider/messages"):d.push("/messages"))}h("close")};return(s,e)=>(i(),r("div",N,[t("div",$,[e[2]||(e[2]=t("h3",{class:"font-bold text-gray-900"},"Notifications",-1)),t("div",B,[f.value>0?(i(),r("button",{key:0,onClick:e[0]||(e[0]=o=>s.$emit("mark-all-read")),class:"text-xs font-medium text-red-600 hover:text-red-700 transition-colors"}," Mark all as read ")):u("",!0)])]),t("div",j,[n.loading?(i(),r("div",V,[...e[3]||(e[3]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-500 mx-auto mb-2"},null,-1),t("p",{class:"text-sm"},"Loading notifications...",-1)])])):n.notifications.length===0?(i(),r("div",D,[...e[4]||(e[4]=[w('<div class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-3"><svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg></div><p class="text-sm font-medium">No notifications yet</p><p class="text-xs mt-1">We&#39;ll let you know when something important happens.</p>',3)])])):(i(),r("div",z,[(i(!0),r(b,null,_(n.notifications,o=>(i(),r("div",{key:o.id,class:g(["p-4 hover:bg-gray-50 transition-colors relative group cursor-pointer",{"bg-red-50/30":!o.is_read}]),onClick:l=>y(o)},[t("div",S,[t("div",L,[c(o)?(i(),r("img",{key:0,src:c(o),class:"w-10 h-10 rounded-full object-cover border border-gray-200",alt:""},null,8,T)):(i(),r("div",A,[...e[5]||(e[5]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])]))]),t("div",q,[t("p",E,p(o.message),1),t("p",F,[e[6]||(e[6]=t("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),C(" "+p(v(o.created_at)),1)])]),o.is_read?u("",!0):(i(),r("div",H)),t("button",{onClick:M(l=>s.$emit("delete",o.id),["stop"]),class:g(["absolute top-2 right-2 p-1 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity bg-white/80 rounded-full",{"opacity-100":n.deletingId===o.id}]),disabled:n.deletingId===o.id,title:"Delete notification"},[n.deletingId===o.id?(i(),r("span",K,[...e[7]||(e[7]=[t("svg",{class:"animate-spin h-4 w-4 text-red-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):(i(),r("span",O,[...e[8]||(e[8]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]))],10,J)])],10,I))),128))]))]),t("div",R,[t("button",{onClick:e[1]||(e[1]=o=>s.$emit("view-all")),class:"text-sm font-medium text-red-600 hover:text-red-700 transition-colors"}," View all notifications ")])]))}};export{G as _};
