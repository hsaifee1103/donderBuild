import{l as B,r as c,d as U,a as z,o as i,w as L,k as y,u as $,b as t,f as d,g as C,t as p,i as g,B as m,q as r,I as x}from"./app-C0VbAaEP.js";import{C as V}from"./CustomerDashboardLayout-BY8Ku9VI.js";import{u as N}from"./useSocialAuth-DMPPWeF1.js";import"./NotificationDropdown-BpaKGOwL.js";import"./x-BGqzC3Ia.js";const E={class:"max-w-7xl mx-auto"},I={class:"bg-white rounded-lg overflow-hidden"},O={class:"p-6"},T={key:0,class:"mb-6 p-4 bg-green-50 text-green-700 rounded-lg"},F={key:1,class:"mb-6 p-4 bg-red-50 text-red-700 rounded-lg"},R={class:"flex items-start"},H={class:"space-y-8"},G={class:"shadow border p-6 rounded-lg border-gray-200"},J={class:"space-y-4"},K={class:"flex items-center justify-between"},Y={class:"relative inline-block w-10 mr-2 align-middle select-none"},Q={class:"flex items-center justify-between"},W={class:"relative inline-block w-10 mr-2 align-middle select-none"},X={class:"flex items-center justify-between"},Z={class:"relative inline-block w-10 mr-2 align-middle select-none"},ee={class:"flex items-center justify-between"},te={class:"relative inline-block w-10 mr-2 align-middle select-none"},se={class:"flex items-center justify-between"},oe={class:"relative inline-block w-10 mr-2 align-middle select-none"},ne={class:"flex items-center justify-between"},ae={class:"relative inline-block w-10 mr-2 align-middle select-none"},re={class:"flex items-center justify-between"},le={class:"relative inline-block w-10 mr-2 align-middle select-none"},ie={class:"shadow border p-6 rounded-lg border-gray-200"},ue={class:"space-y-4"},ce={class:"flex items-center justify-between"},de={class:"flex items-center"},fe={class:"text-sm text-gray-500"},ge={class:"flex items-center justify-between"},me={class:"flex items-center"},ve={class:"text-sm text-gray-500"},pe={class:"flex items-center justify-between"},be={class:"flex items-center"},ye={class:"text-sm text-gray-500"},xe={class:"text-center"},_e={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},he={class:"bg-white rounded-lg p-6 max-w-md w-full"},ke={class:"flex justify-end space-x-3"},we=["disabled"],Ce={__name:"Settings",setup(Ae){const j=$(),{signInWithProvider:q,linkSocialAccount:S}=N(),_=c(!1),a=c(""),A=c(!1),b=c(!1),v=c(!1),u=c(null),h=c(!1),o=c({quotation_request:!1,payment_confirmation:!1,admin_message:!1,offer:!1,booking:!1,server_or_job_done:!1,pickup_vehicle:!1}),l=c({apple:!1,google:!1,facebook:!1}),D=async()=>{try{const s=localStorage.getItem("userData");if(s)try{const e=JSON.parse(s);u.value=e.id||e.customer_id,e.preferences&&(o.value={quotation_request:e.preferences.quotation_request||!1,payment_confirmation:e.preferences.payment_confirmation||!1,admin_message:e.preferences.admin_message||!1,offer:e.preferences.offer||!1,booking:e.preferences.booking||!1,server_or_job_done:e.preferences.server_or_job_done||!1,pickup_vehicle:e.preferences.pickup_vehicle||!1}),await M()}catch(e){console.error("Error parsing user data:",e)}}catch(s){console.error("Error loading user data:",s)}},M=async()=>{if(u.value)try{const s=await y.post("/getSettings",{user_id:u.value});if(s.data&&s.data.success){const e=s.data.data;e.preferences&&(o.value={quotation_request:!!e.preferences.quotation_request,payment_confirmation:!!e.preferences.payment_confirmation,admin_message:!!e.preferences.admin_message,offer:!!e.preferences.offer,booking:!!e.preferences.booking,server_or_job_done:!!e.preferences.server_or_job_done,pickup_vehicle:!!e.preferences.pickup_vehicle}),e.connected_accounts?l.value={apple:!!e.connected_accounts.apple,google:!!e.connected_accounts.google,facebook:!!e.connected_accounts.facebook}:e.social_accounts&&(l.value={apple:!!e.social_accounts.apple,google:!!e.social_accounts.google,facebook:!!e.social_accounts.facebook})}}catch(s){console.error("Error fetching settings:",s)}},f=async()=>{if(!u.value){a.value="User not authenticated. Please log in again.";return}A.value=!0,a.value="";try{const s={user_id:u.value,quotation_request:o.value.quotation_request,payment_confirmation:o.value.payment_confirmation,admin_message:o.value.admin_message,offer:o.value.offer,booking:o.value.booking,server_or_job_done:o.value.server_or_job_done,pickup_vehicle:o.value.pickup_vehicle},e=await y.post("/savePreferences",s);if(e.data&&e.data.success){const n=JSON.parse(localStorage.getItem("userData")||"{}");n.preferences=o.value,localStorage.setItem("userData",JSON.stringify(n)),_.value=!0,setTimeout(()=>{_.value=!1},3e3)}else e.data.errors&&Array.isArray(e.data.errors)&&e.data.errors.length>0?a.value=e.data.errors.join(", "):e.data.message?a.value=e.data.message:a.value="Failed to save preferences. Please try again."}catch(s){console.error("Error saving preferences:",s),s.response&&s.response.data?s.response.data.errors&&Array.isArray(s.response.data.errors)?a.value=s.response.data.errors.join(", "):s.response.data.message?a.value=s.response.data.message:a.value="An error occurred while saving your preferences. Please try again.":a.value="An error occurred while saving your preferences. Please try again."}finally{A.value=!1}},k=async s=>{if(confirm(`Are you sure you want to unlink your ${s} account?`))try{const e=await y.post("/unlinkSocialLogin",{user_id:u.value,provider:s});e.data&&e.data.success?(l.value[s]=!1,x({type:"success",title:"Account Unlinked",message:`Your ${s} account has been unlinked successfully.`,confirmButtonText:"OK"})):alert(e.data.message||"Failed to unlink account")}catch(e){console.error("Error unlinking account:",e),alert("An error occurred while unlinking the account.")}},w=async s=>{if(!h.value){h.value=!0;try{const e=await q(s);if(!e)throw new Error("No data received from OAuth provider");const n=await S(u.value,e);if(n&&n.success)l.value[s]=!0,x({type:"success",title:"Account Linked",message:`Your ${s} account has been linked successfully.`,confirmButtonText:"OK"});else throw new Error((n==null?void 0:n.message)||"Failed to link account")}catch(e){console.error("Error linking account:",e);let n="An error occurred while linking the account.";e.message.includes("not configured")?n=`${s} OAuth is not configured yet. Please contact support.`:e.message.includes("cancelled")?n=`${s} login was cancelled.`:e.message&&(n=e.message),x({type:"error",title:"Linking Failed",message:n,confirmButtonText:"OK"})}finally{h.value=!1}}},P=async()=>{if(!u.value){a.value="User not authenticated. Please log in again.";return}b.value=!0,a.value="";try{const s={id:u.value},e=await y.post("/deleteCustomerAccount",s);e.data&&e.data.success?(localStorage.removeItem("userData"),localStorage.removeItem("authToken"),x({type:"success",title:"Account Deleted",message:"Your account has been deleted successfully.",confirmButtonText:"OK"}),v.value=!1,j.push("/")):(e.data.errors&&Array.isArray(e.data.errors)&&e.data.errors.length>0?a.value=e.data.errors.join(", "):e.data.message?a.value=e.data.message:a.value="Failed to delete account. Please try again.",v.value=!1)}catch(s){console.error("Error deleting account:",s),s.response&&s.response.data?s.response.data.errors&&Array.isArray(s.response.data.errors)?a.value=s.response.data.errors.join(", "):s.response.data.message?a.value=s.response.data.message:a.value="An error occurred while deleting your account. Please try again.":a.value="An error occurred while deleting your account. Please try again.",v.value=!1}finally{b.value=!1}};return U(()=>{D()}),(s,e)=>(i(),z(V,null,{default:L(()=>[t("div",E,[e[33]||(e[33]=t("div",{class:"mt-5"},[t("h1",{class:"text-2xl px-6 font-bold text-gray-900"},"Settings")],-1)),t("div",I,[t("div",O,[e[32]||(e[32]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-6"},"Settings",-1)),_.value?(i(),d("div",T,[...e[15]||(e[15]=[t("div",{class:"flex items-start"},[t("svg",{class:"h-5 w-5 text-green-500 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),t("p",null,"Your settings have been updated successfully!")],-1)])])):C("",!0),a.value?(i(),d("div",F,[t("div",R,[e[16]||(e[16]=t("svg",{class:"h-5 w-5 text-red-500 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("p",null,p(a.value),1)])])):C("",!0),t("div",H,[t("div",G,[e[24]||(e[24]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Push Notification",-1)),t("div",J,[t("div",K,[e[17]||(e[17]=t("div",null,[t("p",{class:"text-gray-900 font-medium"},"Quotation Request & Approval"),t("p",{class:"text-sm text-gray-500"},"Receive notification of quotation request and approval ")],-1)),t("div",Y,[g(t("input",{type:"checkbox",id:"sign_up","onUpdate:modelValue":e[0]||(e[0]=n=>o.value.quotation_request=n),onChange:f,class:"sr-only"},null,544),[[m,o.value.quotation_request]]),t("label",{for:"sign_up",class:r(["block h-6 w-10 rounded-full cursor-pointer transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",o.value.quotation_request?"bg-rose-500":"bg-gray-300"])},[t("span",{class:r(["absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform duration-200 shadow-sm",o.value.quotation_request?"transform translate-x-5":""])},null,2)],2)])]),t("div",Q,[e[18]||(e[18]=t("div",null,[t("p",{class:"text-gray-900 font-medium"},"Payment Confirmation"),t("p",{class:"text-sm text-gray-500"},"Get notified when a payment is confirmed")],-1)),t("div",W,[g(t("input",{type:"checkbox",id:"service_quotation","onUpdate:modelValue":e[1]||(e[1]=n=>o.value.payment_confirmation=n),onChange:f,class:"sr-only"},null,544),[[m,o.value.payment_confirmation]]),t("label",{for:"service_quotation",class:r(["block h-6 w-10 rounded-full cursor-pointer transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",o.value.payment_confirmation?"bg-rose-500":"bg-gray-300"])},[t("span",{class:r(["absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform duration-200 shadow-sm",o.value.payment_confirmation?"transform translate-x-5":""])},null,2)],2)])]),t("div",X,[e[19]||(e[19]=t("div",null,[t("p",{class:"text-gray-900 font-medium"},"Admin Message"),t("p",{class:"text-sm text-gray-500"},"Receive important messages from administrators")],-1)),t("div",Z,[g(t("input",{type:"checkbox",id:"admin_message","onUpdate:modelValue":e[2]||(e[2]=n=>o.value.admin_message=n),onChange:f,class:"sr-only"},null,544),[[m,o.value.admin_message]]),t("label",{for:"admin_message",class:r(["block h-6 w-10 rounded-full cursor-pointer transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",o.value.admin_message?"bg-rose-500":"bg-gray-300"])},[t("span",{class:r(["absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform duration-200 shadow-sm",o.value.admin_message?"transform translate-x-5":""])},null,2)],2)])]),t("div",ee,[e[20]||(e[20]=t("div",null,[t("p",{class:"text-gray-900 font-medium"},"Offer"),t("p",{class:"text-sm text-gray-500"},"Get notified about special offers and promotions")],-1)),t("div",te,[g(t("input",{type:"checkbox",id:"offer","onUpdate:modelValue":e[3]||(e[3]=n=>o.value.offer=n),onChange:f,class:"sr-only"},null,544),[[m,o.value.offer]]),t("label",{for:"offer",class:r(["block h-6 w-10 rounded-full cursor-pointer transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",o.value.offer?"bg-rose-500":"bg-gray-300"])},[t("span",{class:r(["absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform duration-200 shadow-sm",o.value.offer?"transform translate-x-5":""])},null,2)],2)])]),t("div",se,[e[21]||(e[21]=t("div",null,[t("p",{class:"text-gray-900 font-medium"},"Booking"),t("p",{class:"text-sm text-gray-500"},"Receive notifications about your bookings")],-1)),t("div",oe,[g(t("input",{type:"checkbox",id:"booking","onUpdate:modelValue":e[4]||(e[4]=n=>o.value.booking=n),onChange:f,class:"sr-only"},null,544),[[m,o.value.booking]]),t("label",{for:"booking",class:r(["block h-6 w-10 rounded-full cursor-pointer transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",o.value.booking?"bg-rose-500":"bg-gray-300"])},[t("span",{class:r(["absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform duration-200 shadow-sm",o.value.booking?"transform translate-x-5":""])},null,2)],2)])]),t("div",ne,[e[22]||(e[22]=t("div",null,[t("p",{class:"text-gray-900 font-medium"},"Server or Job Done"),t("p",{class:"text-sm text-gray-500"},"Get notified when your service is completed")],-1)),t("div",ae,[g(t("input",{type:"checkbox",id:"server_job_done","onUpdate:modelValue":e[5]||(e[5]=n=>o.value.server_or_job_done=n),onChange:f,class:"sr-only"},null,544),[[m,o.value.server_or_job_done]]),t("label",{for:"server_job_done",class:r(["block h-6 w-10 rounded-full cursor-pointer transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",o.value.server_or_job_done?"bg-rose-500":"bg-gray-300"])},[t("span",{class:r(["absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform duration-200 shadow-sm",o.value.server_or_job_done?"transform translate-x-5":""])},null,2)],2)])]),t("div",re,[e[23]||(e[23]=t("div",null,[t("p",{class:"text-gray-900 font-medium"},"Pickup Vehicle"),t("p",{class:"text-sm text-gray-500"},"Receive notifications about vehicle pickup status")],-1)),t("div",le,[g(t("input",{type:"checkbox",id:"pickup_vehicle","onUpdate:modelValue":e[6]||(e[6]=n=>o.value.pickup_vehicle=n),onChange:f,class:"sr-only"},null,544),[[m,o.value.pickup_vehicle]]),t("label",{for:"pickup_vehicle",class:r(["block h-6 w-10 rounded-full cursor-pointer transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500",o.value.pickup_vehicle?"bg-rose-500":"bg-gray-300"])},[t("span",{class:r(["absolute left-1 top-1 bg-white w-4 h-4 rounded-full transition-transform duration-200 shadow-sm",o.value.pickup_vehicle?"transform translate-x-5":""])},null,2)],2)])])])]),t("div",ie,[e[31]||(e[31]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Connected Accounts",-1)),t("div",ue,[t("div",ce,[t("div",de,[e[26]||(e[26]=t("div",{class:"w-10 h-10 rounded-full bg-black flex items-center justify-center mr-3"},[t("svg",{class:"w-6 h-6 text-white",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"})])],-1)),t("div",null,[e[25]||(e[25]=t("p",{class:"text-gray-900 font-medium"},"Apple",-1)),t("p",fe,p(l.value.apple?"Connected":"Not Connected"),1)])]),l.value.apple?(i(),d("button",{key:0,onClick:e[7]||(e[7]=n=>k("apple")),class:"text-red-500 hover:text-red-600 font-medium"}," Unlink ")):(i(),d("button",{key:1,onClick:e[8]||(e[8]=n=>w("apple")),class:"text-red-500 hover:text-red-600 font-medium"}," Link "))]),t("div",ge,[t("div",me,[e[28]||(e[28]=t("div",{class:"w-10 h-10 rounded-full bg-blue-500 flex items-center justify-center mr-3"},[t("svg",{class:"w-6 h-6 text-white",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),t("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),t("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),t("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})])],-1)),t("div",null,[e[27]||(e[27]=t("p",{class:"text-gray-900 font-medium"},"Google",-1)),t("p",ve,p(l.value.google?"Connected":"Not Connected"),1)])]),l.value.google?(i(),d("button",{key:0,onClick:e[9]||(e[9]=n=>k("google")),class:"text-red-500 hover:text-red-600 font-medium"}," Unlink ")):(i(),d("button",{key:1,onClick:e[10]||(e[10]=n=>w("google")),class:"text-red-500 hover:text-red-600 font-medium"}," Link "))]),t("div",pe,[t("div",be,[e[30]||(e[30]=t("div",{class:"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center mr-3"},[t("svg",{class:"w-6 h-6 text-white",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})])],-1)),t("div",null,[e[29]||(e[29]=t("p",{class:"text-gray-900 font-medium"},"Facebook",-1)),t("p",ye,p(l.value.facebook?"Connected":"Not Connected"),1)])]),l.value.facebook?(i(),d("button",{key:0,onClick:e[11]||(e[11]=n=>k("facebook")),class:"text-red-500 hover:text-red-600 font-medium"}," Unlink ")):(i(),d("button",{key:1,onClick:e[12]||(e[12]=n=>w("facebook")),class:"text-red-500 hover:text-red-600 font-medium"}," Link "))])])]),t("div",xe,[t("button",{onClick:e[13]||(e[13]=n=>v.value=!0),class:"text-red-500 hover:text-red-600 font-medium"}," Delete my Account ")])])])])]),v.value?(i(),d("div",_e,[t("div",he,[e[34]||(e[34]=t("h3",{class:"text-xl font-bold text-gray-900 mb-4"},"Delete Account",-1)),e[35]||(e[35]=t("p",{class:"text-gray-600 mb-6"}," Are you sure you want to delete your account? This action cannot be undone and all your data will be permanently removed. ",-1)),t("div",ke,[t("button",{onClick:e[14]||(e[14]=n=>v.value=!1),class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Cancel "),t("button",{onClick:P,class:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed",disabled:b.value},p(b.value?"Deleting...":"Delete Account"),9,we)])])])):C("",!0)]),_:1}))}},Pe=B(Ce,[["__scopeId","data-v-2c2d2993"]]);export{Pe as default};
