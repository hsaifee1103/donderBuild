import{_ as h}from"./AuthLayout-C8DpIk_a.js";import{l as f,c as y,o as d,w as v,m as b,k as u,a as s,f as c,g as T,n as p,t as m,h as x,F as _,p as w,i as M,q as P,v as O}from"./app-BPEm73JO.js";const I={name:"ProviderForgotPasswordOTP",components:{AuthLayout:h},data(){return{otpDigits:["","","",""],isLoading:!1,resendTimer:59,timerInterval:null,errorMessage:""}},computed:{email(){return this.$route.query.email||"your-email@example.com"},isOtpComplete(){return this.otpDigits.every(t=>t!=="")}},mounted(){this.startResendTimer()},beforeUnmount(){this.timerInterval&&clearInterval(this.timerInterval)},methods:{handleOtpInput(t,e){e.target.value&&t<3&&this.$refs[`otpInput${t+1}`][0].focus()},handleKeyDown(t,e){e.key==="Backspace"&&!this.otpDigits[t]&&t>0&&this.$refs[`otpInput${t-1}`][0].focus()},async handleSubmit(){if(this.isOtpComplete){this.isLoading=!0,this.errorMessage="";try{const t=this.otpDigits.join(""),e=await u.post("/provider/otp/verify",{email:this.email,otp:t});if(e.data&&e.data.success){const n=e.data.data.token;localStorage.setItem("authToken",n),u.setAuthToken(n),this.$router.push({name:"ProviderResetPassword"})}else e.data.errors&&Array.isArray(e.data.errors)&&e.data.errors.length>0?this.errorMessage=e.data.errors.join(", "):e.data.message?this.errorMessage=e.data.message:this.errorMessage="OTP verification failed. Please try again."}catch(t){if(console.error("Error verifying OTP:",t),t.response){t.response.status;const e=t.response.data;e.errors&&Array.isArray(e.errors)&&e.errors.length>0?this.errorMessage=e.errors.join(", "):e.message?this.errorMessage=e.message:this.errorMessage="An error occurred during OTP verification."}else this.errorMessage="Network error. Please check your connection."}finally{this.isLoading=!1}}},startResendTimer(){this.timerInterval=setInterval(()=>{this.resendTimer>0?this.resendTimer--:clearInterval(this.timerInterval)},1e3)},async resendOtp(){var t;if(!(this.resendTimer>0))try{const e=await u.post("/provider/password/forgot",{email:this.email});e.data&&e.data.success?(this.resendTimer=59,this.startResendTimer(),this.errorMessage=""):this.errorMessage=((t=e.data)==null?void 0:t.message)||"Failed to resend OTP."}catch(e){console.error("Error resending OTP:",e),this.errorMessage="Failed to resend OTP. Please try again."}}}},k={class:"w-full max-w-md mx-auto"},L={class:"text-gray-600 mb-8 text-center"},C={class:"font-medium text-gray-900"},D={key:0,class:"mb-4 p-3 bg-red-50 text-red-700 rounded-lg"},A={class:"flex items-start"},S={class:"text-sm"},V={class:"flex justify-center space-x-3"},F=["onUpdate:modelValue","onInput","onKeydown"],B=["disabled"],R={class:"text-center"},j=["disabled"];function K(t,e,n,N,r,o){const g=b("AuthLayout");return d(),y(g,null,{default:v(()=>[s("div",k,[e[6]||(e[6]=s("h1",{class:"text-2xl font-bold text-gray-900 mb-2"},"Provider Verification",-1)),s("p",L,[e[2]||(e[2]=p(" We've sent OTP to your email address at ",-1)),s("span",C,m(o.email),1),e[3]||(e[3]=p(" Please enter 4 digit code you receive. ",-1))]),r.errorMessage?(d(),c("div",D,[s("div",A,[e[5]||(e[5]=s("svg",{class:"h-5 w-5 text-red-500 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),s("div",null,[e[4]||(e[4]=s("p",{class:"font-medium"},"Verification Failed",-1)),s("p",S,m(r.errorMessage),1)])])])):T("",!0),s("form",{onSubmit:e[1]||(e[1]=x((...l)=>o.handleSubmit&&o.handleSubmit(...l),["prevent"])),class:"space-y-6"},[s("div",V,[(d(!0),c(_,null,w(r.otpDigits,(l,i)=>M((d(),c("input",{key:i,ref_for:!0,ref:`otpInput${i}`,"onUpdate:modelValue":a=>r.otpDigits[i]=a,type:"text",maxlength:"1",class:P(["w-12 h-12 text-center text-lg font-medium border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none",{"border-red-500":r.errorMessage}]),onInput:a=>o.handleOtpInput(i,a),onKeydown:a=>o.handleKeyDown(i,a)},null,42,F)),[[O,r.otpDigits[i]]])),128))]),s("button",{type:"submit",disabled:r.isLoading||!o.isOtpComplete,class:"w-full bg-red-500 hover:bg-red-600 disabled:bg-red-300 text-white font-medium py-3 px-4 rounded-lg transition-colors"},m(r.isLoading?"Verifying...":"Submit"),9,B),s("div",R,[s("button",{type:"button",onClick:e[0]||(e[0]=(...l)=>o.resendOtp&&o.resendOtp(...l)),disabled:r.resendTimer>0,class:"text-red-500 hover:text-red-600 font-medium disabled:opacity-50"},m(r.resendTimer>0?`Resend Code (${r.resendTimer}s)`:"Resend Code"),9,j)])],32)])]),_:1})}const U=f(I,[["render",K]]);export{U as default};
