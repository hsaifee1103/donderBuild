import{l as ce,r as n,d as u,e as ue,b as me,c as ge,o as d,w as b,k as F,u as ve,m as pe,a as e,f as c,j as k,n as B,t as l,F as U,p as E,g as xe,i as M,v as R,q as G,B as H,I as N}from"./app-DNlZ5eWp.js";import{_ as fe}from"./MainLayout-B-T0i9xv.js";import"./NotificationDropdown-CtzNW0ed.js";const ye={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},be={class:"mb-6"},he={class:"flex","aria-label":"Breadcrumb"},_e={class:"inline-flex items-center space-x-1 md:space-x-3"},we={class:"inline-flex items-center"},ke={class:"flex items-center"},Be={class:"flex items-center"},Ce={class:"flex items-center"},Se={class:"flex items-center"},De={key:0,class:"flex justify-center py-12"},Ve={key:1,class:"text-center py-12"},Ie={class:"text-gray-600"},Me={key:2,class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Ne={class:"lg:col-span-2"},Ae={class:"bg-white rounded-lg shadow-sm overflow-hidden"},je={class:"p-6"},Te={class:"mb-8"},Le={class:"flex items-start space-x-4 p-4 border border-gray-200 rounded-lg"},ze={class:"w-16 h-16 bg-yellow-400 rounded-lg flex items-center justify-center overflow-hidden"},Oe=["src","alt"],Pe={key:1,class:"text-black font-bold text-lg"},$e={class:"flex-1"},Fe={class:"font-semibold text-gray-900"},Ue={class:"flex items-center mt-1"},Ee={class:"ml-1 text-sm font-medium"},Re={class:"ml-1 text-sm text-gray-500"},Ge={class:"text-sm text-gray-600 mt-1"},He={class:"mb-8"},Je={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ke={class:"p-4 border border-gray-200 rounded-lg"},Ye={class:"font-medium text-gray-900"},qe={class:"p-4 border border-gray-200 rounded-lg"},Qe={class:"font-medium text-gray-900"},We={class:"p-4 border border-gray-200 rounded-lg"},Xe={class:"font-medium text-gray-900"},Ze={class:"p-4 border border-gray-200 rounded-lg"},et={class:"font-medium text-gray-900"},tt={class:"mb-8"},st={class:"flex items-center p-4 border border-gray-200 rounded-lg"},ot={class:"w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center overflow-hidden mr-4"},lt=["src","alt"],at={key:1,class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},rt={class:"flex-1"},nt={class:"font-medium text-gray-900"},it={class:"flex items-center text-sm text-gray-600 mt-1"},dt={class:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded font-medium"},ct={class:"flex items-center text-xs text-gray-500 mt-2 space-x-4"},ut={class:"mb-8"},mt={class:"space-y-4"},gt={class:"font-medium text-gray-900"},vt={class:"flex items-center mt-1"},pt={class:"text-sm text-gray-500"},xt={class:"font-medium text-gray-900"},ft={class:"mb-8"},yt={class:"flex"},bt={class:"mb-8"},ht={class:"mb-8"},_t={class:"space-y-4"},wt={class:"flex items-start"},kt={class:"flex items-start"},Bt={class:"lg:col-span-1"},Ct={class:"bg-white rounded-lg shadow-sm sticky top-6"},St={class:"p-6"},Dt={class:"mb-6"},Vt={class:"space-y-4"},It={class:"flex-1"},Mt={class:"font-medium text-gray-900"},Nt={class:"flex items-center mt-1"},At={class:"text-sm text-gray-500"},jt={class:"font-medium text-gray-900"},Tt=["disabled"],Lt={__name:"BookingConfirmation",setup(zt){const J=ue(),O=ve(),m=n(null),A=n(!0),C=n(null),p=n([]),g=n(null),r=n(null),h=n(""),x=n(""),_=n(!1),S=n(0),j=n(""),T=n(!1),L=n(!1),D=n(!1),v=u(()=>J.params.provider_id),K=async()=>{var s,t;try{A.value=!0;const o=await F.post("/garage",{provider_id:v.value});o.data&&o.data.success?m.value=o.data.data:C.value=o.data.message||"Failed to load garage details"}catch(o){C.value=((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||o.message||"An error occurred",console.error("Error fetching garage details:",o)}finally{A.value=!1}},Y=()=>{const s=localStorage.getItem("selectedServices"),t=localStorage.getItem("appointmentDetails"),o=localStorage.getItem("selectedVehicle");s&&(p.value=JSON.parse(s)),t&&(g.value=JSON.parse(t)),o&&(r.value=JSON.parse(o))},q=async()=>{if(!h.value.trim()){x.value="Please enter a promo code",_.value=!1;return}try{h.value.toUpperCase()==="SAVE10"?(S.value=P.value*.1,x.value="Promo code applied successfully!",_.value=!0):(S.value=0,x.value="Invalid promo code",_.value=!1)}catch(s){console.error("Error applying promo code:",s),x.value="An error occurred while applying the promo code",_.value=!1}},Q=s=>s?(typeof s=="string"?new Date(s):s).toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"short",year:"numeric"}):"",W=s=>s||"",X=s=>{if(!s)return"";const[t,o]=s.split(" ");let[i,f]=t.split(":").map(Number);o==="pm"&&i!==12?i+=12:o==="am"&&i===12&&(i=0);const I=p.value.reduce((re,ne)=>{const ie=ne.service_duration||"0 min",de=parseInt(ie)||0;return re+de},0),y=new Date;y.setHours(i,f+I);const w=y.getHours(),a=y.getMinutes(),le=w>=12?"pm":"am",ae=w%12||12;return`${s} - ${ae}:${a.toString().padStart(2,"0")} ${le}`},V=u(()=>{var s,t,o;return((o=(t=(s=m.value)==null?void 0:s.businesses)==null?void 0:t[0])==null?void 0:o.business_name)||"Garage"}),Z=u(()=>V.value.charAt(0).toUpperCase()),ee=u(()=>{var t,o;const s=(o=(t=m.value)==null?void 0:t.business_location)==null?void 0:o[0];return s?`${s.city}, ${s.state}, ${s.country}`:"Location not available"}),P=u(()=>p.value.reduce((s,t)=>s+parseFloat(t.price||0),0)),$=u(()=>0),te=u(()=>P.value+$.value-S.value),z=u(()=>T.value&&L.value&&!D.value),se=()=>{O.push({name:"BookingVehicle",params:{provider_id:v.value}})},oe=async()=>{var s,t;if(!z.value){N({type:"error",title:"Error",message:"Please agree to the policies to continue",confirmButtonText:"OK"});return}D.value=!0;try{const o={provider_id:v.value,services:p.value.map(f=>f.id),appointment_date:g.value.date,appointment_time:g.value.time,vehicle_id:r.value.id,notes:j.value,promo_code:h.value,discount:S.value,tax:$.value,total:te.value},i=await F.post("/create-booking",o);i.data&&i.data.success?(localStorage.removeItem("selectedServices"),localStorage.removeItem("appointmentDetails"),localStorage.removeItem("selectedVehicle"),N({type:"success",title:"Booking Confirmed",message:"Your appointment has been successfully booked. You will receive a confirmation email shortly.",confirmButtonText:"Great!"}),O.push({name:"BookingSuccess",params:{booking_id:i.data.data.booking_id}})):N({type:"error",title:"Booking Failed",message:i.data.message||"Failed to confirm your booking. Please try again.",confirmButtonText:"OK"})}catch(o){console.error("Error confirming booking:",o),N({type:"error",title:"Booking Failed",message:((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||o.message||"An error occurred while confirming your booking",confirmButtonText:"OK"})}finally{D.value=!1}};return me(()=>{K(),Y()}),(s,t)=>{const o=pe("router-link");return d(),ge(fe,null,{default:b(()=>{var i,f,I,y,w;return[e("main",ye,[e("div",be,[e("nav",he,[e("ol",_e,[e("li",we,[k(o,{to:{name:"Home"},class:"text-gray-700 hover:text-gray-900 inline-flex items-center"},{default:b(()=>[...t[4]||(t[4]=[e("svg",{class:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})],-1),B(" Home ",-1)])]),_:1})]),e("li",null,[e("div",ke,[t[5]||(t[5]=e("svg",{class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),k(o,{to:{name:"GarageDetails",params:{provider_id:v.value}},class:"text-gray-700 hover:text-gray-900 ml-1 md:ml-2 font-medium"},{default:b(()=>[B(l(V.value),1)]),_:1},8,["to"])])]),e("li",null,[e("div",Be,[t[7]||(t[7]=e("svg",{class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),k(o,{to:{name:"Booking",params:{provider_id:v.value}},class:"text-gray-700 hover:text-gray-900 ml-1 md:ml-2 font-medium"},{default:b(()=>[...t[6]||(t[6]=[B(" Booking ",-1)])]),_:1},8,["to"])])]),e("li",null,[e("div",Ce,[t[9]||(t[9]=e("svg",{class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),k(o,{to:{name:"BookingDateTime",params:{provider_id:v.value}},class:"text-gray-700 hover:text-gray-900 ml-1 md:ml-2 font-medium"},{default:b(()=>[...t[8]||(t[8]=[B(" Availability ",-1)])]),_:1},8,["to"])])]),e("li",null,[e("div",Se,[t[11]||(t[11]=e("svg",{class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)),k(o,{to:{name:"BookingVehicle",params:{provider_id:v.value}},class:"text-gray-700 hover:text-gray-900 ml-1 md:ml-2 font-medium"},{default:b(()=>[...t[10]||(t[10]=[B(" Vehicle ",-1)])]),_:1},8,["to"])])]),t[12]||(t[12]=e("li",null,[e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})]),e("span",{class:"text-gray-500 ml-1 md:ml-2 font-medium"},"Review and Confirm")])],-1))])])]),A.value?(d(),c("div",De,[...t[13]||(t[13]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-coral-500"},null,-1)])])):C.value?(d(),c("div",Ve,[t[14]||(t[14]=e("div",{class:"mb-4"},[e("svg",{class:"w-16 h-16 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),t[15]||(t[15]=e("h3",{class:"text-xl font-medium text-gray-900 mb-2"},"Unable to load booking details",-1)),e("p",Ie,l(C.value),1)])):(d(),c("div",Me,[e("div",Ne,[e("div",Ae,[t[33]||(t[33]=e("div",{class:"p-6 border-b border-gray-200"},[e("h1",{class:"text-2xl font-bold text-gray-900"},"Review and Confirm"),e("p",{class:"text-gray-600 mt-1"},"Please review your booking details before confirming")],-1)),e("div",je,[e("div",Te,[t[17]||(t[17]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Garage Information",-1)),e("div",Le,[e("div",ze,[(I=(f=(i=m.value)==null?void 0:i.businesses)==null?void 0:f[0])!=null&&I.file_id?(d(),c("img",{key:0,src:m.value.businesses[0].file_id,alt:V.value+" logo",class:"w-full h-full object-cover"},null,8,Oe)):(d(),c("span",Pe,l(Z.value),1))]),e("div",$e,[e("h3",Fe,l(V.value),1),e("div",Ue,[t[16]||(t[16]=e("svg",{class:"w-4 h-4 text-yellow-400 fill-current",viewBox:"0 0 20 20"},[e("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})],-1)),e("span",Ee,l(((y=m.value)==null?void 0:y.rating)||"0.0"),1),e("span",Re,"("+l(((w=m.value)==null?void 0:w.rating_count)||0)+")",1)]),e("p",Ge,l(ee.value),1)])])]),e("div",He,[t[22]||(t[22]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Appointment Details",-1)),e("div",Je,[e("div",Ke,[t[18]||(t[18]=e("div",{class:"text-sm text-gray-500 mb-1"},"Date",-1)),e("div",Ye,l(Q(g.value.date)),1)]),e("div",qe,[t[19]||(t[19]=e("div",{class:"text-sm text-gray-500 mb-1"},"Time",-1)),e("div",Qe,l(W(g.value.time)),1)]),e("div",We,[t[20]||(t[20]=e("div",{class:"text-sm text-gray-500 mb-1"},"Duration",-1)),e("div",Xe,l(g.value.duration),1)]),e("div",Ze,[t[21]||(t[21]=e("div",{class:"text-sm text-gray-500 mb-1"},"Time Range",-1)),e("div",et,l(X(g.value.time)),1)])])]),e("div",tt,[t[24]||(t[24]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Vehicle Information",-1)),e("div",st,[e("div",ot,[r.value.image?(d(),c("img",{key:0,src:r.value.image,alt:`${r.value.car_make||"Vehicle"} ${r.value.car_model||""}`,class:"w-full h-full object-cover"},null,8,lt)):(d(),c("svg",at,[...t[23]||(t[23]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])]))]),e("div",rt,[e("h3",nt,l(r.value.car_make||"Unknown")+" "+l(r.value.car_model||"Vehicle"),1),e("div",it,[e("span",dt,l(r.value.registrationNumber||r.value.car_model||"No Registration"),1)]),e("div",ct,[e("span",null,l(r.value.engine_size||"N/A")+"cc",1),e("span",null,l(r.value.fuelType||"N/A"),1),e("span",null,l(r.value.transmission||"N/A"),1),e("span",null,l(r.value.yearOfManufacture||"N/A"),1)])])])]),e("div",ut,[t[26]||(t[26]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Services",-1)),e("div",mt,[(d(!0),c(U,null,E(p.value,a=>(d(),c("div",{key:a.id,class:"flex justify-between items-center p-4 border border-gray-200 rounded-lg"},[e("div",null,[e("h3",gt,l(a.service_name),1),e("div",vt,[t[25]||(t[25]=e("svg",{class:"w-4 h-4 text-gray-400 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",pt,l(a.service_duration||"N/A"),1)])]),e("span",xt,"£"+l(a.price),1)]))),128))])]),t[32]||(t[32]=e("div",{class:"mb-8"},[e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Payment Information"),e("div",{class:"p-4 border border-gray-200 rounded-lg"},[e("div",{class:"flex items-center justify-between mb-4"},[e("div",{class:"flex items-center"},[e("div",{class:"w-10 h-6 bg-blue-600 rounded flex items-center justify-center mr-2"},[e("span",{class:"text-white text-xs font-bold"},"VISA")]),e("span",{class:"text-gray-700"},"•••• •••• •••• 1234")]),e("button",{class:"text-sm text-coral-500 hover:text-coral-600 font-medium"},"Change")]),e("div",{class:"text-sm text-gray-600"}," Card expires on 12/2025 ")])],-1)),e("div",ft,[t[27]||(t[27]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Promo Code",-1)),e("div",yt,[M(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>h.value=a),type:"text",placeholder:"Enter promo code",class:"flex-1 px-4 py-2 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-coral-500 focus:border-transparent"},null,512),[[R,h.value]]),e("button",{onClick:q,class:"px-4 py-2 bg-gray-200 text-gray-700 rounded-r-lg hover:bg-gray-300 transition-colors"}," Apply ")]),x.value?(d(),c("div",{key:0,class:G(["mt-2 text-sm",_.value?"text-green-600":"text-red-600"])},l(x.value),3)):xe("",!0)]),e("div",bt,[t[28]||(t[28]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Additional Notes (Optional)",-1)),M(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=a=>j.value=a),rows:"3",placeholder:"Add any special instructions or notes for your appointment",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-coral-500 focus:border-transparent"},null,512),[[R,j.value]])]),e("div",ht,[t[31]||(t[31]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Policies",-1)),e("div",_t,[e("div",wt,[M(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>T.value=a),type:"checkbox",id:"cancellation-policy",class:"mt-1 mr-2"},null,512),[[H,T.value]]),t[29]||(t[29]=e("label",{for:"cancellation-policy",class:"text-sm text-gray-600"}," I agree to the cancellation policy. A fee of £45 will be charged for rescheduling or cancelling less than 24 hours before the appointment. ",-1))]),e("div",kt,[M(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>L.value=a),type:"checkbox",id:"terms-conditions",class:"mt-1 mr-2"},null,512),[[H,L.value]]),t[30]||(t[30]=e("label",{for:"terms-conditions",class:"text-sm text-gray-600"}," I agree to the terms and conditions. I understand that any damages to my vehicle during the service are covered by the garage's insurance policy. ",-1))])])])])])]),e("div",Bt,[e("div",Ct,[t[36]||(t[36]=e("div",{class:"p-6 border-b border-gray-200"},[e("h2",{class:"text-xl font-bold text-gray-900"},"Order Summary")],-1)),e("div",St,[e("div",Dt,[t[35]||(t[35]=e("h4",{class:"font-semibold text-gray-900 mb-4"},"Order Summary",-1)),e("div",Vt,[(d(!0),c(U,null,E(p.value,a=>(d(),c("div",{key:a.id,class:"flex justify-between items-start"},[e("div",It,[e("p",Mt,l(a.service_name),1),e("div",Nt,[t[34]||(t[34]=e("svg",{class:"w-4 h-4 text-gray-400 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",At,l(a.service_duration||"N/A"),1)])]),e("span",jt,"£"+l(a.price),1)]))),128))])]),e("button",{disabled:!z.value,class:G(["w-full font-medium py-3 px-4 rounded-lg transition-colors",z.value?"bg-coral-500 hover:bg-red-500 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"]),onClick:oe},l(D.value?"Processing...":"Confirm Booking"),11,Tt),e("button",{onClick:se,class:"w-full mt-3 py-3 px-4 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"}," Back ")])])])]))])]}),_:1})}}},Ft=ce(Lt,[["__scopeId","data-v-43a92ac4"]]);export{Ft as default};
