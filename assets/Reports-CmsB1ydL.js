import{l as B,r as m,d as x,J as V,b as R,e as I,c as T,o as r,w as L,k as M,u as N,a as e,f as o,j as v,n as A,E as f,i as q,H as E,t as n,F as _,p as w,q as b,g as F}from"./app-IgbZzkPW.js";import{P as U}from"./ProviderDashboardLayout-Cb3-j8bR.js";import{c as O,a as P}from"./x-CgxBf4w-.js";import"./NotificationDropdown-r037V1rt.js";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=O("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),z={class:"p-6 bg-white rounded-xl shadow-sm border border-gray-200"},H={class:"mb-6"},G={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},J={class:"flex flex-col sm:flex-row justify-between gap-4 mb-6"},Y={class:"flex items-center gap-3"},K={class:"flex items-center gap-2 bg-gray-50 px-4 py-2 rounded-lg"},Q={class:"text-sm font-medium text-gray-700"},W={key:0,class:"flex justify-center items-center py-12"},X={key:1},Z={class:"overflow-x-auto"},ee={class:"min-w-full divide-y divide-gray-200"},te={class:"bg-white divide-y divide-gray-200"},se={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},ae={class:"px-6 py-4 whitespace-nowrap"},re={class:"flex items-center"},oe={class:"flex-shrink-0 h-10 w-10"},ne=["src"],le={key:1,class:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center"},ie={class:"text-gray-600 font-medium"},de={class:"ml-4"},ce={class:"text-sm font-medium text-gray-900"},ue={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},pe={class:"text-xs"},me={class:"px-6 py-4 whitespace-nowrap"},xe={class:"px-6 py-4 whitespace-nowrap"},ge={class:"px-6 py-4 text-sm text-gray-500"},ye={key:0},he={key:0,class:"text-xs text-gray-400"},ve={key:1,class:"text-gray-400"},fe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},_e={key:2,class:"text-center py-12"},we={__name:"Reports",setup(be){const u=I();N();const g=m(!0),c=m([]),p=m(""),l=m({start:"",end:""}),k=x(()=>{if(!l.value.start||!l.value.end)return"Select date range";const a=new Date(l.value.start),t=new Date(l.value.end);return`${a.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})} - ${t.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}`});x(()=>c.value.reduce((a,t)=>a+parseFloat(t.total_price),0)),x(()=>c.value.filter(a=>a.status==="completed").length),x(()=>c.value.filter(a=>a.status==="pending").length);const D=a=>{switch(a){case"completed":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"in_progress":return"bg-blue-100 text-blue-800";case"upcoming":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},S=a=>a.replace("_"," ").replace(/\b\w/g,t=>t.toUpperCase()),h=async()=>{g.value=!0;try{const a=JSON.parse(localStorage.getItem("userData")||"{}"),t=await M.post("/get-all-booking",{provider_id:a.id,status:p.value||null,start_date:l.value.start,end_date:l.value.end});t.data&&t.data.success&&(c.value=t.data.data)}catch(a){console.error("Error fetching bookings:",a)}finally{g.value=!1}},C=()=>{const t=[["Booking ID","Customer","Date","Time","Type","Status","Services","Amount"].join(","),...c.value.map(d=>[d.id,d.customer_name,d.booking_date,d.booking_time,d.booking_type,d.status,d.services.map(j=>j.name).join("; "),d.total_price].join(","))].join(`
`),s=new Blob([t],{type:"text/csv;charset=utf-8;"}),y=URL.createObjectURL(s),i=document.createElement("a");i.setAttribute("href",y),i.setAttribute("download",`bookings-report-${l.value.start}-to-${l.value.end}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)};return V(p,()=>{h()}),R(()=>{if(u.query.startDate&&u.query.endDate)l.value={start:u.query.startDate,end:u.query.endDate};else{const a=new Date,t=new Date(a.getFullYear(),a.getMonth(),1),s=new Date(a.getFullYear(),a.getMonth()+1,0);l.value={start:t.toISOString().split("T")[0],end:s.toISOString().split("T")[0]}}h()}),(a,t)=>(r(),T(U,null,{default:L(()=>[e("div",z,[e("div",H,[e("div",G,[t[2]||(t[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-800"},"Booking Reports"),e("p",{class:"text-gray-500"},"View and analyze your booking data.")],-1)),e("button",{onClick:C,class:"mt-3 sm:mt-0 flex items-center gap-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"},[v(f($),{class:"w-4 h-4"}),t[1]||(t[1]=A(" Export CSV ",-1))])])]),e("div",J,[e("div",Y,[t[4]||(t[4]=e("label",{class:"text-sm font-medium text-gray-700"},"Status:",-1)),q(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),class:"border border-gray-300 rounded-lg px-3 py-2 text-gray-700 focus:outline-none focus:ring-2 focus:ring-red-500"},[...t[3]||(t[3]=[e("option",{value:""},"All Statuses",-1),e("option",{value:"completed"},"Completed",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"cancelled"},"Cancelled",-1),e("option",{value:"in_progress"},"In Progress",-1),e("option",{value:"upcoming"},"Upcoming",-1)])],512),[[E,p.value]])]),e("div",K,[v(f(P),{class:"w-4 h-4 text-gray-500"}),e("span",Q,n(k.value),1)])]),g.value?(r(),o("div",W,[...t[5]||(t[5]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-500"},null,-1)])])):c.value.length>0?(r(),o("div",X,[e("div",Z,[e("table",ee,[t[6]||(t[6]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Booking ID "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Customer"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date & Time "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Services"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Amount")])],-1)),e("tbody",te,[(r(!0),o(_,null,w(c.value,s=>(r(),o("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",se," #"+n(s.id),1),e("td",ae,[e("div",re,[e("div",oe,[s.customer_profile_image?(r(),o("img",{key:0,src:s.customer_profile_image,class:"h-10 w-10 rounded-full object-cover",alt:""},null,8,ne)):(r(),o("div",le,[e("span",ie,n(s.customer_name.charAt(0)),1)]))]),e("div",de,[e("div",ce,n(s.customer_name),1)])])]),e("td",ue,[e("div",null,n(s.booking_date),1),e("div",pe,n(s.booking_time),1)]),e("td",me,[e("span",{class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",s.booking_type==="normal"?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"])},n(s.booking_type),3)]),e("td",xe,[e("span",{class:b(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",D(s.status)])},n(S(s.status)),3)]),e("td",ge,[s.services&&s.services.length>0?(r(),o("div",ye,[(r(!0),o(_,null,w(s.services.slice(0,2),(y,i)=>(r(),o("div",{key:i},n(y.name),1))),128)),s.services.length>2?(r(),o("div",he," +"+n(s.services.length-2)+" more ",1)):F("",!0)])):(r(),o("span",ve,"No services"))]),e("td",fe," Â£"+n(s.total_price),1)]))),128))])])])])):(r(),o("div",_e,[...t[7]||(t[7]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No bookings found",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"Try adjusting your filters or date range.",-1)])]))])]),_:1}))}},je=B(we,[["__scopeId","data-v-a9720733"]]);export{je as default};
