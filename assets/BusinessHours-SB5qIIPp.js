import{l as z,r as v,b as J,c as R,o as r,w as U,k as b,u as W,j as K,a as t,f as m,g as P,t as _,i as g,B as H,F as L,p as T,v as y,I as S}from"./app-CeYD0-mp.js";import{S as Q}from"./SetupLayout-CGhtcaXe.js";import{P as X}from"./ProviderDashboardLayout-_RL2-QAZ.js";import"./BackIcon-mmKhVG5U.js";import"./IconDocument-yW-gwF_e.js";import"./NotificationDropdown-CFIqk1aN.js";import"./x-jDAcizyc.js";const Y={class:"w-full p-6 overflow-y-auto"},Z={key:0,class:"mb-4 p-3 bg-red-50 text-red-700 rounded-lg"},ee={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},te={class:"flex items-center mb-4"},se={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},oe={class:"space-y-4"},ae={class:"row"},le={class:"left"},de=["for"],ie={class:"right"},ne={class:"switch"},re=["id","onUpdate:modelValue","onChange"],ue={key:0,class:"time-row"},ce={class:"times"},me=["onUpdate:modelValue","onChange"],pe=["onUpdate:modelValue","onChange"],ve={key:1,class:"time-row"},ge={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},fe={class:"flex justify-between items-center mb-4"},ye={key:0,class:"text-center py-4"},be={key:1,class:"text-center py-8 text-gray-500"},_e={key:2,class:"space-y-3"},xe={class:"text-sm font-medium text-gray-900"},he={class:"text-xs text-gray-500"},we={class:"flex space-x-2"},ke=["onClick"],Ce=["onClick"],De={class:"bottom-4 left-1/2 lg:mb-6 z-10 w-full lg:w-auto"},Se=["disabled"],Be={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Pe={class:"bg-white rounded-lg w-full max-w-md"},Ve={class:"flex items-center justify-between p-6 border-b border-gray-200"},$e={class:"p-6"},Me={class:"space-y-4"},Ue=["disabled"],He={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},Le={class:"bg-white rounded-lg w-full max-w-md"},Te={class:"flex items-center justify-between p-6 border-b border-gray-200"},je={class:"p-6"},Ee={class:"space-y-4"},Ne={class:"flex space-x-3"},Fe=["disabled"],qe={__name:"BusinessHours",setup(Ae){const j=W(),h=v(!1),E=v(!0),i=v(""),B=v(!0),w=v(!1),k=v(!1),f=v(!1),C=v([]),x=v([{id:1,name:"Monday",is_active:!0,open_time:"09:00",close_time:"17:00"},{id:2,name:"Tuesday",is_active:!0,open_time:"09:00",close_time:"17:00"},{id:3,name:"Wednesday",is_active:!0,open_time:"09:00",close_time:"17:00"},{id:4,name:"Thursday",is_active:!0,open_time:"09:00",close_time:"17:00"},{id:5,name:"Friday",is_active:!0,open_time:"09:00",close_time:"17:00"},{id:6,name:"Saturday",is_active:!1,open_time:"09:00",close_time:"17:00"},{id:7,name:"Sunday",is_active:!1,open_time:"09:00",close_time:"17:00"}]),u=v({start_date:"",end_date:"",description:""}),n=v({id:null,start_date:"",end_date:"",description:""}),D=async()=>{var a;try{const e=localStorage.getItem("userData");if(!e)return;const s=JSON.parse(e),o=await b.post("/provider/profile",{provider_id:s.id});if((a=o.data)!=null&&a.success){const d=o.data.data.business_days||[];console.log(d,"days from api"),x.value=x.value.map(l=>{const p=d.find(c=>c.day==l.id);return console.log(p),p?{...l,is_active:p.is_active==1,open_time:p.open_time||l.open_time,close_time:p.close_time||l.close_time}:l}),console.log(x.value),C.value=o.data.data.holidays||[]}}catch(e){console.error("Error fetching business hours:",e),i.value="Failed to load business hours."}finally{E.value=!1}},N=a=>{a.is_active||(a.open_time="09:00",a.close_time="17:00")},V=a=>{const e=new Date(`2000-01-01T${a.open_time}`),s=new Date(`2000-01-01T${a.close_time}`);e>=s&&(S({type:"error",title:"Invalid Time",message:"Closing time must be after opening time.",confirmButtonText:"OK"}),a.close_time="17:00")},F=(a,e)=>{const s=new Date(a),o=new Date(e);return`${s.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})} - ${o.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}`},q=async()=>{var a,e,s,o;if(!u.value.start_date||!u.value.end_date){i.value="Start and end dates are required.";return}f.value=!0;try{const d={start_date:u.value.start_date,end_date:u.value.end_date,description:u.value.description||""},l=await b.post("/business-holiday",d);(a=l.data)!=null&&a.success?(await D(),w.value=!1,u.value={start_date:"",end_date:"",description:""},S({type:"success",title:"Success",message:"Closed period added successfully.",confirmButtonText:"Great!"})):i.value=((e=l.data)==null?void 0:e.message)||"Failed to add closed period."}catch(d){i.value=((o=(s=d.response)==null?void 0:s.data)==null?void 0:o.message)||"Error adding closed period."}finally{f.value=!1}},A=async a=>{n.value={...a},k.value=!0},I=async()=>{var a,e,s,o;if(!n.value.start_date||!n.value.end_date){i.value="Start and end dates are required.";return}f.value=!0;try{const d={holiday_id:n.value.id,start_date:n.value.start_date,end_date:n.value.end_date,description:n.value.description||""},l=await b.post("/business-holiday",d);(a=l.data)!=null&&a.success?(await D(),k.value=!1,S({type:"success",title:"Success",message:"Closed period updated successfully.",confirmButtonText:"Great!"})):i.value=((e=l.data)==null?void 0:e.message)||"Failed to update closed period."}catch(d){i.value=((o=(s=d.response)==null?void 0:s.data)==null?void 0:o.message)||"Error updating closed period."}finally{f.value=!1}},$=async a=>{var e,s,o,d;if(confirm("Are you sure you want to delete this closed period?")){f.value=!0;try{const l={holiday_id:a},p=await b.delete("/business-holiday",{data:l});(e=p.data)!=null&&e.success?(await D(),S({type:"success",title:"Success",message:"Closed period deleted successfully.",confirmButtonText:"Great!"})):i.value=((s=p.data)==null?void 0:s.message)||"Failed to delete closed period."}catch(l){i.value=((d=(o=l.response)==null?void 0:o.data)==null?void 0:d.message)||"Error deleting closed period."}finally{f.value=!1}}},G=async()=>{var a,e,s,o,d;h.value=!0,i.value="";try{const l={days:x.value.filter(c=>c.open_time!==null).map(c=>({day:c.id,open_time:c.open_time,close_time:c.close_time,is_active:c.is_active?1:0})),holidays:C.value.map(c=>c.id),isBankHoliday:B.value?1:0},p=await b.post("/business-day",l);if((a=p.data)!=null&&a.success){const c=localStorage.getItem("userData"),O=JSON.parse(c),M=await b.post("/garage",{provider_id:O.id});(e=M.data)!=null&&e.success&&localStorage.setItem("userData",JSON.stringify(M.data.data)),j.push("/provider/dashboard")}else i.value=((s=p.data)==null?void 0:s.message)||"Failed to save business hours."}catch(l){i.value=((d=(o=l.response)==null?void 0:o.data)==null?void 0:d.message)||"Error saving business hours."}finally{h.value=!1}};return J(()=>{D()}),(a,e)=>(r(),R(X,null,{default:U(()=>[K(Q,null,{default:U(()=>[t("div",Y,[e[29]||(e[29]=t("div",{class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},[t("h2",{class:"text-lg font-semibold text-gray-900 mb-2"},"When are you open your business?"),t("p",{class:"text-sm text-gray-600"},"Configure the standard hours of operation for this location.")],-1)),i.value?(r(),m("div",Z,_(i.value),1)):P("",!0),t("div",ee,[t("div",te,[g(t("input",{id:"bankHolidays","onUpdate:modelValue":e[0]||(e[0]=s=>B.value=s),type:"checkbox",class:"checkbox"},null,512),[[H,B.value]]),e[11]||(e[11]=t("label",{for:"bankHolidays",class:"ml-3 text-sm font-medium text-gray-700"},"Enable Bank Holidays",-1))])]),t("div",se,[t("div",oe,[(r(!0),m(L,null,T(x.value,s=>(r(),m("div",{key:s.id,class:"day-container"},[t("div",ae,[t("div",le,[t("label",{for:`day-${s.id}`,class:"font-medium text-sm text-gray-900"},_(s.name),9,de)]),t("div",ie,[t("label",ne,[g(t("input",{id:`day-${s.id}`,"onUpdate:modelValue":o=>s.is_active=o,type:"checkbox",onChange:o=>N(s)},null,40,re),[[H,s.is_active]]),e[12]||(e[12]=t("span",{class:"slider round"},null,-1))])])]),s.is_active?(r(),m("div",ue,[t("div",ce,[g(t("input",{"onUpdate:modelValue":o=>s.open_time=o,type:"time",class:"time",onChange:o=>V(s)},null,40,me),[[y,s.open_time]]),e[13]||(e[13]=t("span",{class:"to text-gray-500"},"to",-1)),g(t("input",{"onUpdate:modelValue":o=>s.close_time=o,type:"time",class:"time",onChange:o=>V(s)},null,40,pe),[[y,s.close_time]])])])):(r(),m("div",ve,[...e[14]||(e[14]=[t("span",{class:"closed text-gray-500"},"Closed",-1)])]))]))),128))])]),t("div",ge,[t("div",fe,[e[15]||(e[15]=t("h3",{class:"text-sm font-medium text-gray-900"},"Closed Periods",-1)),t("button",{class:"text-red-500 hover:text-red-600 text-sm font-medium",onClick:e[1]||(e[1]=s=>w.value=!0)}," + Add ")]),a.isLoadingPeriods?(r(),m("div",ye,[...e[16]||(e[16]=[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-red-500 mx-auto"},null,-1)])])):C.value.length===0?(r(),m("div",be," No closed periods added yet. ")):(r(),m("div",_e,[(r(!0),m(L,null,T(C.value,s=>(r(),m("div",{key:s.id,class:"flex justify-between items-center p-3 bg-gray-50 rounded-md"},[t("div",null,[t("p",xe,_(s.description||"Closed Period"),1),t("p",he,_(F(s.start_date,s.end_date)),1)]),t("div",we,[t("button",{onClick:o=>A(s),class:"text-blue-500 hover:text-blue-600 text-xs"},[...e[17]||(e[17]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 11H9v-2.828l8.586-8.586z"})],-1)])],8,ke),t("button",{onClick:o=>$(s.id),class:"text-red-500 hover:text-red-600 text-xs"},[...e[18]||(e[18]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Ce)])]))),128))]))]),t("div",De,[t("button",{onClick:G,disabled:h.value,class:"w-full lg:w-auto bg-red-500 hover:bg-red-600 disabled:bg-gray-300 text-white font-medium py-3 px-8 rounded-md transition-colors shadow-lg"},_(h.value?"Saving...":"Save & Complete"),9,Se)]),w.value?(r(),m("div",Be,[t("div",Pe,[t("div",Ve,[e[20]||(e[20]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Add Closed Period",-1)),t("button",{onClick:e[2]||(e[2]=s=>w.value=!1),class:"text-gray-400 hover:text-gray-600"},[...e[19]||(e[19]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",$e,[t("div",Me,[t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Start Date *",-1)),g(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>u.value.start_date=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",required:""},null,512),[[y,u.value.start_date]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"End Date *",-1)),g(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>u.value.end_date=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",required:""},null,512),[[y,u.value.end_date]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),g(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>u.value.description=s),type:"text",placeholder:"e.g. National Holiday",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"},null,512),[[y,u.value.description]])]),t("button",{onClick:q,disabled:f.value,class:"w-full bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 disabled:bg-gray-300"},_(f.value?"Saving...":"Add"),9,Ue)])])])])):P("",!0),k.value?(r(),m("div",He,[t("div",Le,[t("div",Te,[e[25]||(e[25]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Edit Closed Period",-1)),t("button",{onClick:e[6]||(e[6]=s=>k.value=!1),class:"text-gray-400 hover:text-gray-600"},[...e[24]||(e[24]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",je,[t("div",Ee,[t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Start Date *",-1)),g(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>n.value.start_date=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",required:""},null,512),[[y,n.value.start_date]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"End Date *",-1)),g(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>n.value.end_date=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",required:""},null,512),[[y,n.value.end_date]])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),g(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>n.value.description=s),type:"text",placeholder:"e.g. National Holiday",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"},null,512),[[y,n.value.description]])]),t("div",Ne,[t("button",{onClick:e[10]||(e[10]=s=>$(n.value.id)),class:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-200"},"Delete"),t("button",{onClick:I,disabled:f.value,class:"flex-1 bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 disabled:bg-gray-300"},"Update",8,Fe)])])])])])):P("",!0)])]),_:1})]),_:1}))}},Ke=z(qe,[["__scopeId","data-v-9bcde6fc"]]);export{Ke as default};
